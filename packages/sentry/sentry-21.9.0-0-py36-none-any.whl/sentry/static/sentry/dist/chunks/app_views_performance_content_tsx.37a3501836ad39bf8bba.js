"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_performance_content_tsx"],{"./app/actionCreators/events.tsx":(e,t,n)=>{n.d(t,{lI:()=>l,eV:()=>d,JE:()=>c}),n("../node_modules/core-js/modules/es.object.from-entries.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/lodash/pick.js"),i=n.n(r),a=n("./app/components/charts/utils.tsx"),o=n("./app/utils/getPeriod.tsx"),s=n("./app/utils/performance/constants.tsx");const l=(e,{organization:t,project:n,environment:r,team:i,period:s,start:l,end:d,interval:c,includePrevious:p,query:u,yAxis:m,field:h,topEvents:g,orderby:v,partial:f,withoutZerofill:x})=>{const y=(0,a.Sw)(p,s),Z=Object.fromEntries(Object.entries({interval:c,project:n,environment:r,team:i,query:u,yAxis:m,field:h,topEvents:g,orderby:v,partial:f?"1":void 0,withoutZerofill:x?"1":void 0}).filter((([,e])=>void 0!==e))),w=(0,o.X)({period:s,start:l,end:d},{shouldDoublePeriod:y});return e.requestPromise("/organizations/".concat(t.slug,"/events-stats/"),{query:{...Z,...w}})};async function d(e,t,n){const r={...i()(n,Object.values(s.s)),query:n.query};return e.requestPromise("/organizations/".concat(t,"/events-facets/"),{query:r})}async function c(e,t,n){const r={...i()(n,Object.values(s.s)),query:n.query};return e.requestPromise("/organizations/".concat(t,"/events-meta/"),{query:r}).then((e=>e.count))}},"./app/components/charts/areaChart.tsx":(e,t,n)=>{n.d(t,{Z:()=>l});var r=n("../node_modules/react/index.js"),i=n("./app/components/charts/series/lineSeries.tsx"),a=n("./app/components/charts/baseChart.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class s extends r.Component{render(){const{series:e,stacked:t,colors:n,...r}=this.props;return(0,o.tZ)(a.Z,{...r,colors:n,series:e.map((({seriesName:e,data:r,...a},o)=>function(e={}){return(0,i.Z)({...e})}({stack:t?"area":void 0,name:e,data:r.map((({name:e,value:t})=>[e,t])),lineStyle:{color:null==n?void 0:n[o],opacity:1,width:.4},areaStyle:{color:null==n?void 0:n[o],opacity:1},animation:!1,animationThreshold:1,animationDuration:0,...a})))})}}s.displayName="AreaChart";const l=s},"./app/components/charts/eventsRequest.tsx":(e,t,n)=>{n.d(t,{Z:()=>x});var r=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),a=n("../node_modules/lodash/isEqual.js"),o=n.n(a),s=n("../node_modules/lodash/omitBy.js"),l=n.n(s),d=n("./app/actionCreators/events.tsx"),c=n("./app/actionCreators/indicator.tsx"),p=n("./app/components/charts/loadingPanel.tsx"),u=n("./app/components/charts/utils.tsx"),m=n("./app/locale.tsx"),h=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const g=["api","children","organization","loading"],v=e=>l()(e,((e,t)=>g.includes(t)));class f extends i.PureComponent{constructor(...e){super(...e),(0,r.Z)(this,"state",{reloading:!!this.props.loading,errored:!1,timeseriesData:null,fetchedWithPrevious:!1}),(0,r.Z)(this,"unmounting",!1),(0,r.Z)(this,"fetchData",(async()=>{const{api:e,confirmedQuery:t,expired:n,name:r,hideError:i,...a}=this.props;let o=null;if(!1!==t){if(this.setState((e=>({reloading:null!==e.timeseriesData,errored:!1}))),n)(0,c.Iw)((0,m.t)("%s has an invalid date range. Please try a more recent date range.",r),{append:!0}),this.setState({errored:!0});else try{e.clear(),o=await(0,d.lI)(e,a)}catch(e){i||(e&&e.responseJSON&&e.responseJSON.detail?(0,c.Iw)(e.responseJSON.detail):(0,c.Iw)((0,m.t)("Error loading chart data"))),this.setState({errored:!0})}this.unmounting||this.setState({reloading:!1,timeseriesData:o,fetchedWithPrevious:a.includePrevious})}})),(0,r.Z)(this,"getData",(e=>{const{fetchedWithPrevious:t}=this.state,{period:n,includePrevious:r}=this.props,i=t||(0,u.Sw)(r,n),a=Math.floor(e.length/2);return{current:i?e.slice(a):e,previous:i?e.slice(0,a):null}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){o()(v(e),v(this.props))||this.fetchData()}componentWillUnmount(){this.unmounting=!0}calculateTotalsPerTimestamp(e,t=(e=>1e3*e)){return e.map((([e,n],r)=>({name:t(e,n,r),value:n.reduce(((e,{count:t})=>e+t),0)})))}transformPreviousPeriodData(e,t){var n;return t?{seriesName:null!==(n=this.props.previousSeriesName)&&void 0!==n?n:"Previous",data:this.calculateTotalsPerTimestamp(t,((t,n,r)=>1e3*e[r][0]))}:null}transformAggregatedTimeseries(e,t=""){return{seriesName:t,data:this.calculateTotalsPerTimestamp(e)}}transformTimeseriesData(e,t){return[{seriesName:t||"Current",data:e.map((([e,t])=>({name:1e3*e,value:t.reduce(((e,{count:t})=>e+t),0)})))}]}processData(e){if(!e)return{};const{data:t,totals:n}=e,{includeTransformedData:r,includeTimeAggregation:i,timeAggregationSeriesName:a}=this.props,{current:o,previous:s}=this.getData(t);return{data:r?this.transformTimeseriesData(o,this.props.currentSeriesName):[],allData:t,originalData:o,totals:n,originalPreviousData:s,previousData:r?this.transformPreviousPeriodData(o,s):null,timeAggregatedData:i?this.transformAggregatedTimeseries(o,a||""):{},timeframe:e.start&&e.end?s?{start:500*(e.start+e.end),end:1e3*e.end}:{start:1e3*e.start,end:1e3*e.end}:void 0}}render(){const{children:e,showLoading:t,...n}=this.props,{timeseriesData:r,reloading:i,errored:a}=this.state,o=this.props.loading||null===r;if(t&&o)return(0,h.tZ)(p.Z,{"data-test-id":"events-request-loading"});if((0,u.Xe)(r)){let t;return e({loading:o,reloading:i,errored:a,results:Object.keys(r).map((e=>{const n=r[e];n.start&&n.end&&!t&&(t={start:1e3*n.start,end:1e3*n.end});const i=this.transformTimeseriesData(n.data,e)[0];return[n.order||0,i]})).sort(((e,t)=>e[0]-t[0])).map((e=>e[1])),timeframe:t,...n})}const{data:s,allData:l,originalData:d,totals:c,originalPreviousData:m,previousData:g,timeAggregatedData:v,timeframe:f}=this.processData(r);return e({loading:o,reloading:i,errored:a,timeseriesData:s,allTimeseriesData:l,originalTimeseriesData:d,timeseriesTotals:c,originalPreviousTimeseriesData:m,previousTimeseriesData:g,timeAggregatedData:v,timeframe:f,...n})}}f.displayName="EventsRequest",(0,r.Z)(f,"defaultProps",{period:void 0,start:null,end:null,interval:"1d",limit:15,query:"",includePrevious:!0,includeTransformedData:!0});const x=f},"./app/utils/discover/charts.tsx":(e,t,n)=>{n.d(t,{CX:()=>o,gu:()=>s,b4:()=>l});var r=n("./app/locale.tsx"),i=n("./app/utils/discover/fields.tsx"),a=n("./app/utils/formatters.tsx");function o(e,t=""){switch((0,i.Px)(t)){case"integer":case"number":return e.toLocaleString();case"percentage":return(0,a.rl)(e,2);case"duration":return(0,a.g9)(e/1e3,2,!0);default:return e.toString()}}function s(e,t,n=!1){switch((0,i.Px)(t)){case"integer":case"number":return n?(0,a.Du)(e):e.toLocaleString();case"percentage":return(0,a.rl)(e,0);case"duration":return l(e);default:return e.toString()}}function l(e){if(0===e)return"0";if(e>=a.ps){const t=(e/a.ps).toFixed(0);return(0,r.t)("%swk",t)}if(e>=a.x4){const t=(e/a.x4).toFixed(0);return(0,r.t)("%sd",t)}if(e>=a.kr){const t=(e/a.kr).toFixed(0);return(0,r.t)("%shr",t)}if(e>=a.EB){const t=(e/a.EB).toFixed(0);return(0,r.t)("%smin",t)}if(e>=a.sh){const t=(e/a.sh).toFixed(0);return(0,r.t)("%ss",t)}const t=e.toFixed(0);return(0,r.t)("%sms",t)}},"./app/utils/discover/discoverQuery.tsx":(e,t,n)=>{n.d(t,{Z:()=>l}),n("../node_modules/react/index.js");var r=n("./app/utils/withApi.tsx"),i=n("./app/utils/discover/genericDiscoverQuery.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function s(e){return(0,a.tZ)(i.Z,{route:"eventsv2",shouldRefetchData:o,...e})}s.displayName="DiscoverQuery";const l=(0,r.Z)(s)},"./app/utils/getPeriod.tsx":(e,t,n)=>{n.d(t,{X:()=>s}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/moment/moment.js"),i=n.n(r),a=n("./app/constants/index.tsx"),o=n("./app/utils/dates.tsx");const s=({period:e,start:t,end:n},{shouldDoublePeriod:r}={})=>{if(e||t||n||(e=a.GY),e){if(!r)return{statsPeriod:e};const[,t,n]=e.match(/([0-9]+)([mhdw])/);return{statsPeriod:"".concat(2*parseInt(t,10)).concat(n)}}if(!t||!n)throw new Error("start and end required");const s=(0,o.v5)(t),l=(0,o.v5)(n);if(r){const e=i()(n).diff(i()(t)),r=i()(t).subtract(e);return{start:(0,o.v5)(r),end:l}}return{start:s,end:l}}},"./app/views/performance/content.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>gt});var r=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/react/index.js")),a=n("../node_modules/react-router/es/index.js"),o=n("../node_modules/lodash/isEqual.js"),s=n.n(o),l=n("./app/actionCreators/tags.tsx"),d=n("./app/components/acl/feature.tsx"),c=n("./app/components/alert.tsx"),p=n("./app/components/button.tsx"),u=n("./app/components/globalSdkUpdateAlert.tsx"),m=n("./app/components/lightWeightNoProjectMessage.tsx"),h=n("./app/components/organizations/globalSelectionHeader/index.tsx"),g=n("./app/components/pageHeading.tsx"),v=n("./app/components/sentryDocumentTitle.tsx"),f=n("./app/constants/globalSelectionHeader.tsx"),x=n("./app/icons/index.tsx"),y=n("./app/locale.tsx"),Z=n("./app/styles/organization.tsx"),w=n("./app/utils/analytics.tsx"),S=n("./app/utils/queryString.tsx"),b=n("./app/utils/tokenizeSearch.tsx"),C=n("./app/utils/withApi.tsx"),P=n("./app/utils/withGlobalSelection.tsx"),_=n("./app/utils/withOrganization.tsx"),A=n("./app/utils/withProjects.tsx"),j=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),D=n("./app/components/dropdownControl.tsx"),E=n("./app/components/events/searchBar.tsx"),T=n("./app/components/featureBadge.tsx"),z=n("./app/components/performance/teamKeyTransactionsManager.tsx"),V=n("./app/constants/index.tsx"),N=n("./app/styles/space.tsx"),k=n("./app/utils/discover/fields.tsx"),F=n("./app/utils/isActiveSuperuser.tsx"),B=n("./app/utils/withTeams.tsx"),q=n("./app/components/charts/eventsRequest.tsx"),R=n("./app/components/charts/loadingPanel.tsx"),L=n("./app/components/charts/styles.tsx"),O=n("./app/components/charts/utils.tsx"),M=n("./app/components/organizations/globalSelectionHeader/getParams.tsx"),I=n("./app/components/panels/index.tsx"),X=n("./app/components/placeholder.tsx"),H=n("./app/components/questionTooltip.tsx"),W=n("./app/utils/dates.tsx"),G=n("./app/utils/getDynamicText.tsx"),Y=n("./app/views/performance/data.tsx"),Q=n("./app/views/performance/styles.tsx"),K=n("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),U=n("../node_modules/lodash/max.js"),J=n.n(U),$=n("../node_modules/lodash/min.js"),ee=n.n($),te=n("./app/components/charts/areaChart.tsx"),ne=n("./app/components/charts/chartZoom.tsx"),re=n("./app/utils/discover/charts.tsx"),ie=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class ae extends i.Component{render(){const{theme:e,data:t,router:n,statsPeriod:r,start:i,end:a,utc:o,loading:s,height:l,grid:d,disableMultiAxis:c}=this.props;if(!t||t.length<=0)return null;const p=e.charts.getColorPalette(4),u=t.every((e=>"duration"===(0,k.Px)(e.seriesName)))?function(e){const t=e.map((e=>e.data.map((e=>e.value)))),n=J()(t.map(J()));if(n<=1)return 1;const r=Math.log10(n),i=ee()([J()([10**(r-Math.floor(r)),0]),10]);let a;a=i<=2.5?.2:i<=5?.5:i<=7.5?1:2;const o=10**Math.floor(r)*a;return Math.round(Math.ceil(n/o)*o)}(t):void 0,m={seriesOptions:{showSymbol:!1},grid:c?d:[{top:"8px",left:"24px",right:"52%",bottom:"16px"},{top:"8px",left:"52%",right:"24px",bottom:"16px"}],axisPointer:c?void 0:{link:[{xAxisIndex:[0,1]}]},xAxes:c?void 0:[{gridIndex:0,type:"time"},{gridIndex:1,type:"time"}],yAxes:c?[{axisLabel:{color:e.chartLabel,formatter:e=>(0,re.gu)(e,t[0].seriesName)}}]:[{gridIndex:0,scale:!0,max:u,axisLabel:{color:e.chartLabel,formatter:e=>(0,re.gu)(e,t[0].seriesName)}},{gridIndex:1,scale:!0,max:u,axisLabel:{color:e.chartLabel,formatter:e=>(0,re.gu)(e,t[1].seriesName)}}],utc:o,isGroupedByDate:!0,showTimeInTooltip:!0,colors:[p[0],p[1]],tooltip:{valueFormatter:(e,t)=>(0,re.CX)(e,t),nameFormatter:e=>"epm()"===e?"tpm()":e}};if(s)return(0,ie.tZ)(te.Z,{height:l,series:[],...m});const h=t.map(((e,t)=>({...e,yAxisIndex:t,xAxisIndex:t})));return(0,ie.tZ)(ne.Z,{router:n,period:r,start:i,end:a,utc:o,xAxisIndex:c?void 0:[0,1],children:e=>(0,ie.tZ)(te.Z,{height:l,...e,series:h,...m})})}}ae.displayName="Chart";const oe=(0,K.b)(ae);var se=n("../node_modules/@sentry/minimal/esm/index.js"),le=n("./app/actionCreators/events.tsx"),de=n("./app/components/charts/optionSelector.tsx"),ce=n("./app/utils/discover/eventView.tsx");class pe extends i.Component{constructor(...e){super(...e),(0,r.Z)(this,"state",{totalValues:null}),(0,r.Z)(this,"shouldRefetchData",(e=>{const t=this.props.eventView.getEventsAPIPayload(this.props.location),n=e.eventView.getEventsAPIPayload(e.location);return!(0,ce.ze)(t,n)})),(0,r.Z)(this,"mounted",!1)}componentDidMount(){this.mounted=!0,this.fetchTotalCount()}componentDidUpdate(e){const t=this.props.organization.slug!==e.organization.slug,n=this.shouldRefetchData(e);(t||n)&&this.props.eventView.isValid()&&this.fetchTotalCount()}componentWillUnmount(){this.mounted=!1}handleSelectorChange(e,t){const{location:n,organization:r}=this.props;(0,w.ec)({eventKey:"performance_views.overview.change_chart",eventName:"Performance Views: Change Overview Chart",organization_id:parseInt(r.id,10),metric:t}),a.browserHistory.push({pathname:n.pathname,query:{...n.query,[e]:t}})}async fetchTotalCount(){const{api:e,organization:t,location:n,eventView:r}=this.props;if(r.isValid()&&this.mounted)try{const i=await(0,le.JE)(e,t.slug,r.getEventsAPIPayload(n));this.mounted&&this.setState({totalValues:i})}catch(e){se.Tb(e)}}render(){const{leftAxis:e,organization:t,rightAxis:n}=this.props,{totalValues:r}=this.state,i="number"==typeof r?r.toLocaleString():"-",a=this.props.options||(0,Y.ze)(t),o=a.map((e=>({...e,disabled:e.value===n}))),s=a.map((t=>({...t,disabled:t.value===e})));return(0,ie.BX)(L.xx,{children:[(0,ie.BX)(L.m2,{children:[(0,ie.tZ)(L.OT,{children:(0,y.t)("Total Events")}),(0,ie.tZ)(L.uN,{children:i})]}),(0,ie.BX)(L.m2,{children:[(0,ie.tZ)(de.Z,{title:(0,y.t)("Display 1"),selected:e,options:o,onChange:e=>this.handleSelectorChange("left",e)}),(0,ie.tZ)(de.Z,{title:(0,y.t)("Display 2"),selected:n,options:s,onChange:e=>this.handleSelectorChange("right",e)})]})]})}}pe.displayName="ChartFooter";const ue=pe;class me extends i.Component{getChartParameters(){const{location:e,organization:t}=this.props,n=(0,Y.ze)(t);return[n.find((t=>t.value===e.query.left))||n[0],n.find((t=>t.value===e.query.right))||n[1]]}render(){const{api:e,organization:t,location:n,eventView:r,router:a}=this.props,o=r.getGlobalSelection(),s=o.datetime.start?(0,W.hC)(o.datetime.start):null,l=o.datetime.end?(0,W.hC)(o.datetime.end):null,{utc:d}=(0,M.Q)(n.query),c=this.getChartParameters(),p=r.getEventsAPIPayload(n);return(0,ie.BX)(I.s_,{children:[(0,ie.tZ)(q.Z,{organization:t,api:e,period:o.datetime.period,project:o.projects,environment:o.environments,team:p.team,start:s,end:l,interval:(0,O.ZS)({start:s,end:l,period:o.datetime.period},"high"),showLoading:!1,query:p.query,includePrevious:!1,yAxis:c.map((e=>e.value)),partial:!0,children:({loading:e,reloading:t,errored:n,results:r})=>n?(0,ie.tZ)(Q.yu,{children:(0,ie.tZ)(x.FC,{color:"gray300",size:"lg"})}):(0,ie.BX)(i.Fragment,{children:[(0,ie.tZ)(Q.Mt,{children:c.map(((e,t)=>(0,ie.tZ)("div",{children:(0,ie.BX)(L.Gh,{children:[e.label,(0,ie.tZ)(H.Z,{position:"top",size:"sm",title:e.tooltip})]})},"".concat(e.label,":").concat(t))))}),r?(0,G.Z)({value:(0,ie.tZ)(oe,{data:r,loading:e||t,router:a,statsPeriod:o.datetime.period,start:s,end:l,utc:"true"===d}),fixed:(0,ie.tZ)(X.Z,{height:"200px",testId:"skeleton-ui"})}):(0,ie.tZ)(R.Z,{"data-test-id":"events-request-loading"})]})}),(0,ie.tZ)(ue,{api:e,leftAxis:c[0].value,rightAxis:c[1].value,organization:t,eventView:r,location:n})]})}}me.displayName="Container";const he=(0,C.Z)(me);var ge=n("./app/views/performance/table.tsx"),ve=n("./app/views/performance/utils.tsx"),fe=n("./app/components/charts/errorPanel.tsx"),xe=n("./app/components/charts/transparentLoadingMask.tsx");function ye(e,t){var n;return t&&null!==(n=Ze(e))&&void 0!==n?n:e}function Ze(e){return e.backupOption}function we(e,t){return null!=t?t:e}function Se(e){const{organization:t,api:n,eventView:r,location:i,router:a,field:o,title:s,titleTooltip:l,backupField:d,usingBackupAxis:c}=e,p=r.getGlobalSelection(),u=p.datetime.start?(0,W.hC)(p.datetime.start):null,m=p.datetime.end?(0,W.hC)(p.datetime.end):null,{utc:h}=(0,M.Q)(i.query),g=d?[d]:[],v=r.getEventsAPIPayload(i);return(0,ie.tZ)(q.Z,{organization:t,api:n,period:p.datetime.period,project:p.projects,environment:p.environments,team:v.team,start:u,end:m,interval:(0,O.ZS)({start:u,end:m,period:p.datetime.period},"high"),showLoading:!1,query:v.query,includePrevious:!1,yAxis:[o,...g],partial:!0,hideError:!0,children:({loading:e,reloading:t,errored:n,timeseriesData:r,results:i})=>{const g=c?we(o,d):o,v=r||[null==i?void 0:i.find((e=>e.seriesName===g))].filter(Boolean),f=v?v.map((({...e})=>({...e,seriesName:g}))):[];return n?(0,ie.tZ)(fe.Z,{children:(0,ie.tZ)(x.FC,{color:"gray300",size:"lg"})}):(0,ie.BX)("div",{children:[(0,ie.tZ)(Q.Mt,{children:(0,ie.BX)(L.ws,{children:[s,(0,ie.tZ)(H.Z,{position:"top",size:"sm",title:l})]})}),v&&(0,ie.tZ)(be,{children:(0,ie.BX)(Ce,{children:[(0,ie.tZ)(xe.Z,{visible:e}),(0,G.Z)({value:(0,ie.tZ)(oe,{height:250,data:f,loading:e||t,router:a,statsPeriod:p.datetime.period,start:u,end:m,utc:"true"===h,grid:{left:(0,N.Z)(3),right:(0,N.Z)(3),top:(0,N.Z)(3),bottom:e||t?(0,N.Z)(4):(0,N.Z)(1.5)},disableMultiAxis:!0}),fixed:(0,ie.tZ)(X.Z,{height:"250px",testId:"skeleton-ui"})})]})})]})}})}Se.displayName="DurationChart";const be=(0,j.Z)("div",{target:"ev9dshi1"})("padding-top:",(0,N.Z)(1),";"),Ce=(0,j.Z)("div",{target:"ev9dshi0"})({name:"bjn8wh",styles:"position:relative"}),Pe=(0,a.withRouter)((0,C.Z)(Se));var _e=n("./app/components/charts/barChart.tsx"),Ae=n("./app/components/charts/barChartZoom.tsx"),je=n("./app/icons/iconWarning.tsx"),De=n("./app/utils/performance/histogram/histogramQuery.tsx"),Ee=n("./app/utils/performance/histogram/utils.tsx");function Te(e){const{theme:t,location:n,onFilterChange:r,organization:a,eventView:o,field:s,title:l,titleTooltip:d,didReceiveMultiAxis:c,backupField:p,usingBackupAxis:u}=e,m=p?[p]:[],h={type:"category",truncate:!0,boundaryGap:!1,axisTick:{alignWithLabel:!0}};return(0,ie.BX)("div",{children:[(0,ie.tZ)(Q.Mt,{children:(0,ie.BX)(L.ws,{children:[l,(0,ie.tZ)(H.Z,{position:"top",size:"sm",title:d})]})}),(0,ie.tZ)(De.Z,{location:n,orgSlug:a.slug,eventView:o,numBuckets:50,precision:0,fields:[s,...m],dataFilter:"exclude_outliers",didReceiveMultiAxis:c,children:e=>{var a;const o=u?we(s,p):s,l=e.isLoading,d=null!==e.error,c=null===(a=e.histograms)||void 0===a?void 0:a[o];if(d)return(0,ie.tZ)(fe.Z,{height:"250px",children:(0,ie.tZ)(je.F,{color:"gray300",size:"lg"})});if(!c)return null;const m={seriesName:(0,y.t)("Count"),data:(0,Ee.GT)(c,{type:"duration"})},g=[];l||d||g.push(m);const v={type:"value",axisLabel:{color:t.chartLabel}};return(0,ie.tZ)(i.Fragment,{children:(0,ie.tZ)(Ae.Z,{minZoomWidth:50,location:n,paramStart:"".concat(o,":>="),paramEnd:"".concat(o,":<="),xAxisIndex:[0],buckets:(0,Ee._W)(c),onHistoryPush:r,children:e=>(0,ie.tZ)(ze,{children:(0,ie.BX)(Ve,{children:[(0,ie.tZ)(xe.Z,{visible:l}),(0,G.Z)({value:(0,ie.tZ)(_e.Z,{height:250,series:g,xAxis:h,yAxis:v,grid:{left:(0,N.Z)(3),right:(0,N.Z)(3),top:(0,N.Z)(3),bottom:l?(0,N.Z)(4):(0,N.Z)(1.5)},stacked:!0,...e}),fixed:(0,ie.tZ)(X.Z,{height:"250px",testId:"skeleton-ui"})})]})})})})}})]})}Te.displayName="HistogramChart";const ze=(0,j.Z)("div",{target:"e1kr7yxp1"})("padding-top:",(0,N.Z)(1),";position:relative;"),Ve=(0,j.Z)("div",{target:"e1kr7yxp0"})({name:"bjn8wh",styles:"position:relative"}),Ne=(0,K.b)(Te);function ke(e){const{axis:t,onFilterChange:n,eventView:r,organization:i,location:a,didReceiveMultiAxis:o,usingBackupAxis:s}=e,l=function(e){const t=Ze(e);if(t)return t.field}(t),d=ye(t,s);return t.isDistribution?(0,ie.tZ)(Ne,{field:t.field,eventView:r,organization:i,location:a,onFilterChange:n,title:d.label,titleTooltip:d.tooltip,didReceiveMultiAxis:function(e){o&&(e[t.field]?o(!1):l&&e[l]&&o(!0))},usingBackupAxis:s,backupField:l}):(0,ie.tZ)(Pe,{field:t.field,eventView:r,organization:i,title:d.label,titleTooltip:d.tooltip,usingBackupAxis:s,backupField:l})}function Fe(e){const{eventView:t,location:n,organization:r,axisOptions:o,leftAxis:s,rightAxis:l}=e,[d,c]=(0,i.useState)(!1),p=e=>(t,i)=>{const o=(0,ve.Ov)(n),s=new b.MY(o);s.setFilterValues(e,[">=".concat(Math.round(t)),"<".concat(Math.round(i))]);const l=s.formatString();(0,w.ec)({eventKey:"performance_views.landingv2.display.filter_change",eventName:"Performance Views: Landing v2 Display Filter Change",organization_id:parseInt(r.id,10),field:e,min_value:parseInt(t,10),max_value:parseInt(i,10)}),a.browserHistory.push({pathname:n.pathname,query:{...n.query,query:String(l).trim()}})},u=e=>{c(e)},m=ye(s,d),h=ye(l,d),g=function(e,t){return t?e.map((e=>{var t;return null!==(t=Ze(e))&&void 0!==t?t:e})):e}(o,d);return(0,ie.BX)(I.s_,{children:[(0,ie.BX)(Be,{children:[(0,ie.tZ)(ke,{axis:s,onFilterChange:p(s.field),didReceiveMultiAxis:u,usingBackupAxis:d,...e}),(0,ie.tZ)(ke,{axis:l,onFilterChange:p(l.field),didReceiveMultiAxis:u,usingBackupAxis:d,...e})]}),(0,ie.tZ)(qe,{options:g,leftAxis:m.value,rightAxis:h.value,organization:r,eventView:t,location:n})]})}Fe.displayName="DoubleAxisDisplay";const Be=(0,j.Z)("div",{target:"e1hm94we0"})("display:grid;grid-template-columns:1fr 1fr;grid-gap:",(0,N.Z)(3),";min-height:282px;"),qe=(0,C.Z)(ue),Re=Fe,Le=["transaction","project","tpm","FCP","LCP","FID","CLS","users","user misery"],Oe=["transaction","project","operation","tpm","p50()","p75()","p95()","users","user misery"],Me=["transaction","project","operation","http method","tpm","p50","p95","failure rate","apdex","users","user misery"],Ie=["transaction","project","operation","tpm","cold start","warm start","slow frame %","frozen frame %","users","user misery"],Xe=["transaction","project","operation","tpm","cold start","warm start","stall %","users","user misery"];var He=n("./app/views/performance/landing/utils.tsx"),We=n("./app/views/performance/landing/vitalsCards.tsx");class Ge extends i.Component{constructor(...e){super(...e),(0,r.Z)(this,"handleLandingDisplayChange",(e=>{const{location:t,organization:n,eventView:r,projects:i}=this.props,o={...t.query};delete o[He.Y1],delete o[He.V];const s=(0,He.Oo)(i,r),l=(0,S.ro)(t.query.landingDisplay),d=(0,S.ro)(t.query.query,""),c=new b.MY(d);c.removeFilter("transaction.op"),(0,w.ec)({eventKey:"performance_views.landingv2.display_change",eventName:"Performance Views: Landing v2 Display Change",organization_id:parseInt(n.id,10),change_to_display:e,default_display:s,current_display:l,is_default:s===l}),a.browserHistory.push({pathname:t.pathname,query:{...o,query:c.formatString(),landingDisplay:e}})})),(0,r.Z)(this,"renderLandingFrontend",(e=>{const{organization:t,location:n,projects:r,eventView:a,setError:o}=this.props,s=e?Le:Oe,l=e?(0,Y.L0)(t):(0,Y.g1)(t),{leftAxis:d,rightAxis:c}=(0,He.Gd)(l,n);return(0,ie.BX)(i.Fragment,{children:[e&&(0,ie.tZ)(We.q7,{eventView:a,organization:t,location:n,projects:r}),(0,ie.tZ)(Re,{eventView:a,organization:t,location:n,axisOptions:l,leftAxis:d,rightAxis:c}),(0,ie.tZ)(ge.Z,{eventView:a,projects:r,organization:t,location:n,setError:o,summaryConditions:a.getQueryWithAdditionalConditions(),columnTitles:s})]})})),(0,r.Z)(this,"renderLandingBackend",(()=>{const{organization:e,location:t,projects:n,eventView:r,setError:a}=this.props,o=(0,Y.DW)(e),{leftAxis:s,rightAxis:l}=(0,He.Gd)(o,t),d=Me;return(0,ie.BX)(i.Fragment,{children:[(0,ie.tZ)(We.M9,{eventView:r,organization:e,location:t}),(0,ie.tZ)(Re,{eventView:r,organization:e,location:t,axisOptions:o,leftAxis:s,rightAxis:l}),(0,ie.tZ)(ge.Z,{eventView:r,projects:n,organization:e,location:t,setError:a,summaryConditions:r.getQueryWithAdditionalConditions(),columnTitles:d})]})})),(0,r.Z)(this,"renderLandingMobile",(()=>{const{organization:e,location:t,projects:n,eventView:r,setError:a}=this.props,o=(0,Y.Gm)(e),{leftAxis:s,rightAxis:l}=(0,He.Gd)(o,t),d=Boolean(r.getFields().find((e=>e.includes("measurements.stall_percentage")))),c=d?Xe:Ie;return(0,ie.BX)(i.Fragment,{children:[(0,ie.tZ)(We.aU,{eventView:r,organization:e,location:t,showStallPercentage:d}),(0,ie.tZ)(Re,{eventView:r,organization:e,location:t,axisOptions:o,leftAxis:s,rightAxis:l}),(0,ie.tZ)(ge.Z,{eventView:r,projects:n,organization:e,location:t,setError:a,summaryConditions:r.getQueryWithAdditionalConditions(),columnTitles:c})]})})),(0,r.Z)(this,"renderLandingAll",(()=>{const{organization:e,location:t,router:n,projects:r,eventView:a,setError:o}=this.props;return(0,ie.BX)(i.Fragment,{children:[(0,ie.tZ)(he,{eventView:a,organization:e,location:t,router:n}),(0,ie.tZ)(ge.Z,{eventView:a,projects:r,organization:e,location:t,setError:o,summaryConditions:a.getQueryWithAdditionalConditions()})]})}))}getSummaryConditions(e){const t=new b.MY(e);return t.freeText=[],t.formatString()}renderSelectedDisplay(e){switch(e){case He.BY.ALL:return this.renderLandingAll();case He.BY.FRONTEND_PAGELOAD:return this.renderLandingFrontend(!0);case He.BY.FRONTEND_OTHER:return this.renderLandingFrontend(!1);case He.BY.BACKEND:return this.renderLandingBackend();case He.BY.MOBILE:return this.renderLandingMobile();default:throw new Error("Unknown display: ".concat(e))}}render(){const{organization:e,location:t,eventView:n,projects:r,teams:a,handleSearch:o}=this.props,s=(0,He.Q_)(t,r,n),l=(0,ve.Ov)(t,n.query),d=(0,F.M)(),c=a.filter((({isMember:e})=>e||d));return(0,ie.BX)(i.Fragment,{children:[(0,ie.BX)(Ye,{children:[(0,ie.tZ)(E.Z,{searchSource:"performance_landing",organization:e,projectIds:n.project,query:l,fields:(0,k.db)(e,[...n.fields,{field:"tps()"}],["epm()","eps()"]),onSearch:o,maxQueryLength:V.dI}),(0,ie.tZ)(D.ZP,{buttonProps:{prefix:(0,y.t)("Display")},label:s.label,children:He.Lx.filter((({isShown:t})=>!t||t(e))).map((({badge:e,label:t,field:n})=>(0,ie.BX)(D.hP,{onSelect:this.handleLandingDisplayChange,eventKey:n,"data-test-id":n,isActive:n===s.field,children:[t,e&&(0,ie.tZ)(T.Z,{type:e,noTooltip:!0})]},n)))})]}),(0,ie.tZ)(z.z,{organization:e,teams:c,selectedTeams:["myteams"],selectedProjects:n.project.map(String),children:this.renderSelectedDisplay(s.field)})]})}}Ge.displayName="LandingContent";const Ye=(0,j.Z)("div",{target:"e5hewa80"})("display:grid;grid-gap:",(0,N.Z)(2),";margin-bottom:",(0,N.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:1fr min-content;}"),Qe=(0,a.withRouter)((0,B.Z)(Ge));var Ke=n("./app/views/performance/trends/utils.tsx"),Ue=n("./app/components/layouts/thirds.tsx"),Je=n("./app/components/navTabs.tsx"),$e=n("./app/views/performance/transactionSummary/filter.tsx");const et=(0,i.createContext)({opBreakdownFilter:$e.f1.None,setOpBreakdownFilter:e=>{}}),tt=({filter:e,children:t})=>{const[n,r]=(0,i.useState)(e);return(0,ie.tZ)(et.Provider,{value:{opBreakdownFilter:null!=n?n:$e.f1.None,setOpBreakdownFilter:r},children:t})};function nt(e){return(0,ie.tZ)("div",{})}function rt(e){return(0,ie.tZ)("div",{})}function it(e){return(0,ie.tZ)("div",{})}function at(e){return(0,ie.tZ)("div",{"data-test-id":"frontend-pageload-view"})}function ot(e){return(0,ie.tZ)("div",{})}tt.displayName="OpBreakdownFilterProvider",nt.displayName="AllTransactionsView",rt.displayName="BackendView",it.displayName="FrontendOtherView",at.displayName="FrontendPageloadView",ot.displayName="MobileView";const st={[He.BY.ALL]:nt,[He.BY.BACKEND]:rt,[He.BY.FRONTEND_OTHER]:it,[He.BY.FRONTEND_PAGELOAD]:at,[He.BY.MOBILE]:ot};function lt(e){const{organization:t,location:n,eventView:r,projects:a,teams:o,handleSearch:s,handleTrendsClick:l,shouldShowOnboarding:d}=e,c=(0,He.Q_)(n,a,r),m=(0,ve.Ov)(n,r.query),h=(0,F.M)(),g=o.filter((({isMember:e})=>e||h)),[v,f]=(0,i.useState)($e.f1.None),x=d,Z=He.Lx.filter((({isShown:e})=>!e||e(t))),w=st[c.field];return(0,ie.BX)("div",{"data-test-id":"performance-landing-v3",children:[(0,ie.BX)(Ue.h4,{children:[(0,ie.tZ)(Ue.oB,{children:(0,ie.tZ)(ct,{children:(0,y.t)("Performance")})}),(0,ie.tZ)(Ue.kP,{children:!x&&(0,ie.tZ)(p.ZP,{priority:"primary","data-test-id":"landing-header-trends",onClick:()=>l(),children:(0,y.t)("View Trends")})}),(0,ie.tZ)(pt,{children:Z.map((({badge:e,label:t,field:r})=>(0,ie.tZ)("li",{className:c.field===r?"active":"",children:(0,ie.BX)("a",{href:"#",onClick:()=>(0,He.NJ)(r,n),children:[(0,y.t)(t),e&&(0,ie.tZ)(T.Z,{type:e})]})},t)))})]}),(0,ie.tZ)(Ue.uT,{children:(0,ie.BX)(Ue.or,{fullWidth:!0,children:[(0,ie.tZ)(u.Z,{}),(0,ie.BX)(tt,{children:[(0,ie.BX)(ut,{children:[(0,ie.tZ)($e.ZP,{organization:t,currentFilter:v,onChangeFilter:f}),(0,ie.tZ)(E.Z,{searchSource:"performance_landing",organization:t,projectIds:r.project,query:m,fields:(0,k.db)(t,[...r.fields,{field:"tps()"}],["epm()","eps()"]),onSearch:s,maxQueryLength:V.dI})]}),(0,ie.tZ)(z.z,{organization:t,teams:g,selectedTeams:["myteams"],selectedProjects:r.project.map(String),children:(0,ie.tZ)(w,{...e})})]})]})})]})}lt.displayName="_PerformanceLanding";const dt=(0,B.Z)(lt),ct=(0,j.Z)(g.Z,{target:"e1ce5rqc2"})({name:"ht6xsx",styles:"line-height:40px"}),pt=(0,j.Z)(Je.Z,{target:"e1ce5rqc1"})({name:"13jhhqe",styles:"margin-bottom:0;width:100%"}),ut=(0,j.Z)("div",{target:"e1ce5rqc0"})("display:grid;grid-gap:",(0,N.Z)(0),";margin-bottom:",(0,N.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:min-content 1fr;}");var mt=n("./app/views/performance/onboarding.tsx");class ht extends i.Component{constructor(...e){super(...e),(0,r.Z)(this,"state",{eventView:(0,Y.C)(this.props.organization,this.props.location,this.props.projects),error:void 0}),(0,r.Z)(this,"setError",(e=>{this.setState({error:e})})),(0,r.Z)(this,"handleSearch",(e=>{const{location:t,organization:n}=this.props;(0,w.ec)({eventKey:"performance_views.overview.search",eventName:"Performance Views: Transaction overview search",organization_id:parseInt(n.id,10)}),a.browserHistory.push({pathname:t.pathname,query:{...t.query,cursor:void 0,query:String(e).trim()||void 0}})})),(0,r.Z)(this,"handleTrendsClick",(()=>{const{location:e,organization:t}=this.props,n={...e.query},r=(0,S.ro)(e.query.query,""),i=new b.MY(r);(0,w.ec)({eventKey:"performance_views.change_view",eventName:"Performance Views: Change View",organization_id:parseInt(t.id,10),view_name:"TRENDS"});const o=new b.MY([]);i.hasFilter("tpm()")?o.setFilterValues("tpm()",i.getFilterValues("tpm()")):o.setFilterValues("tpm()",[">0.01"]),i.hasFilter("transaction.duration")?o.setFilterValues("transaction.duration",i.getFilterValues("transaction.duration")):o.setFilterValues("transaction.duration",[">0","<".concat(Ke.bg)]),n.query=o.formatString(),a.browserHistory.push({pathname:(0,ve.Ws)(t),query:{...n}})}))}static getDerivedStateFromProps(e,t){return{...t,eventView:(0,Y.C)(e.organization,e.location,e.projects)}}componentDidMount(){const{api:e,organization:t,selection:n}=this.props;(0,l.QK)(e,t.slug,n),(0,ve.n4)(n),(0,w.ec)({eventKey:"performance_views.overview.view",eventName:"Performance Views: Transaction overview view",organization_id:parseInt(t.id,10),show_onboarding:this.shouldShowOnboarding()})}componentDidUpdate(e){const{api:t,organization:n,selection:r}=this.props;s()(e.selection.projects,r.projects)&&s()(e.selection.datetime,r.datetime)||((0,l.QK)(t,n.slug,r),(0,ve.n4)(r))}renderError(){const{error:e}=this.state;return e?(0,ie.tZ)(c.Z,{type:"error",icon:(0,ie.tZ)(x.Gy,{size:"md"}),children:e}):null}shouldShowOnboarding(){const{projects:e,demoMode:t}=this.props,{eventView:n}=this.state;return!t&&0!==e.length&&(0===n.project.length||n.project===[f.mP]?e.filter((e=>!1===e.firstTransactionEvent)).length===e.length:e.filter((e=>n.project.includes(parseInt(e.id,10))&&!1===e.firstTransactionEvent)).length===n.project.length)}renderBody(){const{organization:e,projects:t,selection:n}=this.props,r=this.state.eventView,i=this.shouldShowOnboarding();return(0,ie.tZ)(Z.JH,{children:(0,ie.BX)(m.Z,{organization:e,children:[(0,ie.BX)(Z.mr,{children:[(0,ie.tZ)(g.Z,{children:(0,y.t)("Performance")}),!i&&(0,ie.tZ)(p.ZP,{priority:"primary","data-test-id":"landing-header-trends",onClick:this.handleTrendsClick,children:(0,y.t)("View Trends")})]}),(0,ie.tZ)(u.Z,{}),this.renderError(),i?(0,ie.tZ)(mt.Z,{organization:e,project:n.projects.length>0&&t.find((e=>n.projects[0].toString()===e.id))||t[0]}):(0,ie.tZ)(Qe,{eventView:r,projects:t,organization:e,setError:this.setError,handleSearch:this.handleSearch})]})})}renderLandingV3(){return(0,ie.tZ)(dt,{eventView:this.state.eventView,setError:this.setError,handleSearch:this.handleSearch,handleTrendsClick:this.handleTrendsClick,shouldShowOnboarding:this.shouldShowOnboarding(),...this.props})}render(){const{organization:e}=this.props;return(0,ie.tZ)(v.Z,{title:(0,y.t)("Performance"),orgSlug:e.slug,children:(0,ie.tZ)(h.Z,{defaultSelection:{datetime:{start:null,end:null,utc:!1,period:Y.GY}},children:(0,ie.tZ)(d.Z,{features:["organizations:performance-landing-widgets"],children:({hasFeature:e})=>e?this.renderLandingV3():this.renderBody()})})})}}ht.displayName="PerformanceContent";const gt=(0,C.Z)((0,_.Z)((0,A.Z)((0,P.Z)(ht))))},"./app/views/performance/styles.tsx":(e,t,n)=>{n.d(t,{r8:()=>a,Ci:()=>o,Mt:()=>s,yu:()=>l});var r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=n("./app/styles/space.tsx");const a=(0,r.Z)("div",{target:"exyvyft3"})({name:"mmdt3g",styles:"font-size:14px"}),o=(0,r.Z)(a,{target:"exyvyft2"})({name:"2qga7i",styles:"text-align:right"}),s=(0,r.Z)("div",{target:"exyvyft1"})("display:grid;grid-template-columns:1fr 1fr;padding:",(0,i.Z)(2)," ",(0,i.Z)(3)," ",(0,i.Z)(1)," ",(0,i.Z)(3),";grid-gap:",(0,i.Z)(3),";"),l=(0,r.Z)("div",{target:"exyvyft0"})({name:"1oc6478",styles:"display:flex;justify-content:center;align-items:center;flex:1;flex-shrink:0;overflow:hidden;height:200px;position:relative;border-color:transparent;margin-bottom:0"})},"./app/views/performance/table.tsx":(e,t,n)=>{n.d(t,{Z:()=>E});var r=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),a=n("../node_modules/react-router/es/index.js"),o=n("./app/actionCreators/indicator.tsx"),s=n("./app/actionCreators/modal.tsx"),l=n("./app/components/assistant/guideAnchor.tsx"),d=n("./app/components/gridEditable/index.tsx"),c=n("./app/components/gridEditable/sortLink.tsx"),p=n("./app/components/links/link.tsx"),u=n("./app/components/pagination.tsx"),m=n("./app/components/tooltip.tsx"),h=n("./app/icons/index.tsx"),g=n("./app/locale.tsx"),v=n("./app/utils.tsx"),f=n("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),x=n("./app/utils/discover/discoverQuery.tsx"),y=n("./app/utils/discover/eventView.tsx"),Z=n("./app/utils/discover/fieldRenderers.tsx"),w=n("./app/utils/discover/fields.tsx"),S=n("./app/utils/tokenizeSearch.tsx"),b=n("./app/views/eventsV2/table/cellAction.tsx"),C=n("./app/views/performance/transactionSummary/transactionThresholdModal.tsx"),P=n("./app/views/performance/transactionSummary/utils.tsx"),_=n("./app/views/performance/data.tsx"),A=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function j(e,t){const n=(null==e?void 0:e.project)||void 0;if(void 0===typeof n)return;const r=t.find((e=>e.slug===n));return r?r.id:void 0}class D extends i.Component{constructor(...e){super(...e),(0,r.Z)(this,"state",{widths:[],transaction:void 0,transactionThreshold:void 0,transactionThresholdMetric:void 0}),(0,r.Z)(this,"handleCellAction",((e,t)=>(n,r)=>{const{eventView:i,location:l,organization:d,projects:c}=this.props;if((0,f.Z)("performance_views.overview.cellaction",{organization:d,action:n}),n===b.eX.EDIT_THRESHOLD){const e=t.project_threshold_config,n=t.transaction,r=j(t,c);return void(0,s.openModal)((t=>(0,A.tZ)(C.ZP,{...t,organization:d,transactionName:n,eventView:i,project:r,transactionThreshold:e[1],transactionThresholdMetric:e[0],onApply:(t,r)=>{t===e[1]&&r===e[0]||this.setState({transaction:n,transactionThreshold:t,transactionThresholdMetric:r}),(0,o.S9)((0,g._N)("[transactionName] updated successfully",{transactionName:n}))}})),{modalCss:C.fY,backdrop:"static"})}const p=new S.MY(i.query);p.removeFilter("event.type"),(0,b.rh)(p,n,e,r),a.browserHistory.push({pathname:l.pathname,query:{...l.query,cursor:void 0,query:p.formatString()}})})),(0,r.Z)(this,"renderBodyCellWithData",(e=>(t,n)=>this.renderBodyCell(e,t,n))),(0,r.Z)(this,"renderHeadCellWithMeta",(e=>{var t;const n=null!==(t=this.props.columnTitles)&&void 0!==t?t:_.hj;return(t,r)=>this.renderHeadCell(e,t,n[r])})),(0,r.Z)(this,"renderPrependCellWithData",(e=>{const{eventView:t}=this.props,n=t.getColumns().find((e=>"key_transaction"===e.name)),r=t.getColumns().find((e=>"team_key_transaction"===e.name));return(t,i)=>{if(n){if(t){const t=(0,A.tZ)(h.GK,{color:"yellow300",isSolid:!0,"data-test-id":"key-transaction-header"},"keyTransaction");return[this.renderHeadCell(null==e?void 0:e.meta,n,t)]}return[this.renderBodyCell(e,n,i)]}if(r){if(t){const t=(0,A.tZ)(l.Z,{target:"team_key_transaction_header",position:"top",children:(0,A.tZ)(h.GK,{color:"yellow300",isSolid:!0,"data-test-id":"team-key-transaction-header"},"keyTransaction")});return[this.renderHeadCell(null==e?void 0:e.meta,r,t)]}return[this.renderBodyCell(e,r,i)]}return[]}})),(0,r.Z)(this,"handleSummaryClick",(()=>{const{organization:e}=this.props;(0,f.Z)("performance_views.overview.navigate.summary",{organization:e})})),(0,r.Z)(this,"handleResizeColumn",((e,t)=>{const n=[...this.state.widths];n[e]=t.width?Number(t.width):d.z7,this.setState({widths:n})}))}renderBodyCell(e,t,n){const{eventView:r,organization:i,projects:a,location:o}=this.props;if(!e||!e.meta)return n[t.key];const s=e.meta,l=String(t.key),d=(0,Z.Js)(l,s)(n,{organization:i,location:o}),c=[b.eX.ADD,b.eX.EXCLUDE,b.eX.SHOW_GREATER_THAN,b.eX.SHOW_LESS_THAN,b.eX.EDIT_THRESHOLD];if("transaction"===l){const e=j(n,a),o=r.clone();n["http.method"]&&o.additionalConditions.setFilterValues("http.method",[n["http.method"]]),o.query=o.getQueryWithAdditionalConditions();const s=(0,P.e1)({orgSlug:i.slug,transaction:String(n.transaction)||"",query:o.generateQueryStringObject(),projectID:e});return(0,A.tZ)(b.ZP,{column:t,dataRow:n,handleCellAction:this.handleCellAction(t,n),allowActions:c,children:(0,A.tZ)(p.Z,{to:s,onClick:this.handleSummaryClick,children:d})})}if(l.startsWith("key_transaction"))return d;if(l.startsWith("team_key_transaction"))return d;const u=(0,w.LY)(l),h=n[u];return"integer"===s[u]&&(0,v.ri)(h)&&h>999?(0,A.tZ)(m.Z,{title:h.toLocaleString(),containerDisplayMode:"block",position:"right",children:(0,A.tZ)(b.ZP,{column:t,dataRow:n,handleCellAction:this.handleCellAction(t,n),allowActions:c,children:d})}):(0,A.tZ)(b.ZP,{column:t,dataRow:n,handleCellAction:this.handleCellAction(t,n),allowActions:c,children:d})}onSortClick(e,t){const{organization:n}=this.props;(0,f.Z)("performance_views.landingv2.transactions.sort",{organization:n,field:t,direction:e})}renderHeadCell(e,t,n){const{eventView:r,location:i}=this.props,a=(0,w.qG)(t.name,t.type,e),o={field:t.name,width:t.width},s=r.sortForField(o,e),d=(0,y.M3)(o,e),p=s?s.kind:void 0,u=s?s.field:void 0,m=(0,A.tZ)(c.Z,{align:a,title:n||o.field,direction:p,canSort:d,generateSortLink:function(){if(!e)return;const t=r.sortOnField(o,e).generateQueryStringObject();return{...i,query:{...i.query,sort:t.sort}}},onClick:()=>this.onSortClick(p,u)});return o.field.startsWith("user_misery")?(0,A.tZ)(l.Z,{target:"project_transaction_threshold",position:"top",children:m}):m}getSortedEventView(){const{eventView:e}=this.props;return e.withSorts([{field:"team_key_transaction",kind:"desc"},...e.sorts])}render(){const{eventView:e,organization:t,location:n,setError:r}=this.props,{widths:a,transaction:o,transactionThreshold:s,transactionThresholdMetric:l}=this.state,c=e.getColumns().filter((e=>"key_transaction"!==e.name&&"team_key_transaction"!==e.name&&!e.name.startsWith("count_miserable")&&"project_threshold_config"!==e.name)).map(((e,t)=>"number"==typeof a[t]?{...e,width:a[t]}:e)),p=this.getSortedEventView(),m=p.getSorts(),h=["max-content"];return(0,A.tZ)("div",{children:(0,A.tZ)(x.Z,{eventView:p,orgSlug:t.slug,location:n,setError:r,referrer:"api.performance.landing-table",transactionName:o,transactionThreshold:s,transactionThresholdMetric:l,children:({pageLinks:e,isLoading:t,tableData:r})=>(0,A.BX)(i.Fragment,{children:[(0,A.tZ)(d.ZP,{isLoading:t,data:r?r.data:[],columnOrder:c,columnSortBy:m,grid:{onResizeColumn:this.handleResizeColumn,renderHeadCell:this.renderHeadCellWithMeta(null==r?void 0:r.meta),renderBodyCell:this.renderBodyCellWithData(r),renderPrependColumns:this.renderPrependCellWithData(r),prependColumnWidths:h},location:n}),(0,A.tZ)(u.Z,{pageLinks:e})]})})})}}D.displayName="Table";const E=D},"./app/views/performance/trends/types.tsx":(e,t,n)=>{let r,i,a;n.d(t,{ER:()=>r,Z2:()=>i,A2:()=>a}),function(e){e.IMPROVED="improved",e.REGRESSION="regression"}(r||(r={})),function(e){e.P50="p50",e.P75="p75",e.P95="p95",e.P99="p99",e.AVG="avg"}(i||(i={})),function(e){e.DURATION="transaction.duration",e.LCP="measurements.lcp",e.FCP="measurements.fcp",e.FID="measurements.fid",e.CLS="measurements.cls",e.SPANS_DB="spans.db",e.SPANS_HTTP="spans.http",e.SPANS_BROWSER="spans.browser",e.SPANS_RESOURCE="spans.resource"}(a||(a={}))},"./app/views/performance/trends/utils.tsx":(e,t,n)=>{n.d(t,{_1:()=>m,bg:()=>h,T1:()=>g,te:()=>x,es:()=>y,vt:()=>S,Ws:()=>b,CE:()=>C,IO:()=>P,ed:()=>_,Kt:()=>A,_H:()=>j,kM:()=>D,iF:()=>E,wx:()=>T,RP:()=>z,j_:()=>V,P4:()=>N,HF:()=>F,vq:()=>B}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/downsample/methods/ASAP.js"),i=n("../node_modules/moment/moment.js"),a=n.n(i),o=n("./app/components/charts/utils.tsx"),s=n("./app/locale.tsx"),l=n("./app/utils/discover/fields.tsx"),d=n("./app/utils/queryString.tsx"),c=n("./app/utils/theme.tsx"),p=n("./app/utils/tokenizeSearch.tsx"),u=n("./app/views/performance/trends/types.tsx");const m="14d",h="15min",g=[{label:"p50",field:u.Z2.P50,alias:"percentile_range",legendLabel:"p50"},{label:"p75",field:u.Z2.P75,alias:"percentile_range",legendLabel:"p75"},{label:"p95",field:u.Z2.P95,alias:"percentile_range",legendLabel:"p95"},{label:"p99",field:u.Z2.P99,alias:"percentile_range",legendLabel:"p99"},{label:"average",field:u.Z2.AVG,alias:"avg_range",legendLabel:"average"}],v=[{label:"Duration",column:u.A2.DURATION},{label:"LCP",column:u.A2.LCP},{label:"FCP",column:u.A2.FCP},{label:"FID",column:u.A2.FID},{label:"CLS",column:u.A2.CLS}],f=[{label:"Spans (http)",column:u.A2.SPANS_HTTP},{label:"Spans (db)",column:u.A2.SPANS_DB},{label:"Spans (browser)",column:u.A2.SPANS_BROWSER},{label:"Spans (resource)",column:u.A2.SPANS_RESOURCE}];function x({canSeeSpanOpTrends:e}={canSeeSpanOpTrends:!1}){return e?[...v,...f]:[...v]}const y={[u.ER.IMPROVED]:{lighter:c.ZP.green200,default:c.ZP.green300},[u.ER.REGRESSION]:{lighter:c.ZP.red200,default:c.ZP.red300}},Z={[u.ER.IMPROVED]:"improvedSelected",[u.ER.REGRESSION]:"regressionSelected"},w={[u.ER.IMPROVED]:"improvedUnselectedSeries",[u.ER.REGRESSION]:"regressionUnselectedSeries"},S={[u.ER.IMPROVED]:"improvedCursor",[u.ER.REGRESSION]:"regressionCursor"};function b(){const e={};return Object.values(S).forEach((t=>e[t]=void 0)),e}function C(e){var t;const n=(0,d.ro)(null==e||null===(t=e.query)||void 0===t?void 0:t.trendFunction);return g.find((({field:e})=>e===n))||g[0]}function P(e){var t;const n=(0,d.ro)(null==e||null===(t=e.query)||void 0===t?void 0:t.trendParameter);return v.find((({label:e})=>e===n))||v[0]}function _(e,t){return(0,l.sN)({kind:"function",function:[e,t,void 0,void 0]})}function A(e,t){return{fromSeconds:e/1e3,toSeconds:t/1e3,showDigits:e>1e3||t>1e3||e<10||t<10}}function j(e,t){if(!e.project||!t)return;const n=t.find((t=>t.slug===e.project));return null==n?void 0:n.id}function D(e,t,n,r){const i=C(t),a=P(t),s=[...r?[]:["transaction"],"project"].map((e=>({field:e}))),l={field:"trend_percentage()",kind:"asc"};e.trendType=n,n===u.ER.REGRESSION&&(l.kind="desc"),i&&a&&(e.trendFunction=_(i.field,a.column)),e.query=function(e){const t=new p.MY(e);return t.hasFilter("count_percentage()")||t.addFilterValues("count_percentage()",[">0.25","<4"]),t.hasFilter("trend_percentage()")||t.addFilterValues("trend_percentage()",[">0%"]),t.hasFilter("confidence()")||t.addFilterValues("confidence()",[">6"]),t.formatString()}(e.query),e.interval=function(e,t){var n;const r=(0,d.ro)(null==e||null===(n=e.query)||void 0===n?void 0:n.interval),{start:i,end:a,statsPeriod:s}=t,l={start:i||null,end:a||null,period:s},c=(0,o.ZS)(l,"high");return r||c}(t,e),e.sorts=[l],e.fields=s}function E(e,t){const{query:n}=t,r=n.start&&n.end;return n.statsPeriod||r||(e.statsPeriod=m),e}function T(e,t){const n=Math.abs(e);return{seconds:n/1e3,fixedDigits:n>1e3||n<10?1:0,changeLabel:t===u.ER.REGRESSION?(0,s.t)("slower"):(0,s.t)("faster")}}function z(e){const t=a()();return e.map((e=>({...e,received_at:t,transaction:e.transaction})))}function V(e){return Z[e]}function N(e){return w[e]}const k=(e,t=100)=>(0,r.Cl)(e,t),F=e=>["p50","p75"].find((t=>e.includes(t)));function B(e,t){let n=Number.MAX_SAFE_INTEGER,r=0;if(!e)return{maxValue:r,minValue:n,smoothedResults:void 0};const i=[];for(const a of e){const e=a.data,o=[],s=k(e.map((({name:e,value:t})=>[Number(e),t])));for(let e=0;e<s.length;e++){const t=s[e],i=t.y;if(o.push({name:t.x,value:i}),!isNaN(i)){const e=Math.round(i);n=Math.min(e,n),r=Math.max(e,r)}}i.push({seriesName:t||a.seriesName||"Current",data:o,lineStyle:a.lineStyle,color:a.color})}return{minValue:n,maxValue:r,smoothedResults:i}}}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_content_tsx.a86352d6897057b6d84ba337d81e5253.js.map