"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_projectIssueGrouping_index_tsx"],{"./app/utils/routeTitle.tsx":(e,t,s)=>{s.d(t,{Z:()=>o});const o=function(e,t,s=!0,o){const n="".concat(e," - ").concat(t),i=o?"".concat(n," - ").concat(o):n;return s?"".concat(i," - Sentry"):i}},"./app/views/asyncView.tsx":(e,t,s)=>{s.d(t,{Z:()=>a}),s("../node_modules/react/index.js");var o=s("../node_modules/react-document-title/index.js"),n=s.n(o),i=s("./app/components/asyncComponent.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class a extends i.Z{getTitle(){return""}render(){const e=this.getTitle();return(0,r.tZ)(n(),{title:"".concat(e?"".concat(e," - "):"","Sentry"),children:this.renderComponent()})}}a.displayName="AsyncView"},"./app/views/settings/components/forms/formPanel.tsx":(e,t,s)=>{s.d(t,{Z:()=>c});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),r=s("./app/components/panels/index.tsx"),a=s("./app/icons/index.tsx"),l=s("./app/utils/sanitizeQuerySelector.tsx"),d=s("./app/views/settings/components/forms/fieldFromConfig.tsx"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class c extends i.Component{constructor(...e){super(...e),(0,o.Z)(this,"state",{collapsed:!1}),(0,o.Z)(this,"handleToggleEvents",(()=>{const{collapsed:e}=this.state;this.setState({collapsed:!e})}))}render(){const{title:e,fields:t,access:s,disabled:o,additionalFieldProps:n,renderFooter:i,renderHeader:c,collapsible:g,...m}=this.props,{collapsed:h}=this.state;return(0,p.BX)(r.s_,{id:"string"==typeof e?(0,l.m)(e):void 0,children:[e&&(0,p.BX)(r.V9,{children:[e,g&&(0,p.tZ)(u,{onClick:this.handleToggleEvents,children:(0,p.tZ)(a.g6,{direction:h?"down":"up",size:"xs"})})]}),!h&&(0,p.BX)(r.N,{children:["function"==typeof c&&c({title:e,fields:t}),t.map((e=>{if("function"==typeof e)return e();const{defaultValue:t,...i}=e;return!0===o&&(i.disabled=!0,i.disabledReason=void 0),(0,p.tZ)(d.Z,{access:s,disabled:o,...m,...n,field:i,highlighted:this.props.highlighted==="#".concat(e.name)},e.name)})),"function"==typeof i&&i({title:e,fields:t})]})]})}}c.displayName="FormPanel",(0,o.Z)(c,"defaultProps",{additionalFieldProps:{}});const u=(0,n.Z)("span",{target:"efsz5z60"})({name:"e0dnmk",styles:"cursor:pointer"})},"./app/views/settings/components/forms/jsonForm.tsx":(e,t,s)=>{s.d(t,{Z:()=>m});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("../node_modules/react-router/es/index.js"),r=s("../node_modules/@sentry/minimal/esm/index.js"),a=s("../node_modules/scroll-to-element/index.js"),l=s.n(a),d=s("./app/utils.tsx"),p=s("./app/utils/sanitizeQuerySelector.tsx"),c=s("./app/views/settings/components/forms/formPanel.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class g extends n.Component{constructor(...e){var t;super(...e),(0,o.Z)(this,"state",{highlighted:null===(t=this.props.location)||void 0===t?void 0:t.hash})}componentDidMount(){this.scrollToHash()}UNSAFE_componentWillReceiveProps(e){if(this.props.location.hash!==e.location.hash){const t=e.location.hash;this.scrollToHash(t),this.setState({highlighted:t})}}scrollToHash(e){var t;const s=e||(null===(t=this.props.location)||void 0===t?void 0:t.hash);if(s)try{l()((0,p.m)(decodeURIComponent(s)),{align:"middle",offset:-100})}catch(e){r.Tb(e)}}shouldDisplayForm(e){const t=e.filter((e=>"function"!=typeof e&&(0,d.ri)(null==e?void 0:e.visible)));if(e.length===t.length){const{additionalFieldProps:e,...s}=this.props;return!t.every((t=>"function"==typeof t.visible?!t.visible({...s,...e}):!t.visible))}return!0}renderForm({fields:e,formPanelProps:t,title:s}){return this.shouldDisplayForm(e)||null!=t&&t.renderFooter||null!=t&&t.renderHeader?(0,u.tZ)(c.Z,{title:s,fields:e,...t}):null}render(){const{access:e,collapsible:t,fields:s,title:o,forms:i,disabled:r,features:a,additionalFieldProps:l,renderFooter:d,renderHeader:p,location:c,...g}=this.props,m={access:e,disabled:r,features:a,additionalFieldProps:l,renderFooter:d,renderHeader:p,highlighted:this.state.highlighted,collapsible:t};return(0,u.BX)("div",{...g,children:[void 0!==i&&i.map(((e,t)=>(0,u.tZ)(n.Fragment,{children:this.renderForm({formPanelProps:m,...e})},t))),void 0===i&&void 0!==s&&this.renderForm({fields:s,formPanelProps:m,title:o})]})}}g.displayName="JsonForm";const m=(0,i.withRouter)(g)},"./app/views/settings/projectIssueGrouping/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>P});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("./app/actions/projectActions.tsx"),r=s("./app/components/acl/feature.tsx"),a=s("./app/components/links/externalLink.tsx"),l=s("./app/data/forms/projectIssueGrouping.tsx"),d=s("./app/locale.tsx"),p=s("./app/utils/routeTitle.tsx"),c=s("./app/views/asyncView.tsx"),u=s("./app/views/settings/components/forms/form.tsx"),g=s("./app/views/settings/components/forms/jsonForm.tsx"),m=s("./app/views/settings/components/settingsPageHeader.tsx"),h=s("./app/views/settings/components/text/textBlock.tsx"),f=s("./app/actionCreators/indicator.tsx"),x=s("./app/components/alert.tsx"),Z=s("./app/components/button.tsx"),v=s("./app/components/confirm.tsx"),y=s("./app/components/panels/index.tsx"),b=s("./app/utils/handleXhrErrorResponse.tsx"),j=s("./app/utils/marked.tsx"),w=s("./app/views/settings/components/forms/field/index.tsx"),_=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const C="upgrade-grouping";function k({groupingConfigs:e,organization:t,projectId:s,project:o,onUpgrade:r,api:a,location:l}){const p=t.access.includes("project:write"),{updateNotes:c,riskLevel:u,latestGroupingConfig:g}=function(e,t){const s={};let o="",n=0,i=null;if(t.forEach((t=>{s[t.id]=t,t.latest&&e.groupingConfig!==t.id&&(o=t.changelog,i=t,n=t.risk)})),i){var r;let t=null!==(r=i.base)&&void 0!==r?r:"";for(;t!==e.groupingConfig;){var a;const e=s[t];if(!e)break;n=Math.max(n,e.risk),o=e.changelog+"\n"+o,t=null!==(a=e.base)&&void 0!==a?a:""}}return{updateNotes:o,riskLevel:n,latestGroupingConfig:i}}(o,e),{riskNote:m,alertType:k}=function(e){switch(e){case 0:return{riskNote:(0,d.t)("This upgrade has the chance to create some new issues."),alertType:"info"};case 1:return{riskNote:(0,d.t)("This upgrade will create some new issues."),alertType:"warning"};case 2:return{riskNote:(0,_.tZ)("strong",{children:(0,d.t)("The new grouping strategy is incompatible with the current and will create entirely new issues.")}),alertType:"error"};default:return{riskNote:void 0,alertType:void 0}}}(u),T=!g,F=u>=2?"danger":"primary";if((0,n.useEffect)((()=>{l.hash==="#".concat(C)&&!T&&e&&p&&S()}),[l.hash]),!e)return null;async function P(){const e={};if(g){const t=Math.floor((new Date).getTime()/1e3),s=7776e3;e.groupingConfig=g.id,e.secondaryGroupingConfig=o.groupingConfig,e.secondaryGroupingExpiry=t+s}(0,f.E3)((0,d.t)("Changing groupingâ€¦"));try{const o=await a.requestPromise("/projects/".concat(t.slug,"/").concat(s,"/"),{method:"PUT",data:e});(0,f.B8)(),i.Z.updateSuccess(o),r()}catch{(0,b.Z)((0,d.t)("Unable to upgrade config"))}}function S(){(0,v._)({confirmText:(0,d.t)("Upgrade"),priority:F,onConfirm:P,message:(0,_.BX)(n.Fragment,{children:[(0,_.tZ)(h.Z,{children:(0,_.tZ)("strong",{children:(0,d.t)("Upgrade Grouping Strategy")})}),(0,_.tZ)(h.Z,{children:(0,d.t)("You can upgrade the grouping strategy to the latest but this is an irreversible operation.")}),(0,_.BX)(h.Z,{children:[(0,_.tZ)("strong",{children:(0,d.t)("New Behavior")}),(0,_.tZ)("div",{dangerouslySetInnerHTML:{__html:(0,j.Z)(c)}})]}),(0,_.tZ)(h.Z,{children:(0,_.tZ)(x.Z,{type:k,children:m})})]})})}return(0,_.BX)(y.s_,{id:C,children:[(0,_.tZ)(y.V9,{children:(0,d.t)("Upgrade Grouping")}),(0,_.tZ)(y.N,{children:(0,_.tZ)(w.Z,{label:(0,d.t)("Upgrade Grouping Strategy"),help:(0,d._N)("If the project uses an old grouping strategy an update is possible.[linebreak]Doing so will cause new events to group differently.",{linebreak:(0,_.tZ)("br",{})}),disabled:!0,children:(0,_.tZ)("div",{children:(0,_.tZ)(Z.ZP,{onClick:S,disabled:!p||T,title:p?T?(0,d.t)("You are already on the latest version"):void 0:(0,d.t)("You do not have sufficient permissions to do this"),type:"button",priority:F,children:(0,d.t)("Upgrade Grouping Strategy")})})})})]})}k.displayName="UpgradeGrouping";const T=k;class F extends c.Z{constructor(...e){super(...e),(0,o.Z)(this,"handleSubmit",(e=>{i.Z.updateSuccess(e)}))}getTitle(){const{projectId:e}=this.props.params;return(0,p.Z)((0,d.t)("Issue Grouping"),e,!1)}getDefaultState(){return{...super.getDefaultState(),groupingConfigs:[]}}getEndpoints(){const{projectId:e,orgId:t}=this.props.params;return[["groupingConfigs","/projects/".concat(t,"/").concat(e,"/grouping-configs/")]]}renderBody(){const{groupingConfigs:e}=this.state,{organization:t,project:s,params:o,location:i}=this.props,{orgId:p,projectId:c}=o,f="/projects/".concat(p,"/").concat(c,"/"),x=new Set(t.access),Z={additionalFieldProps:{organization:t,groupingConfigs:e},features:new Set(t.features),access:x,disabled:!x.has("project:write")};return(0,_.BX)(n.Fragment,{children:[(0,_.tZ)(m.Z,{title:(0,d.t)("Issue Grouping")}),(0,_.tZ)(h.Z,{children:(0,d._N)("All events have a fingerprint. Events with the same fingerprint are grouped together into an issue. To learn more about issue grouping, [link: read the docs].",{link:(0,_.tZ)(a.Z,{href:"https://docs.sentry.io/product/data-management-settings/event-grouping/"})})}),(0,_.BX)(u.Z,{saveOnBlur:!0,allowUndo:!0,initialData:s,apiMethod:"PUT",apiEndpoint:f,onSubmitSuccess:this.handleSubmit,children:[(0,_.tZ)(g.Z,{...Z,title:(0,d.t)("Fingerprint Rules"),fields:[l.fields.fingerprintingRules]}),(0,_.tZ)(g.Z,{...Z,title:(0,d.t)("Stack Trace Rules"),fields:[l.fields.groupingEnhancements]}),(0,_.tZ)(r.Z,{features:["set-grouping-config"],organization:t,children:(0,_.tZ)(g.Z,{...Z,title:(0,d.t)("Change defaults"),fields:[l.fields.groupingConfig,l.fields.secondaryGroupingConfig,l.fields.secondaryGroupingExpiry]})}),(0,_.tZ)(T,{groupingConfigs:null!=e?e:[],organization:t,projectId:o.projectId,project:s,api:this.api,onUpgrade:this.fetchData,location:i})]})]})}}const P=F}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_projectIssueGrouping_index_tsx.a42dd668dce0d2bdd7f9bce4970bb507.js.map