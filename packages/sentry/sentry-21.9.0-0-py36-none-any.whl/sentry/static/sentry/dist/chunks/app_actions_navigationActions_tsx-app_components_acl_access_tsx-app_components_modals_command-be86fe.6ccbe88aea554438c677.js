"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_actions_navigationActions_tsx-app_components_acl_access_tsx-app_components_modals_command-be86fe"],{"./app/actions/navigationActions.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var o=s("../node_modules/reflux/src/index.js");const r=s.n(o)().createActions(["setLastRoute"])},"./app/actions/organizationsActions.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var o=s("../node_modules/reflux/src/index.js");const r=s.n(o)().createActions(["update","setActive","changeSlug","remove","removeSuccess","removeError"])},"./app/actions/projectActions.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var o=s("../node_modules/reflux/src/index.js");const r=s.n(o)().createActions(["addTeam","addTeamError","addTeamSuccess","changeSlug","createSuccess","loadProjects","loadStats","loadStatsError","loadStatsForProjectSuccess","loadStatsSuccess","removeProject","removeProjectError","removeProjectSuccess","removeTeam","removeTeamError","removeTeamSuccess","reset","setActive","update","updateError","updateSuccess"])},"./app/actions/teamActions.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var o=s("../node_modules/reflux/src/index.js");const r=s.n(o)().createActions(["createTeam","createTeamError","createTeamSuccess","fetchAll","fetchAllError","fetchAllSuccess","fetchDetails","fetchDetailsError","fetchDetailsSuccess","loadTeams","removeTeam","removeTeamError","removeTeamSuccess","update","updateError","updateSuccess"])},"./app/components/acl/access.tsx":(e,t,s)=>{s.d(t,{Z:()=>m});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/react/index.js"),i=s("./app/components/alert.tsx"),a=s("./app/icons/index.tsx"),n=s("./app/locale.tsx"),c=s("./app/utils/isRenderFunc.tsx"),l=s("./app/utils/withConfig.tsx"),d=s("./app/utils/withOrganization.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const h=(0,u.tZ)(i.Z,{type:"error",icon:(0,u.tZ)(a.aU,{size:"md"}),children:(0,n.t)("You do not have sufficient permissions to access this.")});class p extends r.Component{render(){const{organization:e,config:t,access:s,requireAll:o,isSuperuser:r,renderNoAccessMessage:i,children:a}=this.props,{access:n}=e||{access:[]},l=!s||s[o?"every":"some"]((e=>n.includes(e))),d=!(!t.user||!t.user.isSuperuser),u={hasAccess:l,hasSuperuser:d},p=l&&(!r||d);return p||"function"!=typeof i?!p&&i?h:(0,c.l)(a)?a(u):p?a:null:i(u)}}p.displayName="Access",(0,o.Z)(p,"defaultProps",{renderNoAccessMessage:!1,isSuperuser:!1,requireAll:!0,access:[]});const m=(0,d.Z)((0,l.Z)(p))},"./app/components/modals/commandPalette.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>f,modalCss:()=>j});var o,r=s("../node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js"),i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=s("../node_modules/react/index.js"),n=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),c=s("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),l=s("./app/components/search/index.tsx"),d=s("./app/locale.tsx"),u=s("./app/styles/space.tsx"),h=s("./app/utils/analytics.tsx"),p=s("./app/views/settings/components/forms/controls/input.tsx"),m=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class g extends a.Component{componentDidMount(){(0,h.co)("omnisearch.open",{})}render(){const{theme:e,Body:t}=this.props;return(0,m.tZ)(t,{children:(0,m.tZ)(n.ms,{children:({css:t})=>(0,m.tZ)(l.Z,{entryPoint:"command_palette",minSearch:1,maxResults:10,dropdownStyle:t(o||(o=(0,r.Z)(["\n                width: 100%;\n                border: transparent;\n                border-top-left-radius: 0;\n                border-top-right-radius: 0;\n                position: initial;\n                box-shadow: none;\n                border-top: 1px solid ",";\n              "])),e.border),renderInput:({getInputProps:e})=>(0,m.tZ)(S,{children:(0,m.tZ)(x,{autoFocus:!0,...e({type:"text",placeholder:(0,d.t)("Search for projects, teams, settings, etc...")})})})})})})}}g.displayName="CommandPalette";const f=(0,c.b)(g),j={name:"1cwzvuz",styles:"[role='document']{padding:0;}"},S=(0,i.Z)("div",{target:"e1pb71cf1"})("padding:",(0,u.Z)(.25),";"),x=(0,i.Z)(p.Z,{target:"e1pb71cf0"})("width:100%;padding:",(0,u.Z)(1),";border-radius:8px;outline:none;border:none;box-shadow:none;:focus,:active,:hover{outline:none;border:none;box-shadow:none;}")},"./app/data/forms/accountEmails.tsx":(e,t,s)=>{s.r(t),s.d(t,{route:()=>o,default:()=>r});const o="/settings/account/emails/",r=[{title:"Add Secondary Emails",fields:[{name:"email",type:"string",label:"Additional Email",placeholder:"e.g. secondary@example.com",help:"Designate an alternative email for this account",showReturnButton:!0}]}]},"./app/stores/organizationsStore.tsx":(e,t,s)=>{s.d(t,{Z:()=>a}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=s("../node_modules/reflux/src/index.js"),r=s.n(o);const i={listenables:[s("./app/actions/organizationsActions.tsx").Z],state:[],loaded:!1,getInitialState(){return this.state},init(){this.state=[],this.loaded=!1},onUpdate(e){this.add(e)},onChangeSlug(e,t){e.slug!==t.slug&&(this.remove(e.slug),this.add(t))},onRemoveSuccess(e){this.remove(e)},get(e){return this.state.find((t=>t.slug===e))},getAll(){return this.state},remove(e){this.state=this.state.filter((t=>e!==t.slug)),this.trigger(this.state)},add(e){let t=!1;this.state.forEach(((s,o)=>{s.id===e.id&&(e={...s,...e},this.state[o]=e,t=!0)})),t||(this.state=[...this.state,e]),this.trigger(this.state)},load(e){this.state=e,this.loaded=!0,this.trigger(e)}},a=r().createStore(i)},"./app/stores/projectsStore.tsx":(e,t,s)=>{s.d(t,{Z:()=>c}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=s("../node_modules/reflux/src/index.js"),r=s.n(o),i=s("./app/actions/projectActions.tsx"),a=s("./app/actions/teamActions.tsx");const n={itemsById:{},loading:!0,init(){this.reset(),this.listenTo(i.Z.addTeamSuccess,this.onAddTeam),this.listenTo(i.Z.changeSlug,this.onChangeSlug),this.listenTo(i.Z.createSuccess,this.onCreateSuccess),this.listenTo(i.Z.loadProjects,this.loadInitialData),this.listenTo(i.Z.loadStatsSuccess,this.onStatsLoadSuccess),this.listenTo(i.Z.removeTeamSuccess,this.onRemoveTeam),this.listenTo(i.Z.reset,this.reset),this.listenTo(i.Z.updateSuccess,this.onUpdateSuccess),this.listenTo(a.Z.removeTeamSuccess,this.onDeleteTeam)},reset(){this.itemsById={},this.loading=!0},loadInitialData(e){this.itemsById=e.reduce(((e,t)=>(e[t.id]=t,e)),{}),this.loading=!1,this.trigger(new Set(Object.keys(this.itemsById)))},onChangeSlug(e,t){const s=this.getBySlug(e);if(!s)return;const o={...s,slug:t};this.itemsById={...this.itemsById,[o.id]:o},this.trigger(new Set([s.id]))},onCreateSuccess(e){this.itemsById={...this.itemsById,[e.id]:e},this.trigger(new Set([e.id]))},onUpdateSuccess(e){const t=this.getById(e.id);if(!t)return;const s=Object.assign({},t,e);this.itemsById={...this.itemsById,[t.id]:s},this.trigger(new Set([e.id]))},onStatsLoadSuccess(e){const t=[];Object.entries(e||{}).forEach((([e,s])=>{e in this.itemsById&&(this.itemsById[e].stats=s,t.push(e))})),this.trigger(new Set(t))},onDeleteTeam(e){const t=this.getWithTeam(e).map((t=>(this.removeTeamFromProject(e,t),t.id)));this.trigger(new Set([t]))},onRemoveTeam(e,t){const s=this.getBySlug(t);s&&(this.removeTeamFromProject(e,s),this.trigger(new Set([s.id])))},onAddTeam(e,t){const s=this.getBySlug(t);s&&(this.itemsById={...this.itemsById,[s.id]:{...s,teams:[...s.teams,e]}},this.trigger(new Set([s.id])))},removeTeamFromProject(e,t){const s=t.teams.filter((({slug:t})=>t!==e));this.itemsById={...this.itemsById,[t.id]:{...t,teams:s}}},getWithTeam(e){return this.getAll().filter((({teams:t})=>t.find((({slug:t})=>t===e))))},getAll(){return Object.values(this.itemsById).sort(((e,t)=>e.slug>t.slug?1:e.slug<t.slug?-1:0))},getById(e){return this.getAll().find((t=>t.id===e))},getBySlug(e){return this.getAll().find((t=>t.slug===e))},getBySlugs(e){return this.getAll().filter((t=>e.includes(t.slug)))},getState(e){return{projects:e?this.getBySlugs(e):this.getAll(),loading:this.loading}}},c=r().createStore(n)},"./app/utils/parseLinkHeader.tsx":(e,t,s)=>{function o(e){if(null===e||""===e)return{};const t=e.split(","),s={};return t.forEach((e=>{const t=/<([^>]+)>; rel="([^"]+)"(?:; results="([^"]+)")?(?:; cursor="([^"]+)")?/g.exec(e),o="true"===t[3]||"false"!==t[3]&&null;s[t[2]]={href:t[1],results:o,cursor:t[4]}})),s}s.d(t,{Z:()=>o})},"./app/utils/projects.tsx":(e,t,s)=>{s.d(t,{Z:()=>S});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("../node_modules/lodash/memoize.js"),a=s.n(i),n=s("../node_modules/lodash/partition.js"),c=s.n(n),l=s("../node_modules/lodash/uniqBy.js"),d=s.n(l),u=s("./app/actions/projectActions.tsx"),h=s("./app/stores/projectsStore.tsx"),p=s("./app/utils.tsx"),m=s("./app/utils/parseLinkHeader.tsx"),g=s("./app/utils/withApi.tsx"),f=s("./app/utils/withProjects.tsx");class j extends r.Component{constructor(...e){super(...e),(0,o.Z)(this,"state",{fetchedProjects:[],projectsFromStore:[],initiallyLoaded:!1,fetching:!1,isIncomplete:null,hasMore:null,prevSearch:null,nextCursor:null,fetchError:null}),(0,o.Z)(this,"fetchQueue",new Set),(0,o.Z)(this,"getProjectsMap",a()((e=>new Map(e.map((e=>[e.slug,e])))))),(0,o.Z)(this,"loadSpecificProjects",(()=>{const{slugs:e,projects:t}=this.props,s=this.getProjectsMap(t),[o,r]=c()(e,(e=>s.has(e))),i=o.map((e=>s.get(e))).filter(p.ri);r.forEach((e=>this.fetchQueue.add(e))),this.setState({fetchedProjects:r.map((e=>({slug:e}))),initiallyLoaded:!!o.length,projectsFromStore:i}),r.length&&this.fetchSpecificProjects()})),(0,o.Z)(this,"fetchSpecificProjects",(async()=>{const{api:e,orgId:t,passthroughPlaceholderProject:s}=this.props;if(!this.fetchQueue.size)return;this.setState({fetching:!0});let o=[],r=null;try{const{results:s}=await x(e,t,{slugs:Array.from(this.fetchQueue)});o=s}catch(e){console.error(e),r=e}const i=this.getProjectsMap(o),a=Array.from(this.fetchQueue).map((e=>i.has(e)?i.get(e):s?{slug:e}:null)).filter(p.ri);this.setState({fetchedProjects:a,isIncomplete:this.fetchQueue.size!==o.length,initiallyLoaded:!0,fetching:!1,fetchError:r}),this.fetchQueue.clear()})),(0,o.Z)(this,"loadAllProjects",(async()=>{const{api:e,orgId:t,limit:s,allProjects:o}=this.props;this.setState({fetching:!0});try{const{results:r,hasMore:i,nextCursor:a}=await x(e,t,{limit:s,allProjects:o});this.setState({fetching:!1,fetchedProjects:r,initiallyLoaded:!0,hasMore:i,nextCursor:a})}catch(e){console.error(e),this.setState({fetching:!1,fetchedProjects:[],initiallyLoaded:!0,fetchError:e})}})),(0,o.Z)(this,"handleSearch",(async(e,{append:t}={})=>{const{api:s,orgId:o,limit:r}=this.props,{prevSearch:i}=this.state,a=this.state.nextCursor;this.setState({fetching:!0});try{const{results:n,hasMore:c,nextCursor:l}=await x(s,o,{search:e,limit:r,prevSearch:i,cursor:a});this.setState((s=>{let o;return o=t?d()([...s.fetchedProjects,...n],(({slug:e})=>e)):n,{fetchedProjects:o,hasMore:c,fetching:!1,prevSearch:e,nextCursor:l}}))}catch(e){console.error(e),this.setState({fetching:!1,fetchError:e})}}))}componentDidMount(){const{slugs:e}=this.props;e&&e.length?this.loadSpecificProjects():this.loadAllProjects()}render(){const{slugs:e,children:t}=this.props;return t({projects:this.state.initiallyLoaded?[...this.state.fetchedProjects,...this.state.projectsFromStore]:e&&e.map((e=>({slug:e})))||[],isIncomplete:this.state.isIncomplete,fetching:this.state.fetching,hasMore:this.state.hasMore,onSearch:this.handleSearch,initiallyLoaded:this.state.initiallyLoaded,fetchError:this.state.fetchError})}}j.displayName="Projects",(0,o.Z)(j,"defaultProps",{passthroughPlaceholderProject:!0});const S=(0,f.Z)((0,g.Z)(j));async function x(e,t,{slugs:s,search:o,limit:r,prevSearch:i,cursor:a,allProjects:n}={}){const c={collapse:["latestDeploys"]};if(s&&s.length&&(c.query=s.map((e=>"slug:".concat(e))).join(" ")),o&&(c.query="".concat(c.query?"".concat(c.query," "):"").concat(o)),(i||o)&&i!==o||!a||(c.cursor=a),r&&(c.per_page=r),n){const{loading:e,projects:t}=h.Z.getState();if(!e)return{results:t,hasMore:!1};c.all_projects=1}let l=!1,d=null;const[p,,g]=await e.requestPromise("/organizations/".concat(t,"/projects/"),{includeAllArgs:!0,query:c}),f=null==g?void 0:g.getResponseHeader("Link");if(f){const e=(0,m.Z)(f);l=e&&(e.next.results||e.previous.results),d=e.next.cursor}return n&&u.Z.loadProjects(p),{results:p,hasMore:l,nextCursor:d}}},"./app/utils/useApi.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var o=s("../node_modules/react/index.js"),r=s("./app/api.tsx");const i=function({persistInFlight:e,api:t}={}){const s=(0,o.useRef)();void 0===s.current&&void 0===t&&(s.current=new r.KU);const i=null!=t?t:s.current;function a(){!e&&i.clear()}return(0,o.useEffect)((()=>a),[]),i}},"./app/utils/withApi.tsx":(e,t,s)=>{s.d(t,{Z:()=>a});var o=s("./app/utils/getDisplayName.tsx"),r=s("./app/utils/useApi.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=(e,t={})=>{const s=({api:s,...o})=>{const a=(0,r.Z)({api:s,...t});return(0,i.tZ)(e,{...o,api:a})};return s.displayName="withApi(".concat((0,o.Z)(e),")"),s}},"./app/utils/withProjects.tsx":(e,t,s)=>{s.d(t,{Z:()=>c});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("./app/stores/projectsStore.tsx"),a=s("./app/utils/getDisplayName.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const c=function(e){class t extends r.Component{constructor(...e){super(...e),(0,o.Z)(this,"state",i.Z.getState()),(0,o.Z)(this,"unsubscribe",i.Z.listen((()=>this.setState(i.Z.getState())),void 0))}componentWillUnmount(){this.unsubscribe()}render(){return(0,n.tZ)(e,{...this.props,projects:this.state.projects,loadingProjects:this.state.loading})}}return t.displayName="WithProjects",(0,o.Z)(t,"displayName","withProjects(".concat((0,a.Z)(e),")")),t}}}]);
//# sourceMappingURL=../sourcemaps/app_actions_navigationActions_tsx-app_components_acl_access_tsx-app_components_modals_command-be86fe.797ecd246961a1b93a9e60dc4605b520.js.map