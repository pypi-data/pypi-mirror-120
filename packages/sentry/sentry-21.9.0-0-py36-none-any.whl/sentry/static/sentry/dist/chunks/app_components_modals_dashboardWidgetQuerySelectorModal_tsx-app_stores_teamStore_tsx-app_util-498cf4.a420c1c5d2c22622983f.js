"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_components_modals_dashboardWidgetQuerySelectorModal_tsx-app_stores_teamStore_tsx-app_util-498cf4"],{"./app/actions/projectActions.tsx":(e,t,s)=>{s.d(t,{Z:()=>o});var i=s("../node_modules/reflux/src/index.js");const o=s.n(i)().createActions(["addTeam","addTeamError","addTeamSuccess","changeSlug","createSuccess","loadProjects","loadStats","loadStatsError","loadStatsForProjectSuccess","loadStatsSuccess","removeProject","removeProjectError","removeProjectSuccess","removeTeam","removeTeamError","removeTeamSuccess","reset","setActive","update","updateError","updateSuccess"])},"./app/actions/teamActions.tsx":(e,t,s)=>{s.d(t,{Z:()=>o});var i=s("../node_modules/reflux/src/index.js");const o=s.n(i)().createActions(["createTeam","createTeamError","createTeamSuccess","fetchAll","fetchAllError","fetchAllSuccess","fetchDetails","fetchDetailsError","fetchDetailsSuccess","loadTeams","removeTeam","removeTeamError","removeTeamSuccess","update","updateError","updateSuccess"])},"./app/components/modals/dashboardWidgetQuerySelectorModal.tsx":(e,t,s)=>{s.r(t),s.d(t,{modalCss:()=>w,default:()=>b});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=s("../node_modules/react/index.js"),r=s("../node_modules/react-router/es/index.js"),a=s("./app/components/button.tsx"),n=s("./app/icons/index.tsx"),d=s("./app/locale.tsx"),l=s("./app/styles/space.tsx"),c=s("./app/utils/withApi.tsx"),u=s("./app/utils/withGlobalSelection.tsx"),m=s("./app/views/dashboardsV2/utils.tsx"),h=s("./app/views/settings/components/forms/controls/input.tsx"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class g extends o.Component{renderQueries(){const{organization:e,widget:t,selection:s}=this.props;return t.queries.map(((i,a)=>{const l=(0,m.tT)(t.title,i,s,t.displayType);return(0,p.tZ)(o.Fragment,{children:(0,p.BX)(y,{children:[(0,p.BX)(f,{children:[(0,p.tZ)(v,{htmlFor:"smart-search-input","aria-label":(0,d.t)("Search events"),children:(0,p.tZ)(n.jV,{})}),(0,p.tZ)(S,{value:i.conditions,disabled:!0})]}),(0,p.tZ)(x,{priority:"primary",icon:(0,p.tZ)(n.g6,{size:"xs",direction:"right"}),onClick:()=>{r.browserHistory.push(l.getResultsViewUrlTarget(e.slug))}})]})},a)}))}render(){const{Body:e,Header:t,widget:s}=this.props;return(0,p.BX)(o.Fragment,{children:[(0,p.tZ)(t,{closeButton:!0,children:(0,p.tZ)("h4",{children:s.title})}),(0,p.BX)(e,{children:[(0,p.tZ)("p",{children:(0,d.t)("Multiple queries were used to create this widget visualization. Which query would you like to view in Discover?")}),this.renderQueries()]})]})}}g.displayName="DashboardWidgetQuerySelectorModal";const S=(0,i.Z)(h.Z,{target:"e10oo76w4"})({name:"97snz3",styles:"text-overflow:ellipsis;padding:0px;box-shadow:none;height:auto;&:disabled{border:none;cursor:default;}"}),y=(0,i.Z)("div",{target:"e10oo76w3"})("display:flex;margin-bottom:",(0,l.Z)(1),";"),x=(0,i.Z)(a.ZP,{target:"e10oo76w2"})("margin-left:",(0,l.Z)(1),";"),f=(0,i.Z)("div",{target:"e10oo76w1"})("border:1px solid ",(e=>e.theme.border),";box-shadow:inset ",(e=>e.theme.dropShadowLight),";background:",(e=>e.theme.backgroundSecondary),";padding:7px ",(0,l.Z)(1),";position:relative;display:grid;grid-template-columns:max-content 1fr max-content;grid-gap:",(0,l.Z)(1),";align-items:start;flex-grow:1;border-radius:",(e=>e.theme.borderRadius),";"),v=(0,i.Z)("label",{target:"e10oo76w0"})("display:flex;padding:",(0,l.Z)(.5)," 0;margin:0;color:",(e=>e.theme.gray300),";"),w={name:"l07bt5",styles:"width:100%;max-width:700px;margin:70px auto"},b=(0,c.Z)((0,u.Z)(g))},"./app/stores/projectsStore.tsx":(e,t,s)=>{s.d(t,{Z:()=>d}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var i=s("../node_modules/reflux/src/index.js"),o=s.n(i),r=s("./app/actions/projectActions.tsx"),a=s("./app/actions/teamActions.tsx");const n={itemsById:{},loading:!0,init(){this.reset(),this.listenTo(r.Z.addTeamSuccess,this.onAddTeam),this.listenTo(r.Z.changeSlug,this.onChangeSlug),this.listenTo(r.Z.createSuccess,this.onCreateSuccess),this.listenTo(r.Z.loadProjects,this.loadInitialData),this.listenTo(r.Z.loadStatsSuccess,this.onStatsLoadSuccess),this.listenTo(r.Z.removeTeamSuccess,this.onRemoveTeam),this.listenTo(r.Z.reset,this.reset),this.listenTo(r.Z.updateSuccess,this.onUpdateSuccess),this.listenTo(a.Z.removeTeamSuccess,this.onDeleteTeam)},reset(){this.itemsById={},this.loading=!0},loadInitialData(e){this.itemsById=e.reduce(((e,t)=>(e[t.id]=t,e)),{}),this.loading=!1,this.trigger(new Set(Object.keys(this.itemsById)))},onChangeSlug(e,t){const s=this.getBySlug(e);if(!s)return;const i={...s,slug:t};this.itemsById={...this.itemsById,[i.id]:i},this.trigger(new Set([s.id]))},onCreateSuccess(e){this.itemsById={...this.itemsById,[e.id]:e},this.trigger(new Set([e.id]))},onUpdateSuccess(e){const t=this.getById(e.id);if(!t)return;const s=Object.assign({},t,e);this.itemsById={...this.itemsById,[t.id]:s},this.trigger(new Set([e.id]))},onStatsLoadSuccess(e){const t=[];Object.entries(e||{}).forEach((([e,s])=>{e in this.itemsById&&(this.itemsById[e].stats=s,t.push(e))})),this.trigger(new Set(t))},onDeleteTeam(e){const t=this.getWithTeam(e).map((t=>(this.removeTeamFromProject(e,t),t.id)));this.trigger(new Set([t]))},onRemoveTeam(e,t){const s=this.getBySlug(t);s&&(this.removeTeamFromProject(e,s),this.trigger(new Set([s.id])))},onAddTeam(e,t){const s=this.getBySlug(t);s&&(this.itemsById={...this.itemsById,[s.id]:{...s,teams:[...s.teams,e]}},this.trigger(new Set([s.id])))},removeTeamFromProject(e,t){const s=t.teams.filter((({slug:t})=>t!==e));this.itemsById={...this.itemsById,[t.id]:{...t,teams:s}}},getWithTeam(e){return this.getAll().filter((({teams:t})=>t.find((({slug:t})=>t===e))))},getAll(){return Object.values(this.itemsById).sort(((e,t)=>e.slug>t.slug?1:e.slug<t.slug?-1:0))},getById(e){return this.getAll().find((t=>t.id===e))},getBySlug(e){return this.getAll().find((t=>t.slug===e))},getBySlugs(e){return this.getAll().filter((t=>e.includes(t.slug)))},getState(e){return{projects:e?this.getBySlugs(e):this.getAll(),loading:this.loading}}},d=o().createStore(n)},"./app/stores/teamStore.tsx":(e,t,s)=>{s.d(t,{Z:()=>n}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var i=s("../node_modules/reflux/src/index.js"),o=s.n(i),r=s("./app/actions/teamActions.tsx");const a={initialized:!1,state:{teams:[],loading:!0,hasMore:null},init(){this.reset(),this.listenTo(r.Z.createTeamSuccess,this.onCreateSuccess),this.listenTo(r.Z.fetchDetailsSuccess,this.onUpdateSuccess),this.listenTo(r.Z.loadTeams,this.loadInitialData),this.listenTo(r.Z.removeTeamSuccess,this.onRemoveSuccess),this.listenTo(r.Z.updateSuccess,this.onUpdateSuccess)},reset(){this.state={teams:[],loading:!0,hasMore:null}},loadInitialData(e,t=null){this.initialized=!0,this.state={teams:e.sort(((e,t)=>e.slug.localeCompare(t.slug))),loading:!1,hasMore:t},this.trigger(new Set(e.map((e=>e.id))))},onUpdateSuccess(e,t){if(!t)return;if(!this.getBySlug(e))return this.state={...this.state,teams:[...this.state.teams,t]},void this.trigger(new Set([e]));if(t.slug!==e){const s=[...this.state.teams.filter((({slug:t})=>t!==e)),t];return this.state={...this.state,teams:s},void this.trigger(new Set([t.slug]))}const s=[...this.state.teams],i=s.findIndex((e=>e.slug===t.slug));s[i]=t,this.state={...this.state,teams:s},this.trigger(new Set([e]))},onRemoveSuccess(e){const{teams:t}=this.state;this.loadInitialData(t.filter((t=>t.slug!==e)))},onCreateSuccess(e){this.loadInitialData([...this.state.teams,e])},get(){return this.state},getById(e){const{teams:t}=this.state;return t.find((t=>t.id.toString()===e.toString()))||null},getBySlug(e){const{teams:t}=this.state;return t.find((t=>t.slug===e))||null},getAll(){return this.state.teams}},n=o().createStore(a)},"./app/utils/useApi.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var i=s("../node_modules/react/index.js"),o=s("./app/api.tsx");const r=function({persistInFlight:e,api:t}={}){const s=(0,i.useRef)();void 0===s.current&&void 0===t&&(s.current=new o.KU);const r=null!=t?t:s.current;function a(){!e&&r.clear()}return(0,i.useEffect)((()=>a),[]),r}},"./app/utils/withApi.tsx":(e,t,s)=>{s.d(t,{Z:()=>a});var i=s("./app/utils/getDisplayName.tsx"),o=s("./app/utils/useApi.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=(e,t={})=>{const s=({api:s,...i})=>{const a=(0,o.Z)({api:s,...t});return(0,r.tZ)(e,{...i,api:a})};return s.displayName="withApi(".concat((0,i.Z)(e),")"),s}},"./app/utils/withProjects.tsx":(e,t,s)=>{s.d(t,{Z:()=>d});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),r=s("./app/stores/projectsStore.tsx"),a=s("./app/utils/getDisplayName.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const d=function(e){class t extends o.Component{constructor(...e){super(...e),(0,i.Z)(this,"state",r.Z.getState()),(0,i.Z)(this,"unsubscribe",r.Z.listen((()=>this.setState(r.Z.getState())),void 0))}componentWillUnmount(){this.unsubscribe()}render(){return(0,n.tZ)(e,{...this.props,projects:this.state.projects,loadingProjects:this.state.loading})}}return t.displayName="WithProjects",(0,i.Z)(t,"displayName","withProjects(".concat((0,a.Z)(e),")")),t}},"./app/views/dashboardsV2/types.tsx":(e,t,s)=>{let i,o;s.d(t,{F:()=>i,n:()=>o}),function(e){e.AREA="area",e.BAR="bar",e.LINE="line",e.TABLE="table",e.WORLD_MAP="world_map",e.BIG_NUMBER="big_number",e.STACKED_AREA="stacked_area"}(i||(i={})),function(e){e.VIEW="view",e.EDIT="edit",e.CREATE="create",e.PENDING_DELETE="pending_delete"}(o||(o={}))},"./app/views/dashboardsV2/utils.tsx":(e,t,s)=>{s.d(t,{qk:()=>c,tT:()=>u,y1:()=>h}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var i=s("../node_modules/lodash/cloneDeep.js"),o=s.n(i),r=s("../node_modules/lodash/pick.js"),a=s.n(r),n=s("./app/utils/dates.tsx"),d=s("./app/utils/discover/eventView.tsx"),l=s("./app/views/dashboardsV2/types.tsx");function c(e){return o()(e)}function u(e,t,s,i){const{start:o,end:r,period:a}=s.datetime,{projects:c,environments:u}=s,m=i===l.F.WORLD_MAP?["geo.country_code",...t.fields]:t.fields,h=i===l.F.WORLD_MAP?"".concat(t.conditions," has:geo.country_code"):t.conditions;return d.ZP.fromSavedQuery({id:void 0,name:e,version:2,fields:m,query:h,orderby:t.orderby,projects:c,range:a,start:o?(0,n.v5)(o):void 0,end:r?(0,n.v5)(r):void 0,environment:u})}function m(e){return"string"==typeof e?[e]:e}function h(e){if(e){const t=m(e.queryNames),s=m(e.queryConditions),i=m(e.queryFields),o=[];if(s&&t&&i&&"string"==typeof e.queryOrderby&&s.forEach(((s,r)=>{o.push({name:t[r],conditions:s,fields:i,orderby:e.queryOrderby})})),e.title&&e.displayType&&e.interval&&o.length>0)return{...a()(e,["title","displayType","interval"]),queries:o}}}}}]);
//# sourceMappingURL=../sourcemaps/app_components_modals_dashboardWidgetQuerySelectorModal_tsx-app_stores_teamStore_tsx-app_util-498cf4.c3d16f60be9ccc669ab56b4b836b6378.js.map