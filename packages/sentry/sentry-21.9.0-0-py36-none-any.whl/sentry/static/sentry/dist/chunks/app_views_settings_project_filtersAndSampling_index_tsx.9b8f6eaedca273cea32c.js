(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_project_filtersAndSampling_index_tsx"],{"./app/components/switchButton.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=n("../node_modules/react/index.js"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const r=({forwardRef:e,size:t="sm",isActive:n,forceActiveColor:s,isLoading:o,isDisabled:r,toggle:a,id:l,name:d,className:c})=>(0,i.tZ)(u,{ref:e,id:l,name:d,type:"button",className:c,onClick:r?void 0:a,role:"checkbox","aria-checked":n,isLoading:o,isDisabled:r,isActive:n,size:t,"data-test-id":"switch",children:(0,i.tZ)(p,{isDisabled:r,isActive:n,forceActiveColor:s,size:t})});r.displayName="Switch";const a=e=>"sm"===e.size?16:24,l=e=>a(e)-("sm"===e.size?6:10),d=e=>"sm"===e.size?2:4,c=e=>e.isActive?d(e)+a(e):d(e),u=(0,s.Z)("button",{target:"ep74ita1"})("display:inline-block;background:none;padding:0;border:1px solid ",(e=>e.theme.border),";position:relative;box-shadow:inset 0 1px 1px rgba(0, 0, 0, 0.04);transition:0.15s border ease;cursor:",(e=>e.isLoading||e.isDisabled?"not-allowed":"pointer"),";pointer-events:",(e=>e.isLoading||e.isDisabled?"none":null),";height:",a,"px;width:",(e=>2*a(e)),"px;border-radius:",a,"px;&:hover,&:focus{outline:none;border-color:",(e=>e.theme.border),";}&:focus,&.focus-visible{outline:none;box-shadow:rgba(209, 202, 216, 0.5) 0 0 0 3px;}"),p=(0,s.Z)("span",{target:"ep74ita0"})("display:block;position:absolute;border-radius:50%;transition:0.25s all ease;top:",d,"px;transform:translateX(",c,"px);width:",l,"px;height:",l,"px;background:",(e=>e.isActive||e.forceActiveColor?e.theme.active:e.theme.border),";opacity:",(e=>e.isDisabled?.4:null),";"),m=o.forwardRef(((e,t)=>(0,i.tZ)(r,{...e,forwardRef:t})))},"./app/views/asyncView.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>a}),n("../node_modules/react/index.js");var s=n("../node_modules/react-document-title/index.js"),o=n.n(s),i=n("./app/components/asyncComponent.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class a extends i.Z{getTitle(){return""}render(){const e=this.getTitle();return(0,r.tZ)(o(),{title:"".concat(e?"".concat(e," - "):"","Sentry"),children:this.renderComponent()})}}a.displayName="AsyncView"},"./app/views/settings/components/forms/controls/textarea.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=n("../node_modules/react/index.js"),i=n("../node_modules/react-autosize-textarea/lib/index.js"),r=n("../node_modules/@emotion/is-prop-valid/dist/is-prop-valid.browser.esm.js"),a=n("./app/styles/input.tsx"),l=n("./app/styles/space.tsx"),d=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const c=o.forwardRef((function({autosize:e,rows:t,maxRows:n,...s},o){return e?(0,d.tZ)(i.Z,{...s,async:!0,ref:o,rows:t||2,maxRows:n}):(0,d.tZ)("textarea",{ref:o,...s})}));c.displayName="TextAreaControl";const u=(0,s.Z)(c,{shouldForwardProp:e=>["autosize","rows","maxRows"].includes(e)||(0,r.Z)(e),target:"elxy32p0"})(a.T,";min-height:40px;padding:calc(",(0,l.Z)(1)," - 1px) ",(0,l.Z)(1),";line-height:1.5em;",(e=>e.autosize&&"\n      height: auto;\n      padding: calc(".concat((0,l.Z)(1)," - 2px) ").concat((0,l.Z)(1),";\n      line-height: 1.6em;\n    ")),";")},"./app/views/settings/components/forms/numberField.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n("./app/views/settings/components/forms/inputField.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){return(0,o.tZ)(s.Z,{...e,type:"number"})}i.displayName="NumberField"},"./app/views/settings/components/forms/textareaField.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>l}),n("../node_modules/react/index.js");var s=n("../node_modules/lodash/omit.js"),o=n.n(s),i=n("./app/views/settings/components/forms/controls/textarea.tsx"),r=n("./app/views/settings/components/forms/inputField.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l({monospace:e,rows:t,autosize:n,...s}){return(0,a.tZ)(r.Z,{...s,field:s=>(0,a.tZ)(i.Z,{monospace:e,rows:t,autosize:n,...o()(s,["onKeyDown","children"])})})}l.displayName="TextareaField"},"./app/views/settings/organization/permissionAlert.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>d}),n("../node_modules/react/index.js");var s=n("./app/components/acl/access.tsx"),o=n("./app/components/alert.tsx"),i=n("./app/icons/index.tsx"),r=n("./app/locale.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=({access:e=["org:write"],...t})=>(0,a.tZ)(s.Z,{access:e,children:({hasAccess:e})=>!e&&(0,a.tZ)(o.Z,{type:"warning",icon:(0,a.tZ)(i.FC,{size:"sm"}),...t,children:(0,r.t)("These settings can only be edited by users with the organization owner or manager role.")})});l.displayName="PermissionAlert";const d=l},"./app/views/settings/project/filtersAndSampling/index.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Xt});var s=n("./app/components/acl/access.tsx"),o=n("./app/components/acl/feature.tsx"),i=n("./app/components/acl/featureDisabled.tsx"),r=n("./app/components/panels/index.tsx"),a=n("./app/locale.tsx"),l=n("./app/utils/withOrganization.tsx"),d=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),u=n("../node_modules/lodash/partition.js"),p=n.n(u),m=n("./app/actionCreators/indicator.tsx"),h=n("./app/actionCreators/modal.tsx"),g=n("./app/components/alert.tsx"),E=n("./app/components/links/externalLink.tsx");let R,_,y,S,x;!function(e){e.TRACE="trace",e.TRANSACTION="transaction",e.ERROR="error"}(R||(R={})),function(e){e.NOT="not",e.OR="or",e.AND="and"}(_||(_={})),function(e){e.GLOB_MATCH="glob",e.EQUAL="eq",e.CUSTOM="custom"}(y||(y={})),function(e){e.TRACE_RELEASE="trace.release",e.TRACE_ENVIRONMENT="trace.environment",e.TRACE_USER_ID="trace.user.id",e.TRACE_USER_SEGMENT="trace.user.segment",e.TRACE_TRANSACTION="trace.transaction",e.EVENT_RELEASE="event.release",e.EVENT_ENVIRONMENT="event.environment",e.EVENT_USER_ID="event.user.id",e.EVENT_USER_SEGMENT="event.user.segment",e.EVENT_LOCALHOST="event.is_local_ip",e.EVENT_WEB_CRAWLERS="event.web_crawlers",e.EVENT_BROWSER_EXTENSIONS="event.has_bad_browser_extensions",e.EVENT_TRANSACTION="event.transaction",e.EVENT_IP_ADDRESSES="event.client_ip",e.EVENT_LEGACY_BROWSER="event.legacy_browser",e.EVENT_ERROR_MESSAGES="event.error_messages",e.EVENT_CSP="event.csp"}(S||(S={})),function(e){e.IE_PRE_9="ie_pre_9",e.IE9="ie9",e.IE10="ie10",e.IE11="ie11",e.SAFARI_PRE_6="safari_pre_6",e.OPERA_PRE_15="opera_pre_15",e.OPERA_MINI_PRE_8="opera_mini_pre_8",e.ANDROID_PRE_4="android_pre_4"}(x||(x={}));var b=n("./app/utils/withProject.tsx"),Z=n("./app/views/asyncView.tsx"),f=n("./app/views/settings/components/settingsPageHeader.tsx"),T=n("./app/views/settings/components/text/textBlock.tsx"),v=n("./app/views/settings/organization/permissionAlert.tsx"),A=(n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js")),w=n("./app/utils/theme.tsx"),N=n("../node_modules/@sentry/minimal/esm/index.js");const C="https://docs.sentry.io/product/data-management-settings/filtering/",I={[x.IE_PRE_9]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer version 8 and lower")},[x.IE9]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer version 9")},[x.IE10]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer version 10")},[x.IE11]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer version 11")},[x.SAFARI_PRE_6]:{icon:"safari",title:(0,a.t)("Safari version 5 and lower")},[x.OPERA_PRE_15]:{icon:"opera",title:(0,a.t)("Opera version 14 and lower")},[x.OPERA_MINI_PRE_8]:{icon:"opera",title:(0,a.t)("Opera Mini version 8 and lower")},[x.ANDROID_PRE_4]:{icon:"android",title:(0,a.t)("Android version 3 and lower")}};function O(e){switch(e){case S.TRACE_ENVIRONMENT:case S.EVENT_ENVIRONMENT:return(0,a.t)("Environment");case S.TRACE_RELEASE:case S.EVENT_RELEASE:return(0,a.t)("Release");case S.EVENT_USER_ID:case S.TRACE_USER_ID:return(0,a.t)("User Id");case S.EVENT_USER_SEGMENT:case S.TRACE_USER_SEGMENT:return(0,a.t)("User Segment");case S.EVENT_BROWSER_EXTENSIONS:return(0,a.t)("Browser Extensions");case S.EVENT_LOCALHOST:return(0,a.t)("Localhost");case S.EVENT_WEB_CRAWLERS:return(0,a.t)("Web Crawlers");case S.EVENT_LEGACY_BROWSER:return(0,a.t)("Legacy Browsers");case S.EVENT_TRANSACTION:case S.TRACE_TRANSACTION:return(0,a.t)("Transactions");case S.EVENT_ERROR_MESSAGES:return(0,a.t)("Error Messages");case S.EVENT_CSP:return(0,a.t)("Content Security Policy");case S.EVENT_IP_ADDRESSES:return(0,a.t)("IP Addresses");default:return N.Tb(new Error("Unknown dynamic sampling condition inner name")),null}}const j=(0,A.iv)("[role='document']{overflow:initial;}@media (min-width: ",w.ZP.breakpoints[0],"){width:100%;max-width:700px;}","");let D;function k(e){switch(e){case S.EVENT_LEGACY_BROWSER:return(0,a.t)("Match all selected legacy browsers below");case S.EVENT_BROWSER_EXTENSIONS:return(0,a.t)("Match all browser extensions");case S.EVENT_LOCALHOST:return(0,a.t)("Match all localhosts");case S.EVENT_WEB_CRAWLERS:return(0,a.t)("Match all web crawlers");case S.EVENT_USER_ID:case S.TRACE_USER_ID:return(0,a.t)("ex. 4711 (Multiline)");case S.EVENT_USER_SEGMENT:case S.TRACE_USER_SEGMENT:return(0,a.t)("ex. paid, common (Multiline)");case S.TRACE_ENVIRONMENT:case S.EVENT_ENVIRONMENT:return(0,a.t)("ex. prod or dev (Multiline)");case S.TRACE_RELEASE:case S.EVENT_RELEASE:return(0,a.t)("ex. 1* or [I3].[0-9].* (Multiline)");case S.EVENT_IP_ADDRESSES:return(0,a.t)("ex. 127.0.0.1 or 10.0.0.0/8 (Multiline)");case S.EVENT_CSP:return(0,a.t)("ex. file://* or example.com (Multiline)");case S.EVENT_ERROR_MESSAGES:return(0,a.t)("ex. TypeError* (Multiline)");case S.TRACE_TRANSACTION:case S.EVENT_TRANSACTION:return(0,a.t)('ex. "page-load" (Multiline)');default:return""}}function V(e){var t,n;if(e.category===S.EVENT_BROWSER_EXTENSIONS||e.category===S.EVENT_WEB_CRAWLERS||e.category===S.EVENT_LOCALHOST)return{op:y.EQUAL,name:e.category,value:!0};if(e.category===S.EVENT_LEGACY_BROWSER)return{op:y.CUSTOM,name:e.category,value:null!==(n=e.legacyBrowsers)&&void 0!==n?n:[]};const s=(null!==(t=e.match)&&void 0!==t?t:"").split("\n").filter((e=>!!e.trim())).map((e=>e.trim()));return e.category===S.EVENT_IP_ADDRESSES||e.category===S.EVENT_ERROR_MESSAGES||e.category===S.EVENT_CSP?{op:y.CUSTOM,name:e.category,value:s}:e.category===S.EVENT_RELEASE||e.category===S.TRACE_RELEASE||e.category===S.EVENT_TRANSACTION||e.category===S.TRACE_TRANSACTION?{op:y.GLOB_MATCH,name:e.category,value:s}:e.category===S.TRACE_USER_ID||e.category===S.EVENT_USER_ID?{op:y.EQUAL,name:e.category,value:s,options:{ignoreCase:!1}}:{op:y.EQUAL,name:e.category,value:s,options:{ignoreCase:!0}}}!function(e){e.ALL="all",e.MATCH_CONDITIONS="match-conditions"}(D||(D={}));var M=n("../node_modules/lodash/isEqual.js"),B=n.n(M),L=n("./app/utils.tsx"),P=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),U=n("./app/components/button.tsx"),z=n("./app/components/buttonBar.tsx"),W=n("./app/components/dropdownAutoComplete/index.tsx"),X=n("./app/components/dropdownButton.tsx"),F=n("./app/components/menuItem.tsx"),G=n("./app/components/tooltip.tsx"),H=n("./app/icons/iconCheckmark.tsx"),Y=n("./app/styles/space.tsx"),q=n("./app/views/settings/components/emptyMessage.tsx"),K=n("./app/views/settings/components/forms/numberField.tsx"),Q=n("./app/icons/iconDelete.tsx"),J=n("./app/views/settings/components/forms/textareaField.tsx"),$=n("../node_modules/lodash/intersection.js"),ee=n.n($),te=n("../node_modules/lodash/uniq.js"),ne=n.n(te),se=n("../node_modules/lodash/xor.js"),oe=n.n(se),ie=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function re({selectedRowsCount:e,columnsCount:t,isPageSelected:n,isAllSelected:s,onSelectAllRows:o,onUnselectAllRows:i,bulkLimit:r,allRowsCount:l,className:d}){if(l&&l<=e||!n)return null;const{noticeText:u,actionText:p}=function(e,t){return(0,L.ri)(e)?t&&e>t?{noticeText:(0,a._N)("Selected up to the first [count] items.",{count:t}),actionText:(0,a._N)("Select the first [count] items.",{count:t})}:{noticeText:(0,a._N)("Selected all [count] items.",{count:e}),actionText:(0,a._N)("Select all [count] items.",{count:e})}:{noticeText:(0,a.t)("Selected all items across all pages."),actionText:(0,a.t)("Select all items across all pages.")}}(l,r);return(0,ie.tZ)(ae,{columnsCount:t,className:d,children:s?(0,ie.BX)(c.Fragment,{children:[u," ",(0,ie.tZ)(le,{priority:"link",onClick:i,children:(0,a.t)("Cancel selection.")})]}):(0,ie.BX)(c.Fragment,{children:[(0,a.tn)("%s item on this page selected.","%s items on this page selected.",e)," ",(0,ie.tZ)(le,{priority:"link",onClick:o,children:p})]})})}re.displayName="BulkNotice";const ae=(0,P.Z)((({columnsCount:e,...t})=>(0,ie.tZ)(r.aU,{...t})),{target:"e1cwk49q1"})("grid-column:span ",(e=>e.columnsCount),";text-align:center;"),le=(0,P.Z)(U.ZP,{target:"e1cwk49q0"})("&,&:hover,&:active,&:focus{color:",(e=>e.theme.textColor),";border:none;border-radius:0;border-bottom:1px dotted ",(e=>e.theme.textColor),";padding-bottom:1px;font-size:15px;}"),de=re;class ce extends c.Component{constructor(...e){super(...e),(0,d.Z)(this,"state",this.getInitialState()),(0,d.Z)(this,"handleRowToggle",(e=>{this.setState((t=>({selectedIds:oe()(t.selectedIds,[e]),isAllSelected:!1})))})),(0,d.Z)(this,"handleAllRowsToggle",(e=>{const{pageIds:t}=this.props;this.setState({selectedIds:e?[...t]:[],isAllSelected:e})})),(0,d.Z)(this,"handlePageRowsToggle",(e=>{const{pageIds:t}=this.props;this.setState((n=>({selectedIds:e?ne()([...n.selectedIds,...t]):n.selectedIds.filter((e=>!t.includes(e))),isAllSelected:!1})))}))}getInitialState(){const{defaultSelectedIds:e,pageIds:t}=this.props;return{selectedIds:ee()(null!=e?e:[],t),isAllSelected:!1}}static getDerivedStateFromProps(e,t){return{...t,selectedIds:ee()(t.selectedIds,e.pageIds)}}componentDidUpdate(e,t){var n,s;B()(t,this.state)||null===(n=(s=this.props).onChange)||void 0===n||n.call(s,this.state)}render(){const{pageIds:e,children:t,columnsCount:n,allRowsCount:s,bulkLimit:o}=this.props,{selectedIds:i,isAllSelected:r}=this.state,a=e.length>0&&e.every((e=>i.includes(e)));return t({selectedIds:i,isAllSelected:r,isPageSelected:a,onRowToggle:this.handleRowToggle,onAllRowsToggle:this.handleAllRowsToggle,onPageRowsToggle:this.handlePageRowsToggle,renderBulkNotice:()=>(0,ie.tZ)(de,{allRowsCount:s,selectedRowsCount:i.length,onUnselectAllRows:()=>this.handleAllRowsToggle(!1),onSelectAllRows:()=>this.handleAllRowsToggle(!0),columnsCount:n,isPageSelected:a,isAllSelected:r,bulkLimit:o})})}}ce.displayName="BulkController";const ue=ce;var pe=n("./app/components/switchButton.tsx");const me=Object.values(x);function he({onChange:e,selectedLegacyBrowsers:t=[]}){return(0,ie.tZ)(ue,{pageIds:me,defaultSelectedIds:t,allRowsCount:me.length,onChange:function({selectedIds:t}){e(t)},columnsCount:0,children:({selectedIds:e,onRowToggle:t,onPageRowsToggle:n,isPageSelected:s})=>(0,ie.BX)(Ee,{children:[(0,a.t)("All browsers"),(0,ie.tZ)(pe.Z,{size:"lg",isActive:s,toggle:()=>{n(!s)}},"switch"),me.map((n=>{const{icon:s,title:o}=I[n];return(0,ie.BX)(c.Fragment,{children:[(0,ie.BX)(Re,{children:[(0,ie.tZ)(_e,{className:"icon-".concat(s),"data-test-id":"icon-".concat(s)}),o]}),(0,ie.tZ)(pe.Z,{size:"lg",isActive:e.includes(n),toggle:()=>t(n)})]},n)}))]})})}he.displayName="LegacyBrowsers";const ge=he,Ee=(0,P.Z)("div",{target:"evvj4pe2"})("grid-column:1/-1;display:grid;grid-template-columns:1fr max-content;grid-gap:",(0,Y.Z)(2),";font-size:",(e=>e.theme.fontSizeLarge),";color:",(e=>e.theme.gray400),";padding-top:",(0,Y.Z)(2),";padding-bottom:",(0,Y.Z)(1),";"),Re=(0,P.Z)("div",{target:"evvj4pe1"})("display:grid;grid-template-columns:max-content 1fr;grid-column-gap:",(0,Y.Z)(1),";color:",(e=>e.theme.gray500),";"),_e=(0,P.Z)("div",{target:"evvj4pe0"})({name:"1bjfr92",styles:"width:24px;height:24px;background-repeat:no-repeat;background-position:center;background-size:24px 24px;flex-shrink:0"});function ye({conditions:e,onDelete:t,onChange:n}){return(0,ie.tZ)(c.Fragment,{children:e.map((({category:e,match:s,legacyBrowsers:o},i)=>{const r=e===S.EVENT_LEGACY_BROWSER,l=e===S.EVENT_BROWSER_EXTENSIONS||e===S.EVENT_LOCALHOST||e===S.EVENT_WEB_CRAWLERS||r;return(0,ie.BX)(xe,{children:[(0,ie.tZ)(Ze,{children:O(e)}),(0,ie.tZ)(fe,{children:!l&&(0,ie.tZ)(ve,{name:"match",value:s,onChange:e=>n(i,"match",e),placeholder:k(e),inline:!1,rows:1,autosize:!0,hideControlState:!0,flexibleControlStateSize:!0,required:!0,stacked:!0})}),(0,ie.tZ)(Te,{children:(0,ie.tZ)(U.ZP,{onClick:()=>t(i),icon:(0,ie.tZ)(Q.F,{}),label:(0,a.t)("Delete Condition")})}),r&&(0,ie.tZ)(ge,{selectedLegacyBrowsers:o,onChange:e=>{n(i,"legacyBrowsers",e)}})]},i)}))})}ye.displayName="Conditions";const Se=ye,xe=(0,P.Z)("div",{target:"ep8w7uu5"})("display:grid;grid-template-columns:1fr max-content;align-items:flex-start;padding:",(0,Y.Z)(1)," ",(0,Y.Z)(2),";:not(:last-child){border-bottom:1px solid ",(e=>e.theme.gray100),";}@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:0.6fr 1fr max-content;}"),be=(0,P.Z)("div",{target:"ep8w7uu4"})({name:"38ghps",styles:"min-height:40px;display:inline-flex;align-items:center"}),Ze=(0,P.Z)(be,{target:"ep8w7uu3"})("padding-right:",(0,Y.Z)(2),";"),fe=(0,P.Z)(be,{target:"ep8w7uu2"})("padding-top:",(0,Y.Z)(1),";grid-column:1/-1;grid-row:2/2;",(e=>!e.children&&"display: none"),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-column:auto;grid-row:auto;padding-top:0;}"),Te=(0,P.Z)(be,{target:"ep8w7uu1"})("justify-content:flex-end;padding-left:",(0,Y.Z)(1),";"),ve=(0,P.Z)(J.Z,{target:"ep8w7uu0"})({name:"1fz47qv",styles:"padding-bottom:0;width:100%"});function Ae({Header:e,Body:t,Footer:n,closeModal:s,title:o,emptyMessage:i,conditionCategories:l,api:d,organization:u,project:p,onSubmitSuccess:h,onSubmit:g,onChange:E,extraFields:R,rule:_}){const[y,x]=(0,c.useState)(function(){if(_){const{condition:e,sampleRate:t}=_,{inner:n}=e;return{conditions:n.map((({name:e,value:t})=>Array.isArray(t)?t.every((e=>!!I[e]))?{category:e,legacyBrowsers:t}:{category:e,match:t.join("\n")}:{category:e})),sampleRate:100*t,errors:{}}}return{conditions:[],sampleRate:null,errors:{}}}());(0,c.useEffect)((()=>{y.errors.sampleRate&&x({...y,errors:{...y.errors,sampleRate:void 0}})}),[y.sampleRate]),(0,c.useEffect)((()=>{null==E||E(y)}),[y]);const{errors:b,conditions:Z,sampleRate:f}=y;async function T(e,t){try{const t=await d.requestPromise("/projects/".concat(u.slug,"/").concat(p.slug,"/"),{method:"PUT",data:{dynamicSampling:{rules:e}}});h(t,_?(0,a.t)("Successfully edited dynamic sampling rule"):(0,a.t)("Successfully added dynamic sampling rule")),s()}catch(e){!function(e){switch(e.type){case"sampleRate":x({...y,errors:{...b,sampleRate:e.message}});break;default:(0,m.Iw)(e.message)}}(function(e,t){var n,s,o;const i=null!==(n=null===(s=e.responseJSON)||void 0===s||null===(o=s.dynamicSampling)||void 0===o?void 0:o.rules[t])&&void 0!==n?n:{},[r,l]=Object.entries(i)[0];return"sampleRate"===r&&"Ensure this value is less than or equal to 1."===(Array.isArray(l)?l[0]:l)?{type:"sampleRate",message:(0,a.t)("Ensure this value is a floating number between 0 and 100")}:{type:"unknown",message:(0,a.t)("An internal error occurred while saving dynamic sampling rule")}}(e,t))}}const v=!(0,L.ri)(f)||!(null==Z||!Z.find((e=>{var t;return e.category===S.EVENT_LEGACY_BROWSER?!(null!==(t=e.legacyBrowsers)&&void 0!==t?t:[]).length:e.category!==S.EVENT_LOCALHOST&&e.category!==S.EVENT_BROWSER_EXTENSIONS&&e.category!==S.EVENT_WEB_CRAWLERS&&!e.match})));return(0,ie.BX)(c.Fragment,{children:[(0,ie.tZ)(e,{closeButton:!0,children:(0,ie.tZ)("h4",{children:o})}),(0,ie.tZ)(t,{children:(0,ie.BX)(Ne,{children:[R,(0,ie.BX)(Oe,{children:[(0,ie.BX)(Ie,{hasButtons:!0,children:[(0,a.t)("Conditions"),(0,ie.tZ)(W.Z,{onSelect:e=>{var t;t=e.value,x({...y,conditions:[...Z,{category:t,match:""}]})},alignMenu:"right",items:l.map((e=>{const t=Z.some((t=>t.category===e[0]));return{value:e[0],disabled:t,label:(0,ie.tZ)(G.Z,{title:(0,a.t)("This condition has already been added"),disabled:!t,children:(0,ie.tZ)(Ce,{disabled:t,children:e[1]})})}})),children:({isOpen:e})=>(0,ie.tZ)(X.Z,{isOpen:e,size:"small",children:(0,a.t)("Add Condition")})})]}),(0,ie.tZ)(r.N,{children:Z.length?(0,ie.tZ)(Se,{conditions:Z,onDelete:function(e){const t=[...Z];t.splice(e,1),x({...y,conditions:t})},onChange:function(e,t,n){const s=[...Z];s[e][t]=n,x({...y,conditions:s})}}):(0,ie.tZ)(q.Z,{icon:(0,ie.tZ)(H.D,{isCircled:!0,size:"xl"}),children:i})})]}),(0,ie.tZ)(K.Z,{label:"".concat((0,a.t)("Sampling Rate")," %"),name:"sampleRate",onChange:e=>{x({...y,sampleRate:e?Number(e):null})},placeholder:"%",value:f,inline:!1,hideControlState:!b.sampleRate,error:b.sampleRate,showHelpInTooltip:!0,stacked:!0,required:!0})]})}),(0,ie.tZ)(n,{children:(0,ie.BX)(z.ZP,{gap:1,children:[(0,ie.tZ)(U.ZP,{onClick:s,children:(0,a.t)("Cancel")}),(0,ie.tZ)(U.ZP,{priority:"primary",onClick:()=>g({conditions:Z,sampleRate:f,submitRules:T}),disabled:v,children:(0,a.t)("Save Rule")})]})})]})}Ae.displayName="RuleModal";const we=Ae,Ne=(0,P.Z)("div",{target:"e1mf53z03"})("display:grid;grid-gap:",(0,Y.Z)(2),";"),Ce=(0,P.Z)(F.Z,{target:"e1mf53z02"})("color:",(e=>e.theme.textColor),";font-size:",(e=>e.theme.fontSizeMedium),";font-weight:400;text-transform:none;span{padding:0;}"),Ie=(0,P.Z)(r.V9,{target:"e1mf53z01"})("padding-right:",(0,Y.Z)(2),";"),Oe=(0,P.Z)(r.s_,{target:"e1mf53z00"})({name:"1ykowef",styles:"margin-bottom:0"});function je({rule:e,errorRules:t,transactionRules:n,...s}){return(0,ie.tZ)(we,{...s,title:e?(0,a.t)("Edit Error Sampling Rule"):(0,a.t)("Add Error Sampling Rule"),emptyMessage:(0,a.t)("Apply sampling rate to all errors"),conditionCategories:[[S.EVENT_RELEASE,(0,a.t)("Releases")],[S.EVENT_ENVIRONMENT,(0,a.t)("Environments")],[S.EVENT_USER_ID,(0,a.t)("User Id")],[S.EVENT_USER_SEGMENT,(0,a.t)("User Segment")],[S.EVENT_BROWSER_EXTENSIONS,(0,a.t)("Browser Extensions")],[S.EVENT_LOCALHOST,(0,a.t)("Localhost")],[S.EVENT_LEGACY_BROWSER,(0,a.t)("Legacy Browsers")],[S.EVENT_WEB_CRAWLERS,(0,a.t)("Web Crawlers")],[S.EVENT_IP_ADDRESSES,(0,a.t)("IP Addresses")],[S.EVENT_CSP,(0,a.t)("Content Security Policy")],[S.EVENT_ERROR_MESSAGES,(0,a.t)("Error Messages")],[S.EVENT_TRANSACTION,(0,a.t)("Transactions")]],rule:e,onSubmit:function({sampleRate:s,conditions:o,submitRules:i}){if(!(0,L.ri)(s))return;const r={id:0,type:R.ERROR,condition:{op:_.AND,inner:o.length?o.map(V):[]},sampleRate:s/100},a=e?[...t.map((t=>B()(t,e)?r:t)),...n]:[...t,r,...n],l=a.findIndex((e=>e===r));i(a,l)}})}je.displayName="ErrorRuleModal";const De=je;var ke=n("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),Ve=n("./app/components/checkboxFancy/checkboxFancy.tsx"),Me=n("./app/views/settings/components/forms/field/index.tsx");function Be({rule:e,errorRules:t,transactionRules:n,theme:s,...o}){const[i,r]=(0,c.useState)(!0),[l,d]=(0,c.useState)(!1);return(0,ie.tZ)(we,{...o,title:e?(0,a.t)("Edit Transaction Sampling Rule"):(0,a.t)("Add Transaction Sampling Rule"),emptyMessage:(0,a.t)("Apply sampling rate to all transactions"),conditionCategories:i?[[S.TRACE_RELEASE,(0,a.t)("Releases")],[S.TRACE_ENVIRONMENT,(0,a.t)("Environments")],[S.TRACE_USER_ID,(0,a.t)("User Id")],[S.TRACE_USER_SEGMENT,(0,a.t)("User Segment")],[S.TRACE_TRANSACTION,(0,a.t)("Transactions")]]:[[S.EVENT_RELEASE,(0,a.t)("Releases")],[S.EVENT_ENVIRONMENT,(0,a.t)("Environments")],[S.EVENT_USER_ID,(0,a.t)("User Id")],[S.EVENT_USER_SEGMENT,(0,a.t)("User Segment")],[S.EVENT_BROWSER_EXTENSIONS,(0,a.t)("Browser Extensions")],[S.EVENT_LOCALHOST,(0,a.t)("Localhost")],[S.EVENT_LEGACY_BROWSER,(0,a.t)("Legacy Browsers")],[S.EVENT_WEB_CRAWLERS,(0,a.t)("Web Crawlers")],[S.EVENT_IP_ADDRESSES,(0,a.t)("IP Addresses")],[S.EVENT_CSP,(0,a.t)("Content Security Policy")],[S.EVENT_ERROR_MESSAGES,(0,a.t)("Error Messages")],[S.EVENT_TRANSACTION,(0,a.t)("Transactions")]],rule:e,onSubmit:function({sampleRate:s,conditions:o,submitRules:r}){if(!(0,L.ri)(s))return;const a={id:0,type:i?R.TRACE:R.TRANSACTION,condition:{op:_.AND,inner:o.length?o.map(V):[]},sampleRate:s/100},l=e?n.map((t=>B()(t,e)?a:t)):[...n,a],[d,c]=p()(l,(e=>e.type===R.TRACE)),u=[...t,...d,...c],m=u.findIndex((e=>e===a));r(u,m)},onChange:function({conditions:e}){d(!!e.length)},extraFields:(0,ie.tZ)(Me.Z,{label:(0,a.t)("Tracing"),inline:!1,flexibleControlStateSize:!0,stacked:!0,showHelpInTooltip:!0,children:(0,ie.tZ)(G.Z,{title:(0,a.t)("This field can only be edited if there are no match conditions"),disabled:!l,popperStyle:(0,A.iv)("@media (min-width: ",s.breakpoints[0],"){max-width:370px;}",""),children:(0,ie.BX)(Pe,{onClick:l?void 0:()=>r(!i),children:[(0,ie.tZ)(Ue,{isChecked:i,isDisabled:l}),(0,a._N)("Include all related transactions by trace ID. This can span across multiple projects. All related errors will remain. [link:Learn more about tracing].",{link:(0,ie.tZ)(E.Z,{href:C,onClick:e=>e.stopPropagation()})})]})})})})}Be.displayName="TransactionRuleModal";const Le=(0,ke.b)(Be),Pe=(0,P.Z)("div",{target:"ejbmws91"})("display:grid;grid-template-columns:max-content 1fr;grid-gap:",(0,Y.Z)(1),";cursor:",(e=>e.onClick?"pointer":"not-allowed"),";"),Ue=(0,P.Z)(Ve.Z,{target:"ejbmws90"})("margin-top:",(0,Y.Z)(.5),";");function ze({type:e,...t}){return"error"===e?(0,ie.tZ)(De,{...t}):(0,ie.tZ)(Le,{...t})}ze.displayName="Modal";const We=ze;var Xe=n("./app/styles/overflowEllipsis.tsx"),Fe=n("../node_modules/react-dom/index.js"),Ge=n("../node_modules/@dnd-kit/core/dist/core.esm.js"),He=n("../node_modules/@dnd-kit/sortable/dist/sortable.esm.js");function Ye({value:e,dragging:t,index:n,transform:s,listeners:o,sorting:i,transition:r,forwardRef:a,attributes:l,renderItem:d,wrapperStyle:c,innerWrapperStyle:u}){return(0,ie.tZ)(Je,{ref:a,style:{...c,transition:r,"--translate-x":s?"".concat(Math.round(s.x),"px"):void 0,"--translate-y":s?"".concat(Math.round(s.y),"px"):void 0,"--scale-x":null!=s&&s.scaleX?"".concat(s.scaleX):void 0,"--scale-y":null!=s&&s.scaleY?"".concat(s.scaleY):void 0},children:(0,ie.tZ)($e,{style:u,children:d({dragging:Boolean(t),sorting:Boolean(i),listeners:o,transform:s,transition:r,value:e,index:n,attributes:l})})})}Ye.displayName="Item";const qe=Ye,Ke="0 0 0 calc(1px / var(--scale-x, 1)) rgba(63, 63, 68, 0.05)",Qe="".concat(Ke,", ").concat("0 1px calc(3px / var(--scale-x, 1)) 0 rgba(34, 33, 81, 0.15)"),Je=(0,P.Z)("div",{target:"e1puudz31"})("transform:translate3d(var(--translate-x, 0), var(--translate-y, 0), 0) scaleX(var(--scale-x, 1)) scaleY(var(--scale-y, 1));transform-origin:0 0;touch-action:manipulation;--box-shadow:",Qe,";--box-shadow-picked-up:",Ke,",-1px 0 15px 0 rgba(34, 33, 81, 0.01),0px 15px 15px 0 rgba(34, 33, 81, 0.25);"),$e=(0,P.Z)("div",{target:"e1puudz30"})("background-color:",(e=>e.theme.background),";animation:pop 200ms cubic-bezier(0.18, 0.67, 0.6, 1.22);box-shadow:var(--box-shadow-picked-up);opacity:1;:focus{box-shadow:0 0px 4px 1px rgba(76, 159, 254, 1),",Qe,";}@keyframes pop{0%{transform:scale(1);box-shadow:var(--box-shadow);}100%{box-shadow:var(--box-shadow-picked-up);}}");function et({id:e,index:t,renderItem:n,disabled:s,wrapperStyle:o,innerWrapperStyle:i}){const{attributes:r,isSorting:a,isDragging:l,listeners:d,setNodeRef:c,overIndex:u,transform:p,transition:m}=(0,He.nB)({id:e,disabled:s});return(0,ie.tZ)(qe,{forwardRef:c,value:e,sorting:a,renderItem:n,index:t,transform:p,transition:m,listeners:d,attributes:r,wrapperStyle:o({id:e,index:t,isDragging:l,isSorting:a}),innerWrapperStyle:i({id:e,index:t,isDragging:l,isSorting:a,overIndex:u,isDragOverlay:!1})})}et.displayName="SortableItem";const tt=et;class nt extends c.Component{constructor(...e){super(...e),(0,d.Z)(this,"state",{}),(0,d.Z)(this,"handleChangeActive",(e=>{this.setState({activeId:e})}))}render(){const{activeId:e}=this.state,{items:t,onUpdateItems:n,renderItem:s,disabled:o,wrapperStyle:i,innerWrapperStyle:r}=this.props,a=t.indexOf.bind(t),l=e?a(e):-1;return(0,ie.BX)(Ge.LB,{onDragStart:({active:e})=>{e&&this.handleChangeActive(e.id)},onDragEnd:({over:e})=>{if(this.handleChangeActive(void 0),e){const s=a(e.id);l!==s&&n({activeIndex:l,overIndex:s,reorderedItems:(0,He.Rp)(t,l,s)})}},onDragCancel:()=>this.handleChangeActive(void 0),children:[(0,ie.tZ)(He.Fo,{items:t,strategy:He.qw,children:t.map(((e,t)=>(0,ie.tZ)(tt,{id:e,index:t,renderItem:s,disabled:o,wrapperStyle:i,innerWrapperStyle:r},e)))}),(0,Fe.createPortal)((0,ie.tZ)(Ge.y9,{children:e?(0,ie.tZ)(qe,{value:t[l],renderItem:s,wrapperStyle:i({id:t[l],index:l,isDragging:!0,isSorting:!1}),innerWrapperStyle:r({id:t[l],index:l,isSorting:null!==e,isDragging:!0,overIndex:-1,isDragOverlay:!0})}):null}),document.body)]})}}nt.displayName="DraggableList",(0,d.Z)(nt,"defaultProps",{disabled:!1,wrapperStyle:()=>({}),innerWrapperStyle:()=>({})});const st=nt;var ot=n("./app/icons/iconGrabbable.tsx");const it=e=>"\n> * {\n  :nth-child(-n + 5):nth-child(5n - 1) {\n    text-align: center;\n  }\n  @media (max-width: ".concat(e.breakpoints[0],") {\n    :nth-child(5n - 4),\n    :nth-child(5n - 3) {\n      display: none;\n    }\n  }\n}\ngrid-template-columns: 2fr 1.5fr 1fr;\n@media (min-width: ").concat(e.breakpoints[0],") {\n  grid-template-columns: 0.5fr 1.5fr 2fr 1.5fr 1fr;\n}\n@media (min-width: ").concat(e.breakpoints[2],") {\n  grid-template-columns: 0.5fr 2fr 2.5fr 2fr 1.5fr;\n}\n@media (min-width: ").concat(e.breakpoints[3],") {\n  grid-template-columns: 0.5fr 2fr 3fr 2fr 1fr;\n}\n");var rt=n("./app/components/actions/menuItemActionLink.tsx"),at=n("./app/components/confirm.tsx"),lt=n("./app/components/dropdownLink.tsx"),dt=n("./app/icons/index.tsx");const ct=(0,a.t)("Are you sure you wish to delete this dynamic sampling rule?"),ut=(0,a.t)("You do not have permission to delete dynamic sampling rules."),pt=(0,a.t)("You do not have permission to edit dynamic sampling rules.");function mt({disabled:e,onEditRule:t,onDeleteRule:n,onOpenMenuActions:s,isMenuActionsOpen:o}){return(0,ie.BX)(c.Fragment,{children:[(0,ie.BX)(gt,{gap:1,children:[(0,ie.tZ)(U.ZP,{label:(0,a.t)("Edit Rule"),size:"small",onClick:t,icon:(0,ie.tZ)(dt.yl,{}),disabled:e,title:e?pt:void 0}),(0,ie.tZ)(at.Z,{priority:"danger",message:ct,onConfirm:n,disabled:e,children:(0,ie.tZ)(U.ZP,{label:(0,a.t)("Delete Rule"),size:"small",icon:(0,ie.tZ)(dt.Fz,{}),title:e?ut:void 0})})]}),(0,ie.BX)(Et,{caret:!1,customTitle:(0,ie.tZ)(U.ZP,{label:(0,a.t)("Actions"),icon:(0,ie.tZ)(dt.YR,{size:"sm"}),size:"xsmall",onClick:s}),isOpen:o,anchorRight:!0,children:[(0,ie.tZ)(rt.Z,{shouldConfirm:!1,icon:(0,ie.tZ)(dt.Dj,{size:"xs"}),title:(0,a.t)("Edit"),onClick:e?e=>{null==e||e.stopPropagation()}:t,disabled:e,children:(0,ie.tZ)(G.Z,{disabled:!e,title:pt,containerDisplayMode:"block",children:(0,a.t)("Edit")})}),(0,ie.tZ)(rt.Z,{onAction:n,message:ct,icon:(0,ie.tZ)(dt.Dj,{size:"xs"}),title:(0,a.t)("Delete"),disabled:e,priority:"danger",shouldConfirm:!0,children:(0,ie.tZ)(G.Z,{disabled:!e,title:ut,containerDisplayMode:"block",children:(0,a.t)("Delete")})})]})]})}mt.displayName="Actions";const ht=mt,gt=(0,P.Z)(z.ZP,{target:"e1a3egcn1"})("justify-content:flex-end;flex:1;display:none;@media (min-width: ",(e=>e.theme.breakpoints[2]),"){display:grid;}"),Et=(0,P.Z)(lt.Z,{target:"e1a3egcn0"})("display:flex;align-items:center;transition:none;@media (min-width: ",(e=>e.theme.breakpoints[2]),"){display:none;}"),Rt=function({condition:e}){function t(e){var t,n;return Array.isArray(e)?(0,ie.tZ)(c.Fragment,{children:[...e].map(((t,n)=>{var s,o;return(0,ie.BX)(c.Fragment,{children:[(0,ie.tZ)(St,{children:null!==(s=null===(o=I[t])||void 0===o?void 0:o.title)&&void 0!==s?s:t}),n!==e.length-1&&(0,ie.tZ)(xt,{children:","})]},t)}))}):(0,ie.tZ)(St,{children:null!==(t=null===(n=I[String(e)])||void 0===n?void 0:n.title)&&void 0!==t?t:String(e)})}switch(e.op){case _.AND:{const{inner:n}=e;return n.length?(0,ie.tZ)(_t,{children:n.map((({value:e,name:n},s)=>(0,ie.BX)("div",{children:[(0,ie.tZ)(yt,{children:O(n)}),t(e)]},s)))}):(0,ie.tZ)(yt,{children:(0,a.t)("All")})}default:return N.Tb(new Error("Unknown dynamic sampling condition operator")),null}},_t=(0,P.Z)("div",{target:"e5dv9sd3"})("display:grid;grid-gap:",(0,Y.Z)(1.5),";"),yt=(0,P.Z)("span",{target:"e5dv9sd2"})("margin-right:",(0,Y.Z)(1),";"),St=(0,P.Z)("span",{target:"e5dv9sd1"})("word-break:break-all;white-space:pre-wrap;color:",(e=>e.theme.gray300),";"),xt=(0,P.Z)(St,{target:"e5dv9sd0"})("padding-right:",(0,Y.Z)(.5),";");function bt({sampleRate:e}){return(0,ie.tZ)(ft,{children:"".concat(100*e,"%")})}bt.displayName="SampleRate";const Zt=bt,ft=(0,P.Z)("div",{target:"e17oa8sb0"})({name:"1h3cbh4",styles:"white-space:pre-wrap;word-break:break-all"}),Tt=function({type:e}){switch(e){case R.ERROR:return(0,ie.tZ)(vt,{children:(0,a.t)("Errors only")});case R.TRANSACTION:return(0,ie.tZ)(At,{children:(0,a.t)("Individual transactions")});case R.TRACE:return(0,ie.tZ)(At,{children:(0,a.t)("Transaction traces")});default:return N.Tb(new Error("Unknown dynamic sampling rule type")),null}},vt=(0,P.Z)("div",{target:"enki2wy1"})("color:",(e=>e.theme.pink300),";white-space:pre-wrap;"),At=(0,P.Z)(vt,{target:"enki2wy0"})("color:",(e=>e.theme.linkColor),";");class wt extends c.Component{constructor(...e){super(...e),(0,d.Z)(this,"state",{isMenuActionsOpen:!1}),(0,d.Z)(this,"handleChangeMenuAction",(()=>{this.setState((e=>({isMenuActionsOpen:!e.isMenuActionsOpen})))}))}componentDidMount(){this.checkMenuActionsVisibility()}componentDidUpdate(){this.checkMenuActionsVisibility()}checkMenuActionsVisibility(){const{dragging:e,sorting:t}=this.props,{isMenuActionsOpen:n}=this.state;(e||t)&&n&&this.setState({isMenuActionsOpen:!1})}render(){const{rule:e,onEditRule:t,onDeleteRule:n,disabled:s,listeners:o,grabAttributes:i}=this.props,{type:r,condition:l,sampleRate:d}=e,{isMenuActionsOpen:c}=this.state;return(0,ie.BX)(Ct,{children:[(0,ie.tZ)(Ot,{children:(0,ie.tZ)(G.Z,{title:s?(0,a.t)("You do not have permission to reorder dynamic sampling rules."):void 0,children:(0,ie.tZ)(Dt,{...o,disabled:s,...i,children:(0,ie.tZ)(ot.L,{})})})}),(0,ie.tZ)(It,{children:(0,ie.tZ)(Tt,{type:r})}),(0,ie.tZ)(It,{children:(0,ie.tZ)(Rt,{condition:l})}),(0,ie.tZ)(jt,{children:(0,ie.tZ)(Zt,{sampleRate:d})}),(0,ie.tZ)(It,{children:(0,ie.tZ)(ht,{onEditRule:t,onDeleteRule:n,disabled:s,onOpenMenuActions:this.handleChangeMenuAction,isMenuActionsOpen:c})})]})}}wt.displayName="Rule";const Nt=wt,Ct=(0,P.Z)("div",{target:"el3sh2r4"})("display:grid;align-items:center;",(e=>it(e.theme)),">*{overflow:visible;:nth-child(5n){justify-content:flex-end;}}"),It=(0,P.Z)("div",{target:"el3sh2r3"})("display:flex;align-items:center;padding:",(0,Y.Z)(2),";cursor:default;"),Ot=(0,P.Z)(It,{target:"el3sh2r2"})({name:"m8x70k",styles:"cursor:inherit;[role='button']{cursor:grab;}"}),jt=(0,P.Z)(It,{target:"el3sh2r1"})({name:"1gtpzmm",styles:"text-align:center;justify-content:center"}),Dt=(0,P.Z)("div",{target:"el3sh2r0"})((e=>e.disabled&&"\n    color: ".concat(e.theme.disabled,";\n    cursor: not-allowed;\n  ")),";outline:none;");class kt extends c.PureComponent{constructor(...e){super(...e),(0,d.Z)(this,"state",{rules:[]}),(0,d.Z)(this,"handleUpdateRules",(({activeIndex:e,overIndex:t,reorderedItems:n})=>{const{rules:s}=this.state,o=n.map((e=>s.find((t=>String(t.id)===e)))).filter((e=>!!e)),i=s[e].type,r=s[t].type;i!==R.TRACE||r!==R.TRANSACTION?i!==R.TRANSACTION||r!==R.TRACE?this.setState({rules:o}):(0,m.Iw)((0,a.t)("Individual transactions rules cannot be above transaction traces rules")):(0,m.Iw)((0,a.t)("Transaction traces rules cannot be under individual transactions rules"))}))}componentDidMount(){this.getRules()}componentDidUpdate(e){B()(e.rules,this.props.rules)?B()(this.props.rules,this.state.rules)||this.handleUpdateRulesParent():this.getRules()}getRules(){this.setState({rules:this.props.rules})}handleUpdateRulesParent(){const{onUpdateRules:e}=this.props,{rules:t}=this.state;e(t)}render(){const{onEditRule:e,onDeleteRule:t,disabled:n,emptyMessage:s}=this.props,{rules:o}=this.state;return(0,ie.tZ)(Mt,{headers:["",(0,a.t)("Type"),(0,a.t)("Conditions"),(0,a.t)("Rate"),""],isEmpty:!o.length,emptyMessage:s,children:(0,ie.tZ)(st,{disabled:n,items:o.map((e=>String(e.id))),onUpdateItems:this.handleUpdateRules,wrapperStyle:({isDragging:e,isSorting:t,index:n})=>e?{cursor:"grabbing"}:t?{}:{transform:"none",transformOrigin:"0","--box-shadow":"none","--box-shadow-picked-up":"none",overflow:"visible",position:"relative",zIndex:o.length-n,cursor:"default"},renderItem:({value:s,listeners:i,attributes:r,dragging:a,sorting:l})=>{const d=o.find((e=>String(e.id)===s));return d?(0,ie.tZ)(Nt,{rule:d,onEditRule:e(d),onDeleteRule:t(d),disabled:n,listeners:i,grabAttributes:r,dragging:a,sorting:l}):null}})})}}kt.displayName="Rules";const Vt=kt,Mt=(0,P.Z)(r.KB,{target:"e15ewxcp0"})("overflow:visible;margin-bottom:0;border:none;border-bottom-right-radius:0;border-bottom-left-radius:0;",(e=>it(e.theme)),">*{",Xe.Z,";:not(:last-child){border-bottom:1px solid ",(e=>e.theme.border),";}:nth-child(n + 6){",(e=>e.isEmpty?"\n              display: block;\n              grid-column: 1/-1;\n            ":"\n              display: grid;\n              grid-column: 1/-1;\n              padding: 0;\n            "),";}}");function Bt({rules:e,onAddRule:t,onEditRule:n,onDeleteRule:s,disabled:o,onUpdateRules:i,isErrorPanel:l}){const d=l?(0,a.t)("error"):(0,a.t)("transaction");return(0,ie.BX)(r.s_,{children:[(0,ie.tZ)(Vt,{rules:e,onEditRule:n,onDeleteRule:s,disabled:o,onUpdateRules:i,emptyMessage:(0,a.t)("There are no %s rules to display",d)}),(0,ie.tZ)(Pt,{children:(0,ie.BX)(z.ZP,{gap:1,children:[(0,ie.tZ)(U.ZP,{href:C,external:!0,children:(0,a.t)("Read the docs")}),(0,ie.tZ)(U.ZP,{priority:"primary",onClick:t,disabled:o,title:o?(0,a.t)("You do not have permission to add dynamic sampling rules."):void 0,children:(0,a.t)("Add %s rule",d)})]})})]})}Bt.displayName="RulesPanel";const Lt=Bt,Pt=(0,P.Z)(r.jH,{target:"e1lsth6w0"})("padding:",(0,Y.Z)(1)," ",(0,Y.Z)(2),";display:flex;align-items:center;justify-content:flex-end;");class Ut extends Z.Z{constructor(...e){super(...e),(0,d.Z)(this,"successfullySubmitted",((e,t)=>{this.setState({projectDetails:e}),t&&(0,m.S9)(t)})),(0,d.Z)(this,"handleOpenRule",((e,t)=>()=>{const{organization:n,project:s}=this.props,{errorRules:o,transactionRules:i}=this.state;return(0,h.openModal)((r=>(0,ie.tZ)(We,{...r,type:e,api:this.api,organization:n,project:s,rule:t,errorRules:o,transactionRules:i,onSubmitSuccess:this.successfullySubmitted})),{modalCss:j})})),(0,d.Z)(this,"handleAddRule",(e=>()=>{"errorRules"!==e?this.handleOpenRule("transaction")():this.handleOpenRule("error")()})),(0,d.Z)(this,"handleEditRule",(e=>()=>{e.type!==R.ERROR?this.handleOpenRule("transaction",e)():this.handleOpenRule("error",e)()})),(0,d.Z)(this,"handleDeleteRule",(e=>()=>{const{errorRules:t,transactionRules:n}=this.state,s=[...e.type===R.ERROR?t.filter((t=>t.id!==e.id)):t,...e.type!==R.ERROR?n.filter((t=>t.id!==e.id)):n];this.submitRules(s,(0,a.t)("Successfully deleted dynamic sampling rule"),(0,a.t)("An error occurred while deleting dynamic sampling rule"))})),(0,d.Z)(this,"handleUpdateRules",(e=>{var t;if(!e.length)return;const{errorRules:n,transactionRules:s}=this.state;(null===(t=e[0])||void 0===t?void 0:t.type)!==R.ERROR?this.submitRules([...n,...e]):this.submitRules([...e,...s])}))}getTitle(){return(0,a.t)("Filters & Sampling")}getDefaultState(){return{...super.getDefaultState(),errorRules:[],transactionRules:[],projectDetails:null}}getEndpoints(){const{organization:e,project:t}=this.props;return[["projectDetails","/projects/".concat(e.slug,"/").concat(t.slug,"/")]]}componentDidMount(){this.getRules()}componentDidUpdate(e,t){t.projectDetails===this.state.projectDetails||this.getRules()}getRules(){var e;const{projectDetails:t}=this.state;if(!t)return;const{dynamicSampling:n}=t,s=null!==(e=null==n?void 0:n.rules)&&void 0!==e?e:[],[o,i]=p()(s,(e=>e.type===R.ERROR));this.setState({errorRules:o,transactionRules:i})}async submitRules(e,t,n){const{organization:s,project:o}=this.props;try{const n=await this.api.requestPromise("/projects/".concat(s.slug,"/").concat(o.slug,"/"),{method:"PUT",data:{dynamicSampling:{rules:e}}});this.successfullySubmitted(n,t)}catch(e){this.getRules(),n&&(0,m.Iw)(n)}}renderBody(){const{errorRules:e,transactionRules:t}=this.state,{hasAccess:n}=this.props,s=!n;return[...e,...t].some((e=>e.condition.op!==_.AND))?(0,ie.tZ)(g.Z,{type:"error",children:(0,a.t)("A condition operator has been found that is not yet supported.")}):(0,ie.BX)(c.Fragment,{children:[(0,ie.tZ)(f.Z,{title:this.getTitle()}),(0,ie.tZ)(v.Z,{}),(0,ie.tZ)(T.Z,{children:(0,a._N)("Manage the inbound data you want to store. To change the sampling rate or rate limits, [link:update your SDK configuration]. The rules added below will apply on top of your SDK configuration. Any new rule may take a few minutes to propagate.",{link:(0,ie.tZ)(E.Z,{href:C})})}),(0,ie.tZ)(Lt,{rules:e,disabled:s,onAddRule:this.handleAddRule("errorRules"),onEditRule:this.handleEditRule,onDeleteRule:this.handleDeleteRule,onUpdateRules:this.handleUpdateRules,isErrorPanel:!0}),(0,ie.tZ)(T.Z,{children:(0,a.t)("Rules for traces should precede rules for individual transactions.")}),(0,ie.tZ)(Lt,{rules:t,disabled:s,onAddRule:this.handleAddRule("transactionRules"),onEditRule:this.handleEditRule,onDeleteRule:this.handleDeleteRule,onUpdateRules:this.handleUpdateRules})]})}}const zt=(0,b.Z)(Ut),Wt=({organization:e,...t})=>(0,ie.tZ)(o.Z,{features:["filters-and-sampling"],organization:e,renderDisabled:()=>(0,ie.tZ)(i.Z,{alert:r.aU,features:e.features,featureName:(0,a.t)("Filters & Sampling")}),children:(0,ie.tZ)(s.Z,{organization:e,access:["project:write"],children:({hasAccess:n})=>(0,ie.tZ)(zt,{...t,hasAccess:n,organization:e})})});Wt.displayName="Index";const Xt=(0,l.Z)(Wt)},"../node_modules/lodash/_baseDifference.js":(e,t,n)=>{var s=n("../node_modules/lodash/_SetCache.js"),o=n("../node_modules/lodash/_arrayIncludes.js"),i=n("../node_modules/lodash/_arrayIncludesWith.js"),r=n("../node_modules/lodash/_arrayMap.js"),a=n("../node_modules/lodash/_baseUnary.js"),l=n("../node_modules/lodash/_cacheHas.js");e.exports=function(e,t,n,d){var c=-1,u=o,p=!0,m=e.length,h=[],g=t.length;if(!m)return h;n&&(t=r(t,a(n))),d?(u=i,p=!1):t.length>=200&&(u=l,p=!1,t=new s(t));e:for(;++c<m;){var E=e[c],R=null==n?E:n(E);if(E=d||0!==E?E:0,p&&R==R){for(var _=g;_--;)if(t[_]===R)continue e;h.push(E)}else u(t,R,d)||h.push(E)}return h}},"../node_modules/lodash/_baseIntersection.js":(e,t,n)=>{var s=n("../node_modules/lodash/_SetCache.js"),o=n("../node_modules/lodash/_arrayIncludes.js"),i=n("../node_modules/lodash/_arrayIncludesWith.js"),r=n("../node_modules/lodash/_arrayMap.js"),a=n("../node_modules/lodash/_baseUnary.js"),l=n("../node_modules/lodash/_cacheHas.js"),d=Math.min;e.exports=function(e,t,n){for(var c=n?i:o,u=e[0].length,p=e.length,m=p,h=Array(p),g=1/0,E=[];m--;){var R=e[m];m&&t&&(R=r(R,a(t))),g=d(R.length,g),h[m]=!n&&(t||u>=120&&R.length>=120)?new s(m&&R):void 0}R=e[0];var _=-1,y=h[0];e:for(;++_<u&&E.length<g;){var S=R[_],x=t?t(S):S;if(S=n||0!==S?S:0,!(y?l(y,x):c(E,x,n))){for(m=p;--m;){var b=h[m];if(!(b?l(b,x):c(e[m],x,n)))continue e}y&&y.push(x),E.push(S)}}return E}},"../node_modules/lodash/_baseXor.js":(e,t,n)=>{var s=n("../node_modules/lodash/_baseDifference.js"),o=n("../node_modules/lodash/_baseFlatten.js"),i=n("../node_modules/lodash/_baseUniq.js");e.exports=function(e,t,n){var r=e.length;if(r<2)return r?i(e[0]):[];for(var a=-1,l=Array(r);++a<r;)for(var d=e[a],c=-1;++c<r;)c!=a&&(l[a]=s(l[a]||d,e[c],t,n));return i(o(l,1),t,n)}},"../node_modules/lodash/_castArrayLikeObject.js":(e,t,n)=>{var s=n("../node_modules/lodash/isArrayLikeObject.js");e.exports=function(e){return s(e)?e:[]}},"../node_modules/lodash/intersection.js":(e,t,n)=>{var s=n("../node_modules/lodash/_arrayMap.js"),o=n("../node_modules/lodash/_baseIntersection.js"),i=n("../node_modules/lodash/_baseRest.js"),r=n("../node_modules/lodash/_castArrayLikeObject.js"),a=i((function(e){var t=s(e,r);return t.length&&t[0]===e[0]?o(t):[]}));e.exports=a},"../node_modules/lodash/xor.js":(e,t,n)=>{var s=n("../node_modules/lodash/_arrayFilter.js"),o=n("../node_modules/lodash/_baseRest.js"),i=n("../node_modules/lodash/_baseXor.js"),r=n("../node_modules/lodash/isArrayLikeObject.js"),a=o((function(e){return i(s(e,r))}));e.exports=a}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_filtersAndSampling_index_tsx.a94e59754b88806c04838f3d0c866784.js.map