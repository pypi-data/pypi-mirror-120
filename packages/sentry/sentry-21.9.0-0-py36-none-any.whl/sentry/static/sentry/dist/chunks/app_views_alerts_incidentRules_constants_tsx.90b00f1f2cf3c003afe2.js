"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_alerts_incidentRules_constants_tsx"],{"./app/views/alerts/incidentRules/constants.tsx":(t,e,n)=>{n.d(e,{Vr:()=>i,Ng:()=>o,hh:()=>u,P1:()=>c,yq:()=>l,nM:()=>p,Yp:()=>E,W7:()=>T,ep:()=>v,H9:()=>S,Q6:()=>A}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=n("./app/utils/performance/vitals/constants.tsx"),s=n("./app/views/alerts/incidentRules/types.tsx"),r=n("./app/views/alerts/utils/index.tsx");const i="count()",o="p95(transaction.duration)",u={[s.qz.ERRORS]:"event.type:error",[s.qz.TRANSACTIONS]:"event.type:transaction"},c={[s.Yh.ERROR_DEFAULT]:"(event.type:error OR event.type:default)",[s.Yh.ERROR]:"event.type:error",[s.Yh.DEFAULT]:"event.type:default",[s.Yh.TRANSACTION]:"event.type:transaction"},l={aggregations:["count","count_unique"],fields:["user"]},d=["avg","percentile","p50","p75","p95","p99","p100"],R=[...d,"failure_rate","apdex","count"];function p(t,e){return"custom"===t&&e===s.qz.ERRORS?l:{aggregations:"apdex"===t||"custom"===t?R:d,fields:["transaction.duration"],measurementKeys:Object.keys(a.r)}}Object.keys(a.r);const E={aggregations:R,fields:["transaction.duration"],measurementKeys:Object.keys(a.r)};function T(t){return{label:t,alertThreshold:"",actions:[]}}function v(){return{dataset:s.qz.ERRORS,eventTypes:[s.GM.ERROR],aggregate:i,query:"",timeWindow:1,triggers:[T("critical"),T("warning")],projects:[],environment:null,resolveThreshold:"",thresholdType:s.lT.ABOVE}}function S(t){var e;const n=(0,r.A4)(t.query),a=n?r.Ey[n.source]:r.Ey.error;return{...v(),...a,query:null!==(e=null==n?void 0:n.query)&&void 0!==e?e:t.query,aggregate:"transactions"===a.dataset?"p95(transaction.duration)":t.getYAxis(),environment:t.environment.length?t.environment[0]:null}}function A(t){const{eventTypes:e,...n}=t;return{...v(),eventTypes:[e],...n}}},"./app/views/alerts/incidentRules/presets.tsx":(t,e,n)=>{n.d(e,{g:()=>R,x:()=>E}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=n("./app/locale.tsx"),s=n("./app/utils/discover/types.tsx"),r=n("./app/utils/tokenizeSearch.tsx"),i=n("./app/views/alerts/utils/index.tsx"),o=n("./app/utils/discover/eventView.tsx"),u=n("./app/utils/discover/fields.tsx"),c=n("./app/views/alerts/incidentRules/types.tsx");function l(t){var e;const{orgSlug:n,projects:a,incident:s,stats:r,extraQueryParams:l}=t;if(!(a&&a.length&&s&&r))return"";const d="".concat(s.alertRule.timeWindow,"m"),{start:R,end:p}=(0,i.Eq)(r),E={id:void 0,name:s&&s.title||"",orderby:"-".concat((0,u.LY)(s.alertRule.aggregate)),yAxis:s.alertRule.aggregate,query:null!==(e=null==s?void 0:s.discoverQuery)&&void 0!==e?e:"",projects:a.filter((({slug:t})=>s.projects.includes(t))).map((({id:t})=>Number(t))),version:2,fields:s.alertRule.dataset===c.qz.ERRORS?["issue","count()","count_unique(user)"]:["transaction",s.alertRule.aggregate],start:R,end:p,...l},T=o.ZP.fromSavedQuery(E),{query:v,...S}=T.getResultsViewUrlTarget(n);return{query:{...v,interval:d},...S}}var d=n("./app/views/performance/transactionSummary/utils.tsx");const R=[{name:(0,a.t)("Error count"),match:/^count\(\)/,validDataset:[c.qz.ERRORS],default:"count()",makeCtaParams:E},{name:(0,a.t)("Users affected"),match:/^count_unique\(tags\[sentry:user\]\)/,validDataset:[c.qz.ERRORS],default:"count_unique(tags[sentry:user])",makeCtaParams:E},{name:(0,a.t)("Latency"),match:/^(p[0-9]{2,3}|percentile\(transaction\.duration,[^)]+\)|avg\([^)]+\))/,validDataset:[c.qz.TRANSACTIONS],default:"percentile(transaction.duration, 0.95)",makeCtaParams:t=>p({opts:t,tooltip:(0,a.t)("Latency by Transaction")})},{name:(0,a.t)("Apdex"),match:/^apdex\([0-9.]+\)/,validDataset:[c.qz.TRANSACTIONS],default:"apdex(300)",makeCtaParams:t=>p({opts:t,tooltip:(0,a.t)("Apdex by Transaction")})},{name:(0,a.t)("Transaction Count"),match:/^count\(\)/,validDataset:[c.qz.TRANSACTIONS],default:"count()",makeCtaParams:t=>p({opts:t})},{name:(0,a.t)("Failure rate"),match:/^failure_rate\(\)/,validDataset:[c.qz.TRANSACTIONS],default:"failure_rate()",makeCtaParams:function({orgSlug:t,incident:e,projects:n,stats:i}){var o,u;if(!e||!i)return{to:"",buttonText:(0,a.t)("Incident details")};const c=null===(u=new r.MY(null!==(o=e.discoverQuery)&&void 0!==o?o:"").getFilterValues("transaction"))||void 0===u?void 0:u.find((t=>!t.includes("*")));return{to:l({orgSlug:t,projects:n,incident:e,stats:i,extraQueryParams:void 0!==c?{fields:["transaction.status","count()"],orderby:"-count",display:s.DC.TOP5}:{fields:["transaction","failure_rate()"],orderby:"-failure_rate",display:s.DC.TOP5}}),buttonText:(0,a.t)("Open in Discover"),title:void 0===c?(0,a.t)("Failure rate by transaction"):void 0}}}];function p(t){var e,n;const{opts:{orgSlug:o,projects:u,incident:c,stats:R},tooltip:p}=t;if(!c||!R)return{to:"",buttonText:(0,a.t)("Incident details")};const E=null===(n=new r.MY(null!==(e=c.discoverQuery)&&void 0!==e?e:"").getFilterValues("transaction"))||void 0===n?void 0:n.find((t=>!t.includes("*")));if(void 0!==E){const t=(0,i.Eq)(R);return{to:(0,d.e1)({orgSlug:o,transaction:E,projectID:u.filter((({slug:t})=>c.projects.includes(t))).map((({id:t})=>t)),query:{...t}}),buttonText:(0,a.t)("View Transaction Summary"),title:E}}const T={fields:[...new Set(["transaction","count()",c.alertRule.aggregate])],orderby:"-count",display:s.DC.TOP5};return{to:l({orgSlug:o,projects:u,incident:c,stats:R,extraQueryParams:T}),buttonText:(0,a.t)("Open in Discover"),title:p}}function E({orgSlug:t,projects:e,incident:n,stats:r}){if(!n)return{buttonText:(0,a.t)("Open in Discover"),to:""};const i={display:s.DC.TOP5};return{buttonText:(0,a.t)("Open in Discover"),to:l({orgSlug:t,projects:e,incident:n,stats:r,extraQueryParams:i})}}},"./app/views/alerts/incidentRules/types.tsx":(t,e,n)=>{n.d(e,{lT:()=>s,qz:()=>r,GM:()=>i,Yh:()=>o,XH:()=>u,Tb:()=>c,Us:()=>l,LO:()=>d,Lm:()=>R,hd:()=>p});var a=n("./app/locale.tsx");let s,r,i,o,u,c,l;!function(t){t[t.ABOVE=0]="ABOVE",t[t.BELOW=1]="BELOW"}(s||(s={})),function(t){t.ERRORS="events",t.TRANSACTIONS="transactions"}(r||(r={})),function(t){t.DEFAULT="default",t.ERROR="error",t.TRANSACTION="transaction"}(i||(i={})),function(t){t.ERROR_DEFAULT="error_default",t.DEFAULT="default",t.ERROR="error",t.TRANSACTION="transaction"}(o||(o={})),function(t){t.SIX_HOURS="6h",t.ONE_DAY="1d",t.THREE_DAYS="3d",t.SEVEN_DAYS="10000m",t.FOURTEEN_DAYS="14d",t.THIRTY_DAYS="30d"}(u||(u={})),function(t){t[t.ONE_MINUTE=1]="ONE_MINUTE",t[t.FIVE_MINUTES=5]="FIVE_MINUTES",t[t.TEN_MINUTES=10]="TEN_MINUTES",t[t.FIFTEEN_MINUTES=15]="FIFTEEN_MINUTES",t[t.THIRTY_MINUTES=30]="THIRTY_MINUTES",t[t.ONE_HOUR=60]="ONE_HOUR",t[t.TWO_HOURS=120]="TWO_HOURS",t[t.FOUR_HOURS=240]="FOUR_HOURS",t[t.ONE_DAY=1440]="ONE_DAY"}(c||(c={})),function(t){t.EMAIL="email",t.SLACK="slack",t.PAGERDUTY="pagerduty",t.MSTEAMS="msteams",t.SENTRY_APP="sentry_app"}(l||(l={}));const d={[l.EMAIL]:(0,a.t)("Email"),[l.SLACK]:(0,a.t)("Slack"),[l.PAGERDUTY]:(0,a.t)("Pagerduty"),[l.MSTEAMS]:(0,a.t)("MS Teams"),[l.SENTRY_APP]:(0,a.t)("Notification")};let R;!function(t){t.SPECIFIC="specific",t.USER="user",t.TEAM="team",t.SENTRY_APP="sentry_app"}(R||(R={}));const p={[R.USER]:(0,a.t)("Member"),[R.TEAM]:(0,a.t)("Team")}},"./app/views/alerts/types.tsx":(t,e,n)=>{let a,s,r,i;n.d(e,{lm:()=>a,vt:()=>s,Xn:()=>r,Gb:()=>i}),function(t){t[t.CREATED=0]="CREATED",t[t.DETECTED=1]="DETECTED",t[t.STATUS_CHANGE=2]="STATUS_CHANGE",t[t.COMMENT=3]="COMMENT",t[t.STARTED=4]="STARTED"}(a||(a={})),function(t){t[t.OPENED=1]="OPENED",t[t.CLOSED=2]="CLOSED",t[t.WARNING=10]="WARNING",t[t.CRITICAL=20]="CRITICAL"}(s||(s={})),function(t){t[t.MANUAL=1]="MANUAL",t[t.RULE_UPDATED=2]="RULE_UPDATED",t[t.RULE_TRIGGERED=3]="RULE_TRIGGERED"}(r||(r={})),function(t){t[t.PENDING=0]="PENDING",t[t.SNAPSHOT=4]="SNAPSHOT",t[t.DISABLED=5]="DISABLED"}(i||(i={}))},"./app/views/alerts/utils/index.tsx":(t,e,n)=>{n.d(e,{dX:()=>l,hl:()=>d,yN:()=>R,KL:()=>p,Mg:()=>E,Nf:()=>T,FJ:()=>v,Un:()=>S,Eq:()=>A,Gm:()=>O,CM:()=>m,Ey:()=>f,KC:()=>y,A4:()=>N}),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/es.string.replace.js");var a=n("./app/api.tsx"),s=n("./app/locale.tsx"),r=n("./app/utils/dates.tsx"),i=(n("./app/utils/discover/eventView.tsx"),n("./app/utils/discover/fields.tsx"),n("./app/views/alerts/incidentRules/presets.tsx")),o=n("./app/views/alerts/incidentRules/types.tsx"),u=n("./app/views/alerts/types.tsx");const c=new a.KU;function l(t,e){return c.requestPromise("/organizations/".concat(t,"/alert-rules/").concat(e,"/"))}function d(t,e,n,a){return c.requestPromise("/organizations/".concat(t,"/incidents/"),{query:{alertRule:e,includeSnapshots:!0,start:n,end:a,expand:["activities","seen_by","original_alert_rule"]}})}function R(t,e,n){return t.requestPromise("/organizations/".concat(e,"/incidents/").concat(n,"/"))}function p(t,e,n){return t.requestPromise("/organizations/".concat(e,"/incidents/").concat(n,"/stats/"))}function E(t,e,n,a){const s=a?"POST":"DELETE";return t.requestPromise("/organizations/".concat(e,"/incidents/").concat(n,"/subscriptions/"),{method:s})}function T(t,e,n,a){return t.requestPromise("/organizations/".concat(e,"/incidents/").concat(n,"/"),{method:"PUT",data:{status:a}})}function v(t){switch(t.status){case u.vt.CLOSED:return!1;default:return!0}}function S(t){var e,n;const a=null==t?void 0:t.alertRule,s=null!==(e=null==a?void 0:a.aggregate)&&void 0!==e?e:"",r=null!==(n=null==a?void 0:a.dataset)&&void 0!==n?n:o.qz.ERRORS;return i.g.find((t=>t.validDataset.includes(r)&&t.match.test(s)))}function A(t){return{start:(0,r.v5)(1e3*t.eventStats.data[0][0]),end:(0,r.v5)(1e3*t.eventStats.data[t.eventStats.data.length-1][0])}}function O(t){return!t.hasOwnProperty("triggers")}const m={[o.qz.ERRORS]:(0,s.t)("Errors"),[o.qz.TRANSACTIONS]:(0,s.t)("Transactions"),[o.Yh.ERROR_DEFAULT]:(0,s.t)("event.type:error OR event.type:default"),[o.Yh.ERROR]:(0,s.t)("event.type:error"),[o.Yh.DEFAULT]:(0,s.t)("event.type:default"),[o.Yh.TRANSACTION]:(0,s.t)("event.type:transaction")},f={[o.Yh.ERROR_DEFAULT]:{dataset:o.qz.ERRORS,eventTypes:[o.GM.ERROR,o.GM.DEFAULT]},[o.Yh.ERROR]:{dataset:o.qz.ERRORS,eventTypes:[o.GM.ERROR]},[o.Yh.DEFAULT]:{dataset:o.qz.ERRORS,eventTypes:[o.GM.DEFAULT]},[o.Yh.TRANSACTION]:{dataset:o.qz.TRANSACTIONS,eventTypes:[o.GM.TRANSACTION]}};function y(t,e){return t===o.qz.TRANSACTIONS?o.Yh.TRANSACTION:e?e.includes(o.GM.DEFAULT)&&e.includes(o.GM.ERROR)?o.Yh.ERROR_DEFAULT:e.includes(o.GM.DEFAULT)?o.Yh.DEFAULT:o.Yh.ERROR:o.Yh.ERROR}function N(t){let e=t.match(/\(?\bevent\.type:(error|default|transaction)\)?\WOR\W\(?event\.type:(error|default|transaction)\)?/i);return e?"default,error"!==e.slice(1,3).sort().join(",")?null:{source:o.Yh.ERROR_DEFAULT,query:t.replace(e[0],"").trim()}:(e=t.match(/(^|\s)event\.type:(error|default|transaction)/i),e&&o.Yh[e[2].toUpperCase()]?{source:o.Yh[e[2].toUpperCase()],query:t.replace(e[0],"").trim()}:null)}}}]);
//# sourceMappingURL=../sourcemaps/app_views_alerts_incidentRules_constants_tsx.19d166db5eaa64570553b9e0a7df12b5.js.map