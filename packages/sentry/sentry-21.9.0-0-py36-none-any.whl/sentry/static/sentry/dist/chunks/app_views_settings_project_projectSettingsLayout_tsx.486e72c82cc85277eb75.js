"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_project_projectSettingsLayout_tsx"],{"./app/components/projects/appStoreConnectContext/index.tsx":(t,e,o)=>{o.d(e,{zt:()=>c,ZP:()=>p}),o("../node_modules/core-js/modules/web.dom-collections.iterator.js");var s=o("../node_modules/react/index.js"),r=o("./app/utils/withApi.tsx"),n=o("./app/components/projects/appStoreConnectContext/utils.tsx"),i=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=(0,s.createContext)(void 0),c=(0,r.Z)((({api:t,children:e,project:o,organization:r})=>{var c;const[p,l]=(0,s.useState)(),[d,u]=(0,s.useState)(void 0),h=r.slug,m=!(null===(c=r.features)||void 0===c||!c.includes("app-store-connect"));return(0,s.useEffect)((()=>{!async function(){if(m&&o&&!p)if(o.symbolSources)l(o);else try{const e=await t.requestPromise("/projects/".concat(h,"/").concat(o.slug,"/"));l(e)}catch{}}()}),[o]),(0,s.useEffect)((()=>{!async function(){if(!p)return;const e=null===(s=((o=p.symbolSources)?JSON.parse(o):[]).find((t=>"appstoreconnect"===t.type.toLowerCase())))||void 0===s?void 0:s.id;var o,s;if(e)try{const o=await t.requestPromise("/projects/".concat(h,"/").concat(p.slug,"/appstoreconnect/validate/").concat(e,"/"));u({id:e,...o})}catch{}}()}),[p]),(0,i.tZ)(a.Provider,{value:d?{...d,updateAlertMessage:(0,n.t)(d)}:void 0,children:e})})),p=(a.Consumer,a)},"./app/components/projects/appStoreConnectContext/utils.tsx":(t,e,o)=>{o.d(e,{R:()=>r,t:()=>n});var s=o("./app/locale.tsx");const r={iTunesSessionInvalid:(0,s.t)("The iTunes session of your configured App Store Connect needs to be refreshed."),appStoreCredentialsInvalid:(0,s.t)("The credentials of your configured App Store Connect are invalid.")};function n(t){return t.promptItunesSession?r.iTunesSessionInvalid:!1===t.appstoreCredentialsValid?r.appStoreCredentialsInvalid:void 0}},"./app/views/settings/project/projectSettingsLayout.tsx":(t,e,o)=>{o.r(e),o.d(e,{default:()=>E});var s,r=o("../node_modules/react/index.js"),n=o("./app/components/projects/appStoreConnectContext/index.tsx"),i=o("./app/utils/withOrganization.tsx"),a=o("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=o("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),p=(o("../node_modules/core-js/modules/web.dom-collections.iterator.js"),o("../node_modules/react-document-title/index.js")),l=o.n(p),d=o("./app/actionCreators/members.tsx"),u=o("./app/actionCreators/projects.tsx"),h=o("./app/components/loadingError.tsx"),m=o("./app/components/loadingIndicator.tsx"),j=o("./app/components/projects/missingProjectMembership.tsx"),g=o("./app/locale.tsx"),f=o("./app/sentryTypes.tsx"),S=o("./app/stores/memberListStore.tsx"),x=o("./app/stores/projectsStore.tsx"),v=o("./app/styles/space.tsx"),y=o("./app/utils/withApi.tsx"),Z=o("./app/utils/withProjects.tsx"),C=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");!function(t){t.MISSING_MEMBERSHIP="MISSING_MEMBERSHIP",t.PROJECT_NOT_FOUND="PROJECT_NOT_FOUND",t.UNKNOWN="UNKNOWN"}(s||(s={}));class b extends r.Component{constructor(...t){super(...t),(0,a.Z)(this,"state",this.getInitialState()),(0,a.Z)(this,"docTitleRef",(0,r.createRef)()),(0,a.Z)(this,"unsubscribeProjects",x.Z.listen((t=>this.onProjectChange(t)),void 0)),(0,a.Z)(this,"unsubscribeMembers",S.Z.listen((t=>this.setState({memberList:t})),void 0))}getInitialState(){return{loading:!0,error:!1,errorType:null,memberList:[],project:null}}getChildContext(){return{project:this.state.project}}componentWillMount(){this.fetchData()}componentWillReceiveProps(t){t.projectId!==this.props.projectId&&(t.skipReload||this.remountComponent())}componentDidUpdate(t,e){if(t.projectId!==this.props.projectId&&this.fetchData(),t.projects.length!==this.props.projects.length&&this.fetchData(),e.project!==this.state.project){const t=this.docTitleRef.current;if(!t)return;t.forceUpdate()}}componentWillUnmount(){this.unsubscribeMembers(),this.unsubscribeProjects()}remountComponent(){this.setState(this.getInitialState())}getTitle(){var t,e;return null!==(t=null===(e=this.state.project)||void 0===e?void 0:e.slug)&&void 0!==t?t:"Sentry"}onProjectChange(t){this.state.project&&t.has(this.state.project.id)&&this.setState({project:{...x.Z.getById(this.state.project.id)}})}identifyProject(){const{projects:t,projectId:e}=this.props,o=e;return t.find((({slug:t})=>t===o))||null}async fetchData(){const{orgId:t,projectId:e,skipReload:o}=this.props,r=this.identifyProject(),n=r&&r.hasAccess;if(this.setState((t=>({loading:!o||t.loading,project:r}))),r&&n){(0,u.pK)(null);const o=this.props.api.requestPromise("/projects/".concat(t,"/").concat(e,"/"));try{const t=await o;this.setState({loading:!1,project:t,error:!1,errorType:null}),(0,u.pK)(t)}catch(t){this.setState({loading:!1,error:!1,errorType:s.UNKNOWN})}(0,d.MA)(this.props.api,t,[r.id])}else if(!r||r.isMember)try{await this.props.api.requestPromise("/projects/".concat(t,"/").concat(e,"/"))}catch(t){this.setState({loading:!1,error:!0,errorType:s.PROJECT_NOT_FOUND})}else this.setState({loading:!1,error:!0,errorType:s.MISSING_MEMBERSHIP})}renderBody(){const{error:t,errorType:e,loading:o,project:r}=this.state;if(o)return(0,C.tZ)("div",{className:"loading-full-layout",children:(0,C.tZ)(m.Z,{})});if(!t&&r){const{children:t}=this.props;return"function"==typeof t?t({project:r}):t}switch(e){case s.PROJECT_NOT_FOUND:return(0,C.tZ)("div",{className:"container",children:(0,C.tZ)("div",{className:"alert alert-block",style:{margin:"30px 0 10px"},children:(0,g.t)("The project you were looking for was not found.")})});case s.MISSING_MEMBERSHIP:return(0,C.tZ)(N,{children:(0,C.tZ)(j.Z,{organization:this.props.organization,projectSlug:null==r?void 0:r.slug})});default:return(0,C.tZ)(h.Z,{onRetry:this.remountComponent})}}render(){return(0,C.tZ)(l(),{ref:this.docTitleRef,title:this.getTitle(),children:this.renderBody()})}}b.displayName="ProjectContext",(0,a.Z)(b,"childContextTypes",{project:f.Z.Project});const I=(0,y.Z)((0,i.Z)((0,Z.Z)(b))),N=(0,c.Z)("div",{target:"e1ekcf660"})("width:100%;margin:",(0,v.Z)(2)," ",(0,v.Z)(4),";");var P=o("./app/views/settings/components/settingsLayout.tsx"),w=o("./app/utils/withProject.tsx"),T=o("./app/views/settings/components/settingsNavigation.tsx"),_=o("./app/views/settings/project/navigationConfiguration.tsx");const M=({organization:t,project:e})=>{const o=(0,r.useContext)(n.ZP),s=!(null==o||!o.updateAlertMessage);return(0,C.tZ)(T.Z,{navigationObjects:(0,_.Z)({project:e,organization:t,debugFilesNeedsReview:s}),access:new Set(t.access),features:new Set(t.features),organization:t,project:e})};M.displayName="ProjectSettingsNavigation";const O=(0,w.Z)(M);function R({params:t,organization:e,children:o,routes:s,...i}){const{orgId:a,projectId:c}=t;return(0,C.tZ)(I,{orgId:a,projectId:c,children:({project:a})=>(0,C.tZ)(n.zt,{project:a,organization:e,children:(0,C.tZ)(P.Z,{params:t,routes:s,...i,renderNavigation:()=>(0,C.tZ)(O,{organization:e}),children:o&&r.isValidElement(o)?r.cloneElement(o,{organization:e}):o})})})}R.displayName="ProjectSettingsLayout";const E=(0,i.Z)(R)}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_projectSettingsLayout_tsx.ab1ef2031504320249553bc136982290.js.map