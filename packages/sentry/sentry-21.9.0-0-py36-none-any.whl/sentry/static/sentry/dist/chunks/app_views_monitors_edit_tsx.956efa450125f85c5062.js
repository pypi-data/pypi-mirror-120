"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_monitors_edit_tsx"],{"./app/views/asyncView.tsx":(e,t,s)=>{s.d(t,{Z:()=>a}),s("../node_modules/react/index.js");var n=s("../node_modules/react-document-title/index.js"),o=s.n(n),i=s("./app/components/asyncComponent.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class a extends i.Z{getTitle(){return""}render(){const e=this.getTitle();return(0,r.tZ)(o(),{title:"".concat(e?"".concat(e," - "):"","Sentry"),children:this.renderComponent()})}}a.displayName="AsyncView"},"./app/views/monitors/edit.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("../node_modules/react-router/es/index.js"),r=s("./app/views/asyncView.tsx"),a=s("./app/views/monitors/monitorForm.tsx"),c=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class l extends r.Z{constructor(...e){super(...e),(0,n.Z)(this,"onUpdate",(e=>this.setState((t=>({monitor:{...t.monitor,...e}}))))),(0,n.Z)(this,"onSubmitSuccess",(e=>i.browserHistory.push("/organizations/".concat(this.props.params.orgId,"/monitors/").concat(e.id,"/"))))}getEndpoints(){const{params:e}=this.props;return[["monitor","/monitors/".concat(e.monitorId,"/")]]}getTitle(){return this.state.monitor?"".concat(this.state.monitor.name," - Monitors - ").concat(this.props.params.orgId):"Monitors - ".concat(this.props.params.orgId)}renderBody(){const{monitor:e}=this.state;return null===e?null:(0,c.BX)(o.Fragment,{children:[(0,c.tZ)("h1",{children:"Edit Monitor"}),(0,c.tZ)(a.Z,{monitor:e,apiMethod:"PUT",apiEndpoint:"/monitors/".concat(e.id,"/"),onSubmitSuccess:this.onSubmitSuccess})]})}}},"./app/views/monitors/monitorForm.tsx":(e,t,s)=>{s.d(t,{Z:()=>v});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("../node_modules/mobx-react-lite/es/index.js"),r=s("./app/components/acl/access.tsx"),a=s("./app/components/panels/index.tsx"),c=s("./app/locale.tsx"),l=s("./app/utils/withGlobalSelection.tsx"),d=s("./app/utils/withOrganization.tsx"),m=s("./app/views/settings/components/forms/field/index.tsx"),p=s("./app/views/settings/components/forms/form.tsx"),u=s("./app/views/settings/components/forms/numberField.tsx"),h=s("./app/views/settings/components/forms/selectField.tsx"),g=s("./app/views/settings/components/forms/textCopyInput.tsx"),f=s("./app/views/settings/components/forms/textField.tsx"),b=(s("../node_modules/core-js/modules/web.url.to-json.js"),s("./app/views/settings/components/forms/model.tsx"));class x extends b.Z{getTransformedData(){return this.fields.toJSON().reduce(((e,[t,s])=>0!==t.indexOf("config.")?(e[t]=s,e):(e.config||(e.config={}),"config.schedule.frequency"!==t&&"config.schedule.interval"!==t||Array.isArray(e.config.schedule)||(e.config.schedule=[null,null]),"config.schedule.frequency"===t?e.config.schedule[0]=parseInt(s,10):"config.schedule.interval"===t?e.config.schedule[1]=s:e.config[t.substr(7)]=s,e)),{})}getTransformedValue(e){return 0===e.indexOf("config")?this.getValue(e):super.getTransformedValue(e)}}var Z=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const w=[["crontab","Crontab"],["interval","Interval"]],j=[["cron_job","Cron Job"]],y=[["minute","minute(s)"],["hour","hour(s)"],["day","day(s)"],["week","week(s)"],["month","month(s)"],["year","year(s)"]];class _ extends o.Component{constructor(...e){super(...e),(0,n.Z)(this,"form",new x)}formDataFromConfig(e,t){const s={};switch(e){case"cron_job":switch(s["config.schedule_type"]=t.schedule_type,s["config.checkin_margin"]=t.checkin_margin,s["config.max_runtime"]=t.max_runtime,t.schedule_type){case"interval":s["config.schedule.frequency"]=t.schedule[0],s["config.schedule.interval"]=t.schedule[1];break;case"crontab":default:s["config.schedule"]=t.schedule}}return s}render(){const{monitor:e}=this.props,t=this.props.selection.projects[0],s=t?this.props.organization.projects.find((e=>e.id===t+"")):null;return(0,Z.tZ)(r.Z,{access:["project:write"],children:({hasAccess:t})=>(0,Z.BX)(p.Z,{allowUndo:!0,requireChanges:!0,apiEndpoint:this.props.apiEndpoint,apiMethod:this.props.apiMethod,model:this.form,initialData:e?{name:e.name,type:e.type,project:e.project.slug,...this.formDataFromConfig(e.type,e.config)}:{project:s?s.slug:null},onSubmitSuccess:this.props.onSubmitSuccess,children:[(0,Z.BX)(a.s_,{children:[(0,Z.tZ)(a.V9,{children:(0,c.t)("Details")}),(0,Z.BX)(a.N,{children:[e&&(0,Z.tZ)(m.Z,{label:(0,c.t)("ID"),children:(0,Z.tZ)("div",{className:"controls",children:(0,Z.tZ)(g.Z,{children:e.id})})}),(0,Z.tZ)(h.Z,{name:"project",label:(0,c.t)("Project"),disabled:!t,choices:this.props.organization.projects.filter((e=>e.isMember)).map((e=>[e.slug,e.slug])),required:!0}),(0,Z.tZ)(f.Z,{name:"name",placeholder:(0,c.t)("My Cron Job"),label:(0,c.t)("Name"),disabled:!t,required:!0})]})]}),(0,Z.BX)(a.s_,{children:[(0,Z.tZ)(a.V9,{children:(0,c.t)("Config")}),(0,Z.BX)(a.N,{children:[(0,Z.tZ)(h.Z,{name:"type",label:(0,c.t)("Type"),disabled:!t,choices:j,required:!0}),(0,Z.tZ)(i.Qj,{children:()=>{switch(this.form.getValue("type")){case"cron_job":return(0,Z.BX)(o.Fragment,{children:[(0,Z.tZ)(u.Z,{name:"config.max_runtime",label:(0,c.t)("Max Runtime"),disabled:!t,help:(0,c.t)("The maximum runtime (in minutes) a check-in is allowed before it's marked as a failure."),placeholder:"e.g. 30"}),(0,Z.tZ)(h.Z,{name:"config.schedule_type",label:(0,c.t)("Schedule Type"),disabled:!t,choices:w,required:!0})]});default:return null}}}),(0,Z.tZ)(i.Qj,{children:()=>{switch(this.form.getValue("config.schedule_type")){case"crontab":return(0,Z.BX)(o.Fragment,{children:[(0,Z.tZ)(f.Z,{name:"config.schedule",label:(0,c.t)("Schedule"),disabled:!t,placeholder:"*/5 * * * *",required:!0,help:(0,c._N)("Changes to the schedule will apply on the next check-in. See [link:Wikipedia] for crontab syntax.",{link:(0,Z.tZ)("a",{href:"https://en.wikipedia.org/wiki/Cron"})})}),(0,Z.tZ)(u.Z,{name:"config.checkin_margin",label:(0,c.t)("Check-in Margin"),disabled:!t,help:(0,c.t)("The margin (in minutes) a check-in is allowed to exceed it's scheduled window before being treated as missed."),placeholder:"e.g. 30"})]});case"interval":return(0,Z.BX)(o.Fragment,{children:[(0,Z.tZ)(u.Z,{name:"config.schedule.frequency",label:(0,c.t)("Frequency"),disabled:!t,placeholder:"e.g. 1",required:!0}),(0,Z.tZ)(h.Z,{name:"config.schedule.interval",label:(0,c.t)("Interval"),disabled:!t,choices:y,required:!0}),(0,Z.tZ)(u.Z,{name:"config.checkin_margin",label:(0,c.t)("Check-in Margin"),disabled:!t,help:(0,c.t)("The margin (in minutes) a check-in is allowed to exceed it's scheduled window before being treated as missed."),placeholder:"e.g. 30"})]});default:return null}}})]})]})]})})}}_.displayName="MonitorForm";const v=(0,l.Z)((0,d.Z)(_))},"./app/views/settings/components/forms/numberField.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var n=s("./app/views/settings/components/forms/inputField.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){return(0,o.tZ)(n.Z,{...e,type:"number"})}i.displayName="NumberField"},"./app/views/settings/components/forms/textField.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var n=s("./app/views/settings/components/forms/inputField.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){return(0,o.tZ)(n.Z,{...e,type:"text"})}i.displayName="TextField"}}]);
//# sourceMappingURL=../sourcemaps/app_views_monitors_edit_tsx.c51bebc71f88b75540f40b747bb715ac.js.map