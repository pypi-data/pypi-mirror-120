"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_actionCreators_events_tsx-app_components_charts_lineChart_tsx-app_components_events_searc-aae87d"],{"./app/actionCreators/events.tsx":(e,t,n)=>{n.d(t,{lI:()=>l,eV:()=>d,JE:()=>u}),n("../node_modules/core-js/modules/es.object.from-entries.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var s=n("../node_modules/lodash/pick.js"),r=n.n(s),o=n("./app/components/charts/utils.tsx"),i=n("./app/utils/getPeriod.tsx"),a=n("./app/utils/performance/constants.tsx");const l=(e,{organization:t,project:n,environment:s,team:r,period:a,start:l,end:d,interval:u,includePrevious:c,query:p,yAxis:m,field:h,topEvents:f,orderby:g,partial:v,withoutZerofill:b})=>{const x=(0,o.Sw)(c,a),y=Object.fromEntries(Object.entries({interval:u,project:n,environment:s,team:r,query:p,yAxis:m,field:h,topEvents:f,orderby:g,partial:v?"1":void 0,withoutZerofill:b?"1":void 0}).filter((([,e])=>void 0!==e))),w=(0,i.X)({period:a,start:l,end:d},{shouldDoublePeriod:x});return e.requestPromise("/organizations/".concat(t.slug,"/events-stats/"),{query:{...y,...w}})};async function d(e,t,n){const s={...r()(n,Object.values(a.s)),query:n.query};return e.requestPromise("/organizations/".concat(t,"/events-facets/"),{query:s})}async function u(e,t,n){const s={...r()(n,Object.values(a.s)),query:n.query};return e.requestPromise("/organizations/".concat(t,"/events-meta/"),{query:s}).then((e=>e.count))}},"./app/components/charts/lineChart.tsx":(e,t,n)=>{n.d(t,{Z:()=>a});var s=n("../node_modules/react/index.js"),r=n("./app/components/charts/series/lineSeries.tsx"),o=n("./app/components/charts/baseChart.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class a extends s.Component{render(){const{series:e,seriesOptions:t,...n}=this.props;return(0,i.tZ)(o.Z,{...n,series:e.map((({seriesName:e,data:n,dataArray:s,...o})=>(0,r.Z)({...t,...o,name:e,data:s||n.map((({value:e,name:t})=>[t,e])),animation:!1,animationThreshold:1,animationDuration:0})))})}}a.displayName="LineChart"},"./app/components/events/searchBar.tsx":(e,t,n)=>{n.d(t,{Z:()=>E});var s,r=n("../node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js"),o=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.object.from-entries.js"),n("../node_modules/react/index.js")),a=n("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),l=n("../node_modules/lodash/assign.js"),d=n.n(l),u=n("../node_modules/lodash/flatten.js"),c=n.n(u),p=n("../node_modules/lodash/isEqual.js"),m=n.n(p),h=n("../node_modules/lodash/memoize.js"),f=n.n(h),g=n("../node_modules/lodash/omit.js"),v=n.n(g),b=n("./app/actionCreators/tags.tsx"),x=n("./app/components/smartSearchBar/index.tsx"),y=n("./app/constants/index.tsx"),w=n("./app/types/index.tsx"),Z=n("./app/utils.tsx"),k=n("./app/utils/discover/fields.tsx"),j=n("./app/utils/measurements/measurements.tsx"),C=n("./app/utils/withApi.tsx"),S=n("./app/utils/withTags.tsx"),O=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const T=new RegExp("^".concat(y.c$,"|\\").concat(y.ir),"g");class F extends i.PureComponent{constructor(...e){super(...e),(0,o.Z)(this,"getEventFieldValues",f()(((e,t,n)=>{const{api:s,organization:r,projectIds:o}=this.props,i=null==o?void 0:o.map(String);return(0,k.h1)(e.key)||(0,k.Xr)(e.key)?Promise.resolve([]):(0,b.Fo)(s,r.slug,e.key,t,i,n,!0).then((e=>c()(e.filter((({name:e})=>(0,Z.ri)(e))).map((({name:e})=>e)))),(()=>{throw new Error("Unable to fetch event field values")}))}),(({key:e},t)=>"".concat(e,"-").concat(t)))),(0,o.Z)(this,"prepareQuery",(e=>e.replace(T,"")))}componentDidMount(){var e,t;null===(e=(t=this.getEventFieldValues.cache).clear)||void 0===e||e.call(t)}componentDidUpdate(e){var t,n;m()(this.props.projectIds,e.projectIds)||null===(t=(n=this.getEventFieldValues.cache).clear)||void 0===t||t.call(n)}getTagList(e){const{fields:t,organization:n,tags:s,omitTags:r}=this.props,o=t?Object.fromEntries(t.filter((e=>!Object.keys(k.wZ).includes(e.field)&&!(0,k.GO)(e.field))).map((e=>[e.field,{key:e.field,name:e.field}]))):{},i=n.features.includes("performance-view")?Object.assign({},e,k.wZ,o):v()(k.wZ,k.J8),a=n.features.includes("semver")?Object.assign({},k.jg,i):i,l=d()({},s,a);return l.has={key:"has",name:"Has property",values:Object.keys(l),predefined:!0},v()(l,null!=r?r:[])}render(){const{organization:e}=this.props;return(0,O.tZ)(j.Z,{organization:e,children:({measurements:e})=>{const t=this.getTagList(e);return(0,O.tZ)(a.ms,{children:({css:e})=>(0,O.tZ)(x.Z,{...this.props,hasRecentSearches:!0,savedSearchType:w.L4.EVENT,onGetTagValues:this.getEventFieldValues,supportedTags:t,prepareQuery:this.prepareQuery,excludeEnvironment:!0,dropdownClassName:e(s||(s=(0,r.Z)(["\n                    max-height: 300px;\n                    overflow-y: auto;\n                  "])))})})}})}}F.displayName="SearchBar";const E=(0,C.Z)((0,S.Z)(F))},"./app/utils/discover/charts.tsx":(e,t,n)=>{n.d(t,{CX:()=>i,gu:()=>a,b4:()=>l});var s=n("./app/locale.tsx"),r=n("./app/utils/discover/fields.tsx"),o=n("./app/utils/formatters.tsx");function i(e,t=""){switch((0,r.Px)(t)){case"integer":case"number":return e.toLocaleString();case"percentage":return(0,o.rl)(e,2);case"duration":return(0,o.g9)(e/1e3,2,!0);default:return e.toString()}}function a(e,t,n=!1){switch((0,r.Px)(t)){case"integer":case"number":return n?(0,o.Du)(e):e.toLocaleString();case"percentage":return(0,o.rl)(e,0);case"duration":return l(e);default:return e.toString()}}function l(e){if(0===e)return"0";if(e>=o.ps){const t=(e/o.ps).toFixed(0);return(0,s.t)("%swk",t)}if(e>=o.x4){const t=(e/o.x4).toFixed(0);return(0,s.t)("%sd",t)}if(e>=o.kr){const t=(e/o.kr).toFixed(0);return(0,s.t)("%shr",t)}if(e>=o.EB){const t=(e/o.EB).toFixed(0);return(0,s.t)("%smin",t)}if(e>=o.sh){const t=(e/o.sh).toFixed(0);return(0,s.t)("%ss",t)}const t=e.toFixed(0);return(0,s.t)("%sms",t)}},"./app/utils/getPeriod.tsx":(e,t,n)=>{n.d(t,{X:()=>a}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var s=n("../node_modules/moment/moment.js"),r=n.n(s),o=n("./app/constants/index.tsx"),i=n("./app/utils/dates.tsx");const a=({period:e,start:t,end:n},{shouldDoublePeriod:s}={})=>{if(e||t||n||(e=o.GY),e){if(!s)return{statsPeriod:e};const[,t,n]=e.match(/([0-9]+)([mhdw])/);return{statsPeriod:"".concat(2*parseInt(t,10)).concat(n)}}if(!t||!n)throw new Error("start and end required");const a=(0,i.v5)(t),l=(0,i.v5)(n);if(s){const e=r()(n).diff(r()(t)),s=r()(t).subtract(e);return{start:(0,i.v5)(s),end:l}}return{start:a,end:l}}},"./app/utils/measurements/measurements.tsx":(e,t,n)=>{n.d(t,{Z:()=>u}),n("../node_modules/core-js/modules/es.object.from-entries.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var s=n("../node_modules/react/index.js"),r=n("./app/utils/performance/vitals/constants.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){return Object.fromEntries(Object.entries(e).map((([e,t])=>[e,{name:t.name,key:e}])))}const a=i(r.T),l=i(r.r);function d({organization:e,children:t}){const n=e.features.includes("performance-mobile-vitals")?{...l,...a}:l;return(0,o.tZ)(s.Fragment,{children:t({measurements:n})})}d.displayName="Measurements";const u=d},"./app/utils/withTags.tsx":(e,t,n)=>{n.d(t,{Z:()=>l});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),o=n("./app/stores/tagStore.tsx"),i=n("./app/utils/getDisplayName.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends r.Component{constructor(...e){super(...e),(0,s.Z)(this,"state",{tags:o.Z.getAllTags()}),(0,s.Z)(this,"unsubscribe",o.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...n}=this.props;return(0,a.tZ)(e,{tags:null!=t?t:this.state.tags,...n})}}return t.displayName="WithTags",(0,s.Z)(t,"displayName","withTags(".concat((0,i.Z)(e),")")),t}},"./app/views/eventsV2/table/queryField.tsx":(e,t,n)=>{n.d(t,{q:()=>A});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/react/index.js")),i=n("../node_modules/react-select/dist/chunk-80640036.browser.esm.js"),a=n("../node_modules/@sentry/minimal/esm/index.js"),l=n("../node_modules/lodash/cloneDeep.js"),d=n.n(l),u=n("./app/components/forms/selectControl.tsx"),c=n("./app/components/tag.tsx"),p=n("./app/components/tooltip.tsx"),m=n("./app/icons/index.tsx"),h=n("./app/locale.tsx"),f=n("./app/styles/animations.tsx"),g=n("./app/styles/space.tsx"),v=n("./app/views/settings/components/forms/controls/input.tsx"),b=(n("../node_modules/core-js/modules/es.string.match-all.js"),n("../node_modules/lodash/isEqual.js")),x=n.n(b),y=n("./app/styles/overflowEllipsis.tsx"),w=n("./app/utils/discover/fields.tsx"),Z=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class k extends o.PureComponent{constructor(...e){super(...e),(0,s.Z)(this,"state",{query:this.props.value,partialTerm:null,rawOptions:this.props.options,dropdownVisible:!1,dropdownOptionGroups:F(this.props.options,null),activeSelection:-1}),(0,s.Z)(this,"input",(0,o.createRef)()),(0,s.Z)(this,"blur",(()=>{var e;null===(e=this.input.current)||void 0===e||e.blur()})),(0,s.Z)(this,"focus",(e=>{var t,n;null===(t=this.input.current)||void 0===t||t.focus(),null===(n=this.input.current)||void 0===n||n.setSelectionRange(e,e)})),(0,s.Z)(this,"handleChange",(e=>{const t=e.target.value.replace("\n","");this.setState({query:t},this.updateAutocompleteOptions)})),(0,s.Z)(this,"handleClick",(()=>{this.updateAutocompleteOptions()})),(0,s.Z)(this,"handleFocus",(()=>{this.setState({dropdownVisible:!0})})),(0,s.Z)(this,"handleBlur",(()=>{this.props.onUpdate(this.state.query),this.setState({dropdownVisible:!1})})),(0,s.Z)(this,"handleKeyDown",(e=>{const{key:t}=e,{options:n}=this.props,{activeSelection:s,partialTerm:r}=this.state,o=s>=0;if("ArrowDown"===t||"ArrowUp"===t){e.preventDefault();const i=F(n,r),a=i.map((e=>e.options)).flat();if(0===a.length)return;let l;return l=o?"ArrowUp"===t?(s-1+a.length)%a.length:(s+1)%a.length:"ArrowUp"===t?a.length-1:0,a[l].active=!0,void this.setState({activeSelection:l,dropdownOptionGroups:i})}if(!o||"Tab"!==t&&"Enter"!==t)"Enter"!==t||this.blur();else{e.preventDefault();const t=this.getSelection(s);t&&this.handleSelect(t)}})),(0,s.Z)(this,"handleKeyUp",(e=>{if("Escape"!==e.key)return;e.preventDefault();const{activeSelection:t}=this.state;t>=0||this.blur()})),(0,s.Z)(this,"handleSelect",(e=>{const{prefix:t,suffix:n}=this.splitQuery();this.setState({query:"".concat(t).concat(e.value," ").concat(n),activeSelection:-1},(()=>{this.focus(t.length+e.value.length+1),this.updateAutocompleteOptions()}))}))}static getDerivedStateFromProps(e,t){return x()(t.rawOptions,e.options)?{...t}:{...t,rawOptions:e.options,dropdownOptionGroups:F(e.options,t.partialTerm),activeSelection:-1}}getCursorPosition(){var e,t;return null!==(e=null===(t=this.input.current)||void 0===t?void 0:t.selectionStart)&&void 0!==e?e:-1}splitQuery(){const{query:e}=this.state,t=this.getCursorPosition(),n=[...e.substring(0,t).matchAll(/\s|^/g)],s=n[n.length-1],r=""===s[0]?0:(s.index||0)+1,o=e.slice(t).search(/\s|$/),i=t+(-1===o?0:o);return{startOfTerm:r,endOfTerm:i,prefix:e.substring(0,r),term:e.substring(r,i),suffix:e.substring(i)}}getSelection(e){const{dropdownOptionGroups:t}=this.state;for(const n of t){if(!(e>=n.options.length))return n.options[e];e-=n.options.length}return null}updateAutocompleteOptions(){const{options:e}=this.props,{term:t}=this.splitQuery(),n=t||null;this.setState({dropdownOptionGroups:F(e,n),partialTerm:n})}render(){const{onUpdate:e,options:t,...n}=this.props,{dropdownVisible:s,dropdownOptionGroups:r}=this.state;return(0,Z.BX)(j,{isOpen:s,children:[(0,Z.tZ)(C,{...n,ref:this.input,autoComplete:"off",className:"form-control",value:this.state.query,onClick:this.handleClick,onChange:this.handleChange,onBlur:this.handleBlur,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown,spellCheck:!1}),(0,Z.tZ)(S,{isOpen:s,optionGroups:r,handleSelect:this.handleSelect})]})}}k.displayName="ArithmeticInput",(0,s.Z)(k,"defaultProps",{options:[]});const j=(0,r.Z)("div",{target:"e18r1b6w8"})("border:1px solid ",(e=>e.theme.border),";box-shadow:inset ",(e=>e.theme.dropShadowLight),";background:",(e=>e.theme.background),";position:relative;border-radius:",(e=>e.isOpen?"".concat(e.theme.borderRadius," ").concat(e.theme.borderRadius," 0 0"):e.theme.borderRadius),";.show-sidebar &{background:",(e=>e.theme.backgroundSecondary),";}"),C=(0,r.Z)(v.Z,{target:"e18r1b6w7"})({name:"pv1u47",styles:"height:40px;padding:7px 10px;border:0;box-shadow:none;&:hover,&:focus{border:0;box-shadow:none;}"});function S({isOpen:e,optionGroups:t,handleSelect:n}){return(0,Z.tZ)(E,{isOpen:e,children:(0,Z.tZ)(_,{children:t.map((e=>{const{title:t,options:s}=e;return(0,Z.BX)(o.Fragment,{children:[(0,Z.tZ)(L,{children:(0,Z.tZ)(N,{children:t})}),s.map((e=>(0,Z.tZ)(q,{className:e.active?"active":void 0,onClick:()=>n(e),onMouseDown:e=>e.preventDefault(),ref:t=>{var n;return e.active&&(null==t||null===(n=t.scrollIntoView)||void 0===n?void 0:n.call(t,{block:"nearest"}))},children:(0,Z.tZ)(V,{children:e.value})},e.value))),0===s.length&&(0,Z.tZ)(P,{children:(0,h.t)("No items found")})]},t)}))})})}function O(e,t){const n=new Set;return{title:"Fields",options:e.filter((({kind:e})=>"equation"!==e)).filter(w.el).map((e=>({kind:"field",active:!1,value:(0,w.sN)(e)}))).filter((({value:e})=>!n.has(e)&&(n.add(e),!0))).filter((({value:e})=>!t||e.includes(t)))}}function T(e){return{title:"Operators",options:["+","-","*","/","(",")"].filter((t=>!e||t.includes(e))).map((e=>({kind:"operator",active:!1,value:e})))}}function F(e,t){return[O(e,t),T(t)]}S.displayName="TermDropdown";const E=(0,r.Z)("div",{target:"e18r1b6w6"})("display:",(e=>e.isOpen?"block":"none"),";position:absolute;top:100%;left:-1px;right:-1px;z-index:",(e=>e.theme.zIndex.dropdown),";background:",(e=>e.theme.background),";box-shadow:",(e=>e.theme.dropShadowLight),";border:1px solid ",(e=>e.theme.border),";border-radius:",(e=>e.theme.borderRadiusBottom),";max-height:300px;overflow-y:auto;"),_=(0,r.Z)("ul",{target:"e18r1b6w5"})({name:"nfj5ll",styles:"padding-left:0;list-style:none;margin-bottom:0"}),L=(0,r.Z)("li",{target:"e18r1b6w4"})("&:not(:last-child){border-bottom:1px solid ",(e=>e.theme.innerBorder),";}"),N=(0,r.Z)("header",{target:"e18r1b6w3"})("display:flex;align-items:center;background-color:",(e=>e.theme.backgroundSecondary),";color:",(e=>e.theme.gray300),";font-weight:normal;font-size:",(e=>e.theme.fontSizeMedium),";margin:0;padding:",(0,g.Z)(1)," ",(0,g.Z)(2),";&>svg{margin-right:",(0,g.Z)(1),";}"),q=(0,r.Z)(L,{target:"e18r1b6w2"})("scroll-margin:40px 0;font-size:",(e=>e.theme.fontSizeLarge),";padding:",(0,g.Z)(1)," ",(0,g.Z)(2),";cursor:pointer;&:hover,&.active{background:",(e=>e.theme.focus),";}"),V=(0,r.Z)("div",{target:"e18r1b6w1"})("color:",(e=>e.theme.textColor),";font-weight:normal;font-size:",(e=>e.theme.fontSizeMedium),";margin:0;line-height:",(e=>e.theme.text.lineHeightHeading),";",y.Z,";"),P=(0,r.Z)("div",{target:"e18r1b6w0"})("display:flex;padding:",(0,g.Z)(1)," ",(0,g.Z)(2),";font-size:",(e=>e.theme.fontSizeLarge),";color:",(e=>e.theme.gray300),";&:not(:last-child){border-bottom:1px solid ",(e=>e.theme.innerBorder),";}");var D=n("./app/views/eventsV2/table/types.tsx");class A extends o.Component{constructor(...e){super(...e),(0,s.Z)(this,"FieldSelectComponents",{Option:({label:e,data:t,...n})=>(t.value||a.$e((e=>{e.setExtra("data",t),a.Tb(new Error("Value missing from field option data"))})),(0,Z.BX)(i.y.Option,{label:e,data:t,...n,children:[(0,Z.tZ)("span",{"data-test-id":"label",children:e}),this.renderTag(t.value.kind)]})),SingleValue:({data:e,...t})=>(e.value||a.$e((t=>{t.setExtra("data",e),a.Tb(new Error("Value missing from field option data"))})),(0,Z.BX)(i.y.SingleValue,{data:e,...t,children:[(0,Z.tZ)("span",{"data-test-id":"label",children:e.label}),this.renderTag(e.value.kind)]}))}),(0,s.Z)(this,"FieldSelectStyles",{singleValue:e=>({...e,display:"flex",justifyContent:"space-between",alignItems:"center",width:"calc(100% - 10px)"}),option:e=>({...e,display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"})}),(0,s.Z)(this,"handleFieldChange",(e=>{if(!e)return;const{value:t}=e,n=this.props.fieldValue;let s=d()(this.props.fieldValue);switch(t.kind){case D.L.TAG:case D.L.MEASUREMENT:case D.L.BREAKDOWN:case D.L.FIELD:s={kind:"field",field:t.meta.name};break;case D.L.FUNCTION:"field"===n.kind?s={kind:"function",function:[t.meta.name,"",void 0,void 0]}:"function"===n.kind&&(s={kind:"function",function:[t.meta.name,n.function[1],n.function[2],n.function[3]]});break;default:throw new Error("Invalid field type found in column picker")}t.kind===D.L.FUNCTION&&(t.meta.parameters.forEach(((e,t)=>{if("function"===s.kind)if("column"===e.kind){const n=this.getFieldOrTagOrMeasurementValue(s.function[t+1]);null===n?s.function[t+1]=e.defaultValue||"":n.kind!==D.L.FIELD&&n.kind!==D.L.TAG&&n.kind!==D.L.MEASUREMENT&&n.kind!==D.L.BREAKDOWN||!I(e.columnTypes,n)?(s.function[t+1]=e.defaultValue||"",s.function[t+2]=void 0,s.function[t+3]=void 0):s.function[t+1]=n.meta.name}else s.function[t+1]=e.defaultValue||""})),"function"===s.kind&&(0===t.meta.parameters.length?s.function=[s.function[0],"",void 0,void 0]:1===t.meta.parameters.length?(s.function[2]=void 0,s.function[3]=void 0):2===t.meta.parameters.length&&(s.function[3]=void 0))),this.triggerChange(s)})),(0,s.Z)(this,"handleEquationChange",(e=>{const t=d()(this.props.fieldValue);t.kind===D.L.EQUATION&&(t.field=e),this.triggerChange(t)})),(0,s.Z)(this,"handleFieldParameterChange",(({value:e})=>{const t=d()(this.props.fieldValue);"function"===t.kind&&(t.function[1]=e.meta.name),this.triggerChange(t)})),(0,s.Z)(this,"handleDropdownParameterChange",(e=>t=>{const n=d()(this.props.fieldValue);"function"===n.kind&&(n.function[e]=t.value),this.triggerChange(n)})),(0,s.Z)(this,"handleScalarParameterChange",(e=>t=>{const n=d()(this.props.fieldValue);"function"===n.kind&&(n.function[e]=t),this.triggerChange(n)}))}triggerChange(e){this.props.onChange(e)}getFieldOrTagOrMeasurementValue(e){const{fieldOptions:t}=this.props;if(void 0===e)return null;const n="field:".concat(e);if(t[n])return t[n].value;const s="measurement:".concat(e);if(t[s])return t[s].value;const r="span_op_breakdown:".concat(e);if(t[r])return t[r].value;const o=0===e.indexOf("tags[")?"tag:".concat(e.replace(/tags\[(.*?)\]/,"$1")):"tag:".concat(e);return t[o]?t[o].value:e.length>0?{kind:D.L.TAG,meta:{name:e,dataType:"string",unknown:!0}}:null}getFieldData(){let e=null;const{fieldValue:t}=this.props;let{fieldOptions:n}=this.props;if("function"===t.kind){const s="function:".concat(t.function[0]);void 0!==n[s]&&(e=n[s].value)}"field"===t.kind&&(e=this.getFieldOrTagOrMeasurementValue(t.field),n=this.appendFieldIfUnknown(n,e));let s=[];return e&&e.kind===D.L.FUNCTION&&e.meta.parameters.length>0&&t.kind===D.L.FUNCTION&&(s=e.meta.parameters.map(((e,s)=>{if("column"===e.kind){const s=this.getFieldOrTagOrMeasurementValue(t.function[1]);return n=this.appendFieldIfUnknown(n,s),{kind:"column",value:s,required:e.required,options:Object.values(n).filter((({value:t})=>(t.kind===D.L.FIELD||t.kind===D.L.TAG||t.kind===D.L.MEASUREMENT||t.kind===D.L.BREAKDOWN)&&I(e.columnTypes,t)))}}return"dropdown"===e.kind?{kind:"dropdown",options:e.options,dataType:e.dataType,required:e.required,value:"function"===t.kind&&t.function[s+1]||e.defaultValue||""}:{kind:"value",value:"function"===t.kind&&t.function[s+1]||e.defaultValue||"",dataType:e.dataType,required:e.required,placeholder:e.placeholder}}))),{field:e,fieldOptions:n,parameterDescriptions:s}}appendFieldIfUnknown(e,t){return t?(t&&t.kind===D.L.TAG&&t.meta.unknown&&((e=Object.assign({},e))[t.meta.name]={label:t.meta.name,value:t}),e):e}renderParameterInputs(e){const{disabled:t,inFieldLabels:n,filterAggregateParameters:s,hideParameterSelector:r}=this.props,o=e.map(((e,o)=>{if("column"===e.kind&&e.options.length>0){if(r)return null;const o=s?e.options.filter(s):e.options;return(0,Z.tZ)(u.Z,{name:"parameter",placeholder:(0,h.t)("Select value"),options:o,value:e.value,required:e.required,onChange:this.handleFieldParameterChange,inFieldLabel:n?(0,h.t)("Parameter: "):void 0,disabled:t,styles:n?void 0:this.FieldSelectStyles,components:this.FieldSelectComponents},"select")}if("value"===e.kind){const n={required:e.required,value:e.value,onUpdate:this.handleScalarParameterChange(o+1),placeholder:e.placeholder,disabled:t};switch(e.dataType){case"number":return(0,Z.tZ)(B,{name:"refinement",type:"text",inputMode:"numeric",pattern:"[0-9]*(\\.[0-9]*)?",...n},"parameter:number");case"integer":return(0,Z.tZ)(B,{name:"refinement",type:"text",inputMode:"numeric",pattern:"[0-9]*",...n},"parameter:integer");default:return(0,Z.tZ)(B,{name:"refinement",type:"text",...n},"parameter:text")}}if("dropdown"===e.kind)return(0,Z.tZ)(u.Z,{name:"dropdown",placeholder:(0,h.t)("Select value"),options:e.options,value:e.value,required:e.required,onChange:this.handleDropdownParameterChange(o+1),inFieldLabel:n?(0,h.t)("Parameter: "):void 0,disabled:t},"dropdown");throw new Error("Unknown parameter type encountered for ".concat(this.props.fieldValue))})),{gridColumns:i}=this.props,a=(null!=i?i:o.length+1)-o.length-1;if(void 0!==i&&a>0)for(let e=0;e<a;e++)o.push((0,Z.tZ)(M,{},e));return o}renderTag(e){const{shouldRenderTag:t}=this.props;if(!1===t)return null;let n,s;switch(e){case D.L.FUNCTION:n="f(x)",s="success";break;case D.L.MEASUREMENT:n="measure",s="info";break;case D.L.BREAKDOWN:n="breakdown",s="error";break;case D.L.TAG:n=e,s="warning";break;case D.L.FIELD:n=e,s="highlight";break;default:n=e}return(0,Z.tZ)(c.Z,{type:s,children:n})}render(){const{className:e,takeFocus:t,filterPrimaryOptions:n,fieldValue:s,inFieldLabels:r,disabled:o,error:i,hidePrimarySelector:a,gridColumns:l,otherColumns:d}=this.props,{field:c,fieldOptions:p,parameterDescriptions:f}=this.getFieldData(),g=n?Object.values(p).filter(n):Object.values(p),v={name:"field",options:Object.values(g),placeholder:(0,h.t)("(Required)"),value:c,onChange:this.handleFieldChange,inFieldLabel:r?(0,h.t)("Function: "):void 0,disabled:o};t&&null===c&&(v.autoFocus=!0);const b=this.renderParameterInputs(f);if(s.kind===D.L.EQUATION)return(0,Z.BX)(U,{className:e,gridColumns:1,tripleLayout:!1,error:void 0!==i,children:[(0,Z.tZ)(k,{name:"arithmetic",type:"text",required:!0,value:s.field,onUpdate:this.handleEquationChange,options:d},"parameter:text"),i?(0,Z.tZ)(R,{title:i,children:(0,Z.tZ)(m.FC,{color:"red300"})}):null]});const x=b.length>2?2:l||b.length+1;return(0,Z.BX)(U,{className:e,gridColumns:x,tripleLayout:3===l&&b.length>2,children:[!a&&(0,Z.tZ)(u.Z,{...v,styles:r?void 0:this.FieldSelectStyles,components:this.FieldSelectComponents}),b]})}}function I(e,t){return"function"==typeof e?e({name:t.meta.name,dataType:t.meta.dataType}):e.includes(t.meta.dataType)}A.displayName="QueryField";const U=(0,r.Z)("div",{target:"eve9joo3"})("display:grid;",(e=>e.tripleLayout?"grid-template-columns: 1fr 2fr;":"grid-template-columns: repeat(".concat(e.gridColumns,", 1fr) ").concat(e.error?"auto":"",";"))," grid-gap:",(0,g.Z)(1),";align-items:center;flex-grow:1;");class B extends o.Component{constructor(e){super(e),(0,s.Z)(this,"state",{value:this.props.value}),(0,s.Z)(this,"input",void 0),(0,s.Z)(this,"handleBlur",(()=>{this.isValid?this.props.onUpdate(this.state.value):this.setState({value:this.props.value})})),(0,s.Z)(this,"handleChange",(e=>{this.isValid&&this.setState({value:e.target.value})})),this.input=o.createRef()}get isValid(){return!this.input.current||this.input.current.validity.valid}render(){const{onUpdate:e,...t}=this.props;return(0,Z.tZ)(z,{...t,ref:this.input,className:"form-control",value:this.state.value,onChange:this.handleChange,onBlur:this.handleBlur})}}B.displayName="BufferedInput";const z=(0,r.Z)(v.Z,{target:"eve9joo2"})({name:"9dgk9j",styles:"height:41px;min-width:50px"}),M=(0,r.Z)("div",{target:"eve9joo1"})("height:41px;min-width:50px;background:",(e=>e.theme.backgroundSecondary),";border-radius:",(e=>e.theme.borderRadius),";display:flex;align-items:center;justify-content:center;&:after{font-size:",(e=>e.theme.fontSizeMedium),";content:'",(0,h.t)("No parameter"),"';color:",(e=>e.theme.gray300),";}"),R=(0,r.Z)(p.Z,{target:"eve9joo0"})("color:",(e=>e.theme.red300),";animation:",(()=>(0,f.dC)(1.15))," 1s ease infinite;display:flex;")}}]);
//# sourceMappingURL=../sourcemaps/app_actionCreators_events_tsx-app_components_charts_lineChart_tsx-app_components_events_searc-aae87d.cd56174053a8a99d04f03eaba3288bd7.js.map