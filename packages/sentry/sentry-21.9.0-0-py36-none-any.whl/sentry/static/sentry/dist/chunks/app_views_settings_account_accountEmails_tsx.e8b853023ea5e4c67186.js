"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_account_accountEmails_tsx"],{"./app/views/settings/account/accountEmails.tsx":(e,s,t)=>{t.r(s),t.d(s,{default:()=>_,EmailAddresses:()=>F});var o=t("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=t("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(t("../node_modules/core-js/modules/web.dom-collections.iterator.js"),t("../node_modules/react/index.js")),r=t("./app/actionCreators/indicator.tsx"),l=t("./app/components/alertLink.tsx"),a=t("./app/components/asyncComponent.tsx"),d=t("./app/components/button.tsx"),m=t("./app/components/buttonBar.tsx"),c=t("./app/components/loadingIndicator.tsx"),p=t("./app/components/panels/index.tsx"),h=t("./app/components/tag.tsx"),u=t("./app/data/forms/accountEmails.tsx"),f=t("./app/icons/index.tsx"),g=t("./app/locale.tsx"),v=t("./app/styles/space.tsx"),y=t("./app/views/asyncView.tsx"),Z=t("./app/views/settings/components/forms/form.tsx"),x=t("./app/views/settings/components/forms/jsonForm.tsx"),b=t("./app/views/settings/components/settingsPageHeader.tsx"),P=t("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const j="/users/me/emails/";class w extends("app"==t.j?y.Z:null){constructor(...e){super(...e),(0,o.Z)(this,"handleSubmitSuccess",((e,s,t)=>{void 0!==t&&(s.setValue(t,""),this.remountComponent())}))}getTitle(){return(0,g.t)("Emails")}getEndpoints(){return[]}renderBody(){return(0,P.BX)(n.Fragment,{children:[(0,P.tZ)(b.Z,{title:(0,g.t)("Email Addresses")}),(0,P.tZ)(F,{}),(0,P.tZ)(Z.Z,{apiMethod:"POST",apiEndpoint:j,saveOnBlur:!0,allowUndo:!1,onSubmitSuccess:this.handleSubmitSuccess,children:(0,P.tZ)(x.Z,{forms:u.default})}),(0,P.tZ)(l.Z,{to:"/settings/account/notifications",icon:(0,P.tZ)(f.bv,{}),children:(0,g.t)("Want to change how many emails you get? Use the notifications panel.")})]})}}const _="app"==t.j?w:null;class F extends a.Z{constructor(...e){super(...e),(0,o.Z)(this,"handleSetPrimary",(e=>this.doApiCall(j,{method:"PUT",data:{email:e}}))),(0,o.Z)(this,"handleRemove",(e=>this.doApiCall(j,{method:"DELETE",data:{email:e}}))),(0,o.Z)(this,"handleVerify",(e=>this.doApiCall("".concat(j,"confirm/"),{method:"POST",data:{email:e}})))}getEndpoints(){return[["emails",j]]}doApiCall(e,s){this.setState({loading:!0,emails:[]},(()=>this.api.requestPromise(e,s).then((()=>this.remountComponent())).catch((e=>{var s;this.remountComponent(),null!=e&&null!==(s=e.responseJSON)&&void 0!==s&&s.email&&(0,r.Iw)(e.responseJSON.email)}))))}render(){const{emails:e,loading:s}=this.state,t=null==e?void 0:e.find((({isPrimary:e})=>e)),o=null==e?void 0:e.filter((({isPrimary:e})=>!e));return s?(0,P.BX)(p.s_,{children:[(0,P.tZ)(p.V9,{children:(0,g.t)("Email Addresses")}),(0,P.tZ)(p.N,{children:(0,P.tZ)(c.Z,{})})]}):(0,P.BX)(p.s_,{children:[(0,P.tZ)(p.V9,{children:(0,g.t)("Email Addresses")}),(0,P.BX)(p.N,{children:[t&&(0,P.tZ)(S,{onRemove:this.handleRemove,onVerify:this.handleVerify,...t}),null==o?void 0:o.map((e=>(0,P.tZ)(S,{onSetPrimary:this.handleSetPrimary,onRemove:this.handleRemove,onVerify:this.handleVerify,...e},e.email)))]})]})}}F.displayName="EmailAddresses";const S=({email:e,onRemove:s,onVerify:t,onSetPrimary:o,isVerified:i,isPrimary:n,hideRemove:r})=>(0,P.BX)(E,{children:[(0,P.BX)(C,{children:[e,!i&&(0,P.tZ)(h.Z,{type:"warning",children:(0,g.t)("Unverified")}),n&&(0,P.tZ)(h.Z,{type:"success",children:(0,g.t)("Primary")})]}),(0,P.BX)(m.ZP,{gap:1,children:[!n&&i&&(0,P.tZ)(d.ZP,{size:"small",onClick:s=>null==o?void 0:o(e,s),children:(0,g.t)("Set as primary")}),!i&&(0,P.tZ)(d.ZP,{size:"small",onClick:s=>t(e,s),children:(0,g.t)("Resend verification")}),!r&&!n&&(0,P.tZ)(d.ZP,{label:(0,g.t)("Remove email"),"data-test-id":"remove",priority:"danger",size:"small",icon:(0,P.tZ)(f.Fz,{}),onClick:t=>s(e,t)})]})]});S.displayName="EmailRow";const C=(0,i.Z)("div",{target:"etbgoaq1"})("display:grid;grid-auto-flow:column;grid-gap:",(0,v.Z)(1),";align-items:center;"),E=(0,i.Z)(p.Lv,{target:"etbgoaq0"})({name:"2o6p8u",styles:"justify-content:space-between"})},"./app/views/settings/components/forms/formPanel.tsx":(e,s,t)=>{t.d(s,{Z:()=>c});var o=t("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=t("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(t("../node_modules/core-js/modules/web.dom-collections.iterator.js"),t("../node_modules/react/index.js")),r=t("./app/components/panels/index.tsx"),l=t("./app/icons/index.tsx"),a=t("./app/utils/sanitizeQuerySelector.tsx"),d=t("./app/views/settings/components/forms/fieldFromConfig.tsx"),m=t("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class c extends n.Component{constructor(...e){super(...e),(0,o.Z)(this,"state",{collapsed:!1}),(0,o.Z)(this,"handleToggleEvents",(()=>{const{collapsed:e}=this.state;this.setState({collapsed:!e})}))}render(){const{title:e,fields:s,access:t,disabled:o,additionalFieldProps:i,renderFooter:n,renderHeader:c,collapsible:h,...u}=this.props,{collapsed:f}=this.state;return(0,m.BX)(r.s_,{id:"string"==typeof e?(0,a.m)(e):void 0,children:[e&&(0,m.BX)(r.V9,{children:[e,h&&(0,m.tZ)(p,{onClick:this.handleToggleEvents,children:(0,m.tZ)(l.g6,{direction:f?"down":"up",size:"xs"})})]}),!f&&(0,m.BX)(r.N,{children:["function"==typeof c&&c({title:e,fields:s}),s.map((e=>{if("function"==typeof e)return e();const{defaultValue:s,...n}=e;return!0===o&&(n.disabled=!0,n.disabledReason=void 0),(0,m.tZ)(d.Z,{access:t,disabled:o,...u,...i,field:n,highlighted:this.props.highlighted==="#".concat(e.name)},e.name)})),"function"==typeof n&&n({title:e,fields:s})]})]})}}c.displayName="FormPanel",(0,o.Z)(c,"defaultProps",{additionalFieldProps:{}});const p=(0,i.Z)("span",{target:"efsz5z60"})({name:"e0dnmk",styles:"cursor:pointer"})},"./app/views/settings/components/forms/jsonForm.tsx":(e,s,t)=>{t.d(s,{Z:()=>u});var o=t("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(t("../node_modules/core-js/modules/web.dom-collections.iterator.js"),t("../node_modules/react/index.js")),n=t("../node_modules/react-router/es/index.js"),r=t("../node_modules/@sentry/minimal/esm/index.js"),l=t("../node_modules/scroll-to-element/index.js"),a=t.n(l),d=t("./app/utils.tsx"),m=t("./app/utils/sanitizeQuerySelector.tsx"),c=t("./app/views/settings/components/forms/formPanel.tsx"),p=t("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class h extends i.Component{constructor(...e){var s;super(...e),(0,o.Z)(this,"state",{highlighted:null===(s=this.props.location)||void 0===s?void 0:s.hash})}componentDidMount(){this.scrollToHash()}UNSAFE_componentWillReceiveProps(e){if(this.props.location.hash!==e.location.hash){const s=e.location.hash;this.scrollToHash(s),this.setState({highlighted:s})}}scrollToHash(e){var s;const t=e||(null===(s=this.props.location)||void 0===s?void 0:s.hash);if(t)try{a()((0,m.m)(decodeURIComponent(t)),{align:"middle",offset:-100})}catch(e){r.Tb(e)}}shouldDisplayForm(e){const s=e.filter((e=>"function"!=typeof e&&(0,d.ri)(null==e?void 0:e.visible)));if(e.length===s.length){const{additionalFieldProps:e,...t}=this.props;return!s.every((s=>"function"==typeof s.visible?!s.visible({...t,...e}):!s.visible))}return!0}renderForm({fields:e,formPanelProps:s,title:t}){return this.shouldDisplayForm(e)||null!=s&&s.renderFooter||null!=s&&s.renderHeader?(0,p.tZ)(c.Z,{title:t,fields:e,...s}):null}render(){const{access:e,collapsible:s,fields:t,title:o,forms:n,disabled:r,features:l,additionalFieldProps:a,renderFooter:d,renderHeader:m,location:c,...h}=this.props,u={access:e,disabled:r,features:l,additionalFieldProps:a,renderFooter:d,renderHeader:m,highlighted:this.state.highlighted,collapsible:s};return(0,p.BX)("div",{...h,children:[void 0!==n&&n.map(((e,s)=>(0,p.tZ)(i.Fragment,{children:this.renderForm({formPanelProps:u,...e})},s))),void 0===n&&void 0!==t&&this.renderForm({fields:t,formPanelProps:u,title:o})]})}}h.displayName="JsonForm";const u=(0,n.withRouter)(h)}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_account_accountEmails_tsx.e22a8753acaaf07406c94c3273b982f5.js.map