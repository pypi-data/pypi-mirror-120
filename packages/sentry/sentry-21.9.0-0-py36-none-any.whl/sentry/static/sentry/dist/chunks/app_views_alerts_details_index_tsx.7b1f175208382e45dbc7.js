"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_alerts_details_index_tsx","app_components_sentryDocumentTitle_tsx"],{"./app/components/charts/components/markLine.tsx":(t,e,i)=>{function n(t){return{symbol:["none","none"],...t}}i.d(e,{Z:()=>n}),i("../node_modules/echarts/lib/component/markLine.js")},"./app/components/charts/lineChart.tsx":(t,e,i)=>{i.d(e,{Z:()=>s});var n=i("../node_modules/react/index.js"),a=i("./app/components/charts/series/lineSeries.tsx"),o=i("./app/components/charts/baseChart.tsx"),r=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class s extends n.Component{render(){const{series:t,seriesOptions:e,...i}=this.props;return(0,r.tZ)(o.Z,{...i,series:t.map((({seriesName:t,data:i,dataArray:n,...o})=>(0,a.Z)({...e,...o,name:t,data:n||i.map((({value:t,name:e})=>[e,t])),animation:!1,animationThreshold:1,animationDuration:0})))})}}s.displayName="LineChart"},"./app/components/keyValueTable.tsx":(t,e,i)=>{i.d(e,{v:()=>l,G:()=>d});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=i("../node_modules/react/index.js"),o=i("./app/styles/overflowEllipsis.tsx"),r=i("./app/styles/space.tsx"),s=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=(0,n.Z)("dl",{target:"e13z4zle2"})({name:"u4s7v9",styles:"display:grid;grid-template-columns:50% 50%"}),d=({keyName:t,value:e})=>(0,s.BX)(a.Fragment,{children:[(0,s.tZ)(p,{children:t}),(0,s.tZ)(u,{children:e})]});d.displayName="KeyValueTableRow";const c=({theme:t})=>"\nfont-size: ".concat(t.fontSizeMedium,";\npadding: ").concat((0,r.Z)(.5)," ").concat((0,r.Z)(1),";\nfont-weight: normal;\nline-height: inherit;\n").concat(o.Z,";\n&:nth-of-type(2n-1) {\n  background-color: ").concat(t.backgroundSecondary,";\n}\n"),p=(0,n.Z)("dt",{target:"e13z4zle1"})(c,";color:",(t=>t.theme.textColor),";"),u=(0,n.Z)("dd",{target:"e13z4zle0"})(c,";color:",(t=>t.theme.subText),";text-align:right;")},"./app/components/seenByList.tsx":(t,e,i)=>{i.d(e,{Z:()=>b});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=i("../node_modules/react/index.js"),o=i("../node_modules/classnames/index.js"),r=i.n(o),s=i("../node_modules/moment/moment.js"),l=i.n(s),d=i("./app/components/avatar/avatarList.tsx"),c=i("./app/components/tooltip.tsx"),p=i("./app/icons/index.tsx"),u=i("./app/locale.tsx"),m=i("./app/stores/configStore.tsx"),h=i("./app/styles/space.tsx"),g=i("./app/utils/formatters.tsx"),v=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const Z=({avatarSize:t=28,seenBy:e=[],iconTooltip:i=(0,u.t)("People who have viewed this"),maxVisibleAvatars:n=10,iconPosition:o="left",className:s})=>{const h=m.Z.get("user"),Z=e.filter((t=>h.id!==t.id));return 0===Z.length?null:(0,v.BX)(x,{iconPosition:o,className:r()("seen-by",s),children:[(0,v.tZ)(d.Z,{users:Z,avatarSize:t,maxVisibleAvatars:n,renderTooltip:t=>(0,v.BX)(a.Fragment,{children:[(0,g.He)(t),(0,v.tZ)("br",{}),l()(t.lastSeen).format("LL")]})}),(0,v.tZ)(y,{iconPosition:o,children:(0,v.tZ)(c.Z,{title:i,children:(0,v.tZ)(p.fn,{size:"sm",color:"gray200"})})})]})};Z.displayName="SeenByList";const x=(0,n.Z)("div",{target:"e1ayiung1"})("display:flex;margin-top:15px;float:right;",(t=>"left"===t.iconPosition?"flex-direction: row-reverse":""),";"),y=(0,n.Z)("div",{target:"e1ayiung0"})("background-color:transparent;color:",(t=>t.theme.textColor),";height:28px;width:24px;line-height:26px;text-align:center;padding-top:",(0,h.Z)(.5),";",(t=>"left"===t.iconPosition?"margin-right: 10px":""),";"),b=Z},"./app/components/sentryDocumentTitle.tsx":(t,e,i)=>{i.d(e,{Z:()=>s}),i("../node_modules/react/index.js");var n=i("../node_modules/react-document-title/index.js"),a=i.n(n),o=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function r({title:t,orgSlug:e,projectSlug:i,children:n}){const r=e||i?e&&i?"".concat(t," - ").concat(e," - ").concat(i):e?"".concat(t," - ").concat(e):"".concat(t," - ").concat(i):t;return(0,o.tZ)(a(),{title:"".concat(r," - Sentry"),children:n})}r.displayName="SentryDocumentTitle";const s=r},"./app/utils/replaceAtArrayIndex.tsx":(t,e,i)=>{function n(t,e,i){const n=[...t];return n.splice(e,1,i),n}i.d(e,{m:()=>n}),i("../node_modules/core-js/modules/web.dom-collections.iterator.js")},"./app/views/alerts/details/activity/statusItem.tsx":(t,e,i)=>{i.d(e,{Z:()=>p,O:()=>m});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=i("../node_modules/react/index.js"),o=i("./app/components/activity/item/index.tsx"),r=i("./app/locale.tsx"),s=i("./app/utils/getDynamicText.tsx"),l=i("./app/views/alerts/types.tsx"),d=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class c extends a.Component{render(){const{activity:t,authorName:e,incident:i,showTime:n}=this.props,a=t.type===l.lm.DETECTED,c=t.type===l.lm.STARTED,p=t.type===l.lm.STATUS_CHANGE&&t.value==="".concat(l.vt.CLOSED),h=t.type===l.lm.STATUS_CHANGE&&!p;if(!(c||a||p||h))return null;const g=m(t.value),v=m(t.previousValue);return(0,d.tZ)(o.Z,{showTime:n,author:{type:t.user?"user":"system",user:t.user||void 0},header:(0,d.BX)("div",{children:[h&&v&&(0,r._N)("Alert status changed from [previousTrigger] to [currentTrigger]",{previousTrigger:v,currentTrigger:(0,d.tZ)(u,{children:g})}),h&&!v&&(0,r._N)("Alert status changed to [currentTrigger]",{currentTrigger:(0,d.tZ)(u,{children:g})}),p&&(null==i?void 0:i.statusMethod)===l.Xn.RULE_UPDATED&&(0,r.t)("This alert has been auto-resolved because the rule that triggered it has been modified or deleted."),p&&(null==i?void 0:i.statusMethod)!==l.Xn.RULE_UPDATED&&(0,r._N)("[user] resolved the alert",{user:(0,d.tZ)(u,{children:e})}),a&&(null!=i&&i.alertRule?(0,r.t)("Alert was created"):(0,r._N)("[user] created an alert",{user:(0,d.tZ)(u,{children:e})})),c&&(0,r.t)("Trigger conditions were met for the interval")]}),date:(0,s.Z)({value:t.dateCreated,fixed:new Date(0)}),interval:c?null==i?void 0:i.alertRule.timeWindow:void 0})}}c.displayName="StatusItem";const p=c,u=(0,n.Z)("span",{target:"e1cd8nnk0"})({name:"1efi8gv",styles:"font-weight:bold"});function m(t){return t==="".concat(l.vt.WARNING)?(0,r.t)("Warning"):t==="".concat(l.vt.CRITICAL)?(0,r.t)("Critical"):""}},"./app/views/alerts/details/index.tsx":(t,e,i)=>{i.r(e),i.d(e,{alertDetailsLink:()=>ae,default:()=>re});var n=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=(i("../node_modules/core-js/modules/web.dom-collections.iterator.js"),i("../node_modules/core-js/modules/es.string.replace.js"),i("../node_modules/react/index.js")),o=i("../node_modules/react-router/es/index.js"),r=i("./app/actionCreators/indicator.tsx"),s=i("./app/locale.tsx"),l=i("./app/actionCreators/members.tsx"),d=i("./app/components/sentryDocumentTitle.tsx"),c=i("./app/utils/analytics.tsx"),p=i("./app/utils/withApi.tsx"),u=i("./app/views/alerts/types.tsx"),m=i("./app/views/alerts/utils/index.tsx"),h=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),g=i("./app/components/acl/feature.tsx"),v=i("./app/components/alert.tsx"),Z=i("./app/components/button.tsx"),x=i("./app/components/charts/styles.tsx"),y=i("./app/components/duration.tsx"),b=i("./app/components/keyValueTable.tsx"),w=i("./app/components/links/link.tsx"),f=i("./app/components/navTabs.tsx"),S=i("./app/components/panels/index.tsx"),A=i("./app/components/placeholder.tsx"),T=i("./app/components/seenByList.tsx"),C=i("./app/icons/index.tsx"),I=i("./app/styles/organization.tsx"),N=i("./app/styles/space.tsx"),X=i("./app/utils.tsx"),R=i("./app/utils/projects.tsx"),E=i("./app/utils/theme.tsx"),Y=i("./app/views/alerts/incidentRules/constants.tsx"),j=i("./app/views/alerts/incidentRules/presets.tsx"),z=i("./app/views/alerts/incidentRules/types.tsx"),P=i("./app/constants/index.tsx"),k=i("./app/stores/configStore.tsx"),D=i("./app/utils/guid.tsx"),B=i("./app/utils/replaceAtArrayIndex.tsx"),q=i("../node_modules/lodash/groupBy.js"),L=i.n(q),U=i("../node_modules/moment/moment.js"),M=i.n(U),W=i("./app/components/activity/item/index.tsx"),O=i("./app/components/activity/note/index.tsx"),F=i("./app/components/activity/note/inputWithStorage.tsx"),G=i("./app/components/errorBoundary.tsx"),V=i("./app/components/loadingError.tsx"),H=i("./app/components/timeSince.tsx"),J=i("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),K=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const Q=(0,J.b)((function(t){return(0,K.tZ)(W.Z,{bubbleProps:{backgroundColor:t.theme.backgroundSecondary,borderColor:t.theme.backgroundSecondary},children:()=>(0,K.tZ)(_,{})})})),_=(0,h.Z)("div",{target:"ewycs2l0"})("padding:",(0,N.Z)(4),";"),$=(0,h.Z)("div",{target:"e18r53lx0"})("font-size:",(t=>t.theme.fontSizeMedium),";display:flex;align-items:center;justify-content:center;color:",(t=>t.theme.subText),";margin:",(0,N.Z)(1.5)," 0;&:before,&:after{content:'';display:block;flex-grow:1;height:1px;background-color:",(t=>t.theme.gray200),";}&:before{margin-right:",(0,N.Z)(2),";}&:after{margin-left:",(0,N.Z)(2),";}");var tt=i("./app/views/alerts/details/activity/statusItem.tsx");class et extends a.Component{constructor(...t){super(...t),(0,n.Z)(this,"handleUpdateNote",((t,{activity:e})=>{const{onUpdateNote:i}=this.props;i(t,e)})),(0,n.Z)(this,"handleDeleteNote",(({activity:t})=>{const{onDeleteNote:e}=this.props;e(t)}))}render(){const{loading:t,error:e,me:i,alertId:n,incident:o,activities:r,noteInputId:l,createBusy:d,createError:c,createErrorJSON:p,onCreateNote:m}=this.props,h={minHeight:80,projectSlugs:o&&o.projects||[],...this.props.noteInputProps},g=L()(r,(({dateCreated:t})=>M()(t).format("ll"))),v=M()().format("ll");return(0,K.BX)("div",{children:[(0,K.tZ)(W.Z,{author:{type:"user",user:i},children:()=>(0,K.tZ)(F.Z,{storageKey:"incidentIdinput",itemKey:n,onCreate:m,busy:d,error:c,errorJSON:p,placeholder:(0,s.t)("Leave a comment, paste a tweet, or link any other relevant information about this alert..."),...h},l)}),e&&(0,K.tZ)(V.Z,{message:(0,s.t)("There was a problem loading activities")}),t&&(0,K.BX)(a.Fragment,{children:[(0,K.tZ)(Q,{}),(0,K.tZ)(Q,{}),(0,K.tZ)(Q,{})]}),!t&&!e&&Object.entries(g).map((([t,e])=>{const i=t===v?(0,s.t)("Today"):(0,K.BX)(a.Fragment,{children:[t," ",(0,K.tZ)(nt,{date:t})]});return(0,K.BX)(a.Fragment,{children:[(0,K.tZ)($,{children:i}),e&&e.map((t=>{var e,i;const n=null!==(e=null===(i=t.user)||void 0===i?void 0:i.name)&&void 0!==e?e:"Sentry";return t.type===u.lm.COMMENT?(0,K.tZ)(G.Z,{mini:!0,children:(0,K.tZ)(O.Z,{showTime:!0,user:t.user,modelId:t.id,text:t.comment||"",dateCreated:t.dateCreated,activity:t,authorName:n,onDelete:this.handleDeleteNote,onUpdate:this.handleUpdateNote,...h})},"note-".concat(t.id)):(0,K.tZ)(G.Z,{mini:!0,children:(0,K.tZ)(tt.Z,{showTime:!0,incident:o,authorName:n,activity:t})},"note-".concat(t.id))}))]},t)}))]})}}et.displayName="Activity";const it=et,nt=(0,h.Z)(H.Z,{target:"eni3yra0"})("color:",(t=>t.theme.gray300),";font-size:",(t=>t.theme.fontSizeSmall),";margin-left:",(0,N.Z)(.5),";");class at extends a.PureComponent{constructor(...t){super(...t),(0,n.Z)(this,"state",{loading:!0,error:!1,noteInputId:(0,D.E)(),noteInputText:"",createBusy:!1,createError:!1,createErrorJSON:null,activities:null}),(0,n.Z)(this,"handleCreateNote",(async t=>{const{api:e,params:i}=this.props,{alertId:n,orgId:a}=i,o={comment:t.text,type:u.lm.COMMENT,dateCreated:(new Date).toISOString(),user:k.Z.get("user"),id:(0,D.E)(),incidentIdentifier:n};this.setState((t=>({createBusy:!0,noteInputId:(0,D.E)(),activities:[o,...t.activities||[]],noteInputText:""})));try{const i=await async function(t,e,i,n){try{return await t.requestPromise("/organizations/".concat(e,"/incidents/").concat(i,"/comments/"),{method:"POST",data:{mentions:n.mentions,comment:n.text}})}catch(t){throw(0,r.Iw)((0,s.t)("Unable to post comment")),t}}(e,a,n,t);this.setState((t=>({createBusy:!1,activities:[i,...t.activities.filter((t=>t!==o))]})))}catch(e){this.setState((i=>{const n=i.activities.filter((t=>t!==o));return{noteInputText:t.text,activities:n,createBusy:!1,createError:!0,createErrorJSON:e.responseJSON||P.N7}}))}})),(0,n.Z)(this,"getIndexAndActivityFromState",(t=>{const e=null!==this.state.activities?this.state.activities.findIndex((({id:e})=>e===t.id)):"";return[e,this.state.activities[e]]})),(0,n.Z)(this,"handleDeleteNote",(async t=>{const{api:e,params:i}=this.props,{alertId:n,orgId:a}=i,[o,l]=this.getIndexAndActivityFromState(t);this.setState((t=>({activities:rt(t.activities,o)})));try{await async function(t,e,i,n){try{return await t.requestPromise("/organizations/".concat(e,"/incidents/").concat(i,"/comments/").concat(n,"/"),{method:"DELETE"})}catch(t){throw(0,r.Iw)((0,s.t)("Failed to delete comment")),t}}(e,a,n,t.id)}catch(t){this.setState((t=>({activities:(0,B.m)(t.activities,o,l)})))}})),(0,n.Z)(this,"handleUpdateNote",(async(t,e)=>{const{api:i,params:n}=this.props,{alertId:a,orgId:o}=n,[l,d]=this.getIndexAndActivityFromState(e);this.setState((e=>({activities:(0,B.m)(e.activities,l,{...d,comment:t.text})})));try{await async function(t,e,i,n,a){try{const o=await t.requestPromise("/organizations/".concat(e,"/incidents/").concat(i,"/comments/").concat(n,"/"),{method:"PUT",data:{mentions:a.mentions,comment:a.text}});return(0,r.B8)(),o}catch(t){throw(0,r.Iw)((0,s.t)("Unable to update comment")),t}}(i,o,a,e.id,t)}catch(t){this.setState((t=>({activities:(0,B.m)(t.activities,l,d)})))}}))}componentDidMount(){this.fetchData()}componentDidUpdate(t){null!==t.incidentStatus&&t.incidentStatus!==this.props.incidentStatus&&this.fetchData()}async fetchData(){const{api:t,params:e}=this.props,{alertId:i,orgId:n}=e;try{const e=await async function(t,e,i){return t.requestPromise("/organizations/".concat(e,"/incidents/").concat(i,"/activity/"))}(t,n,i);this.setState({activities:e,loading:!1})}catch(t){this.setState({loading:!1,error:!!t})}}render(){const{api:t,params:e,incident:i,...n}=this.props,{alertId:a}=e,o=k.Z.get("user");return(0,K.tZ)(it,{alertId:a,me:o,api:t,...this.state,loading:this.state.loading||!i,incident:i,onCreateNote:this.handleCreateNote,onUpdateNote:this.handleUpdateNote,onDeleteNote:this.handleDeleteNote,...n})}}at.displayName="ActivityContainer";const ot=(0,p.Z)(at);function rt(t,e){const i=[...t];return i.splice(e,1),i}var st=i("./app/components/charts/components/markLine.tsx"),lt=i("./app/components/charts/components/markPoint.tsx"),dt=i("./app/components/charts/lineChart.tsx");function ct(t){return!!t}function pt(t,e){const i=t.findIndex((([t])=>t>e));return 0===i?0:-1!==i?i-1:t.length-1}const ut=t=>{const{aggregate:e,data:i,started:n,closed:a,triggers:o,resolveThreshold:r}=t,l=n&&M().utc(n).unix(),d=a&&M().utc(a).unix(),c=i.map((([t,e])=>[1e3*t,e.length?e.reduce(((t,{count:e}={count:0})=>t+e),0):0])),p=l?c[pt(i,l)]:void 0,u=!!(i&&d&&i[i.length-1]&&i[i.length-1][0]>=d),m=d&&u?c[pt(i,d)]:void 0,h=e,g=null==o?void 0:o.find((t=>"warning"===t.label)),v=null==o?void 0:o.find((t=>"critical"===t.label)),Z="number"==typeof(null==g?void 0:g.alertThreshold)?null==g?void 0:g.alertThreshold:void 0,x="number"==typeof(null==v?void 0:v.alertThreshold)?null==v?void 0:v.alertThreshold:void 0,y="number"==typeof r?r:void 0,b=Math.max(...[Z,x,y].map((t=>{if(!t||!isFinite(t))return 0;let e=1,i=0;for(;Math.round(t*e)/e!==t;)e*=10,i+=1;return i}))),w=[{seriesName:h,dataArray:c,data:[],markPoint:(0,lt.Z)({data:[{labelForValue:h,seriesName:h,symbol:"image://".concat("data:image/png;base64,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"),name:(0,s.t)("Alert Triggered"),coord:p},...d?[{labelForValue:h,seriesName:h,symbol:"image://".concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGEAAABgCAMAAAA6hOw0AAABKVBMVEUAAABOsYlOxIlSuI9cwo9aupFawYpawZFRvI1XvYpXvY9Vuo5ZvopZvo5VvotVvo9YvotYvo9XvIpXv41Wwo1ZwpBVv49Yv4xYv41Xv4tXv45av4tXwYxWvItWv41Yv45YwYtXvYxXv4xXv49YvYtWv41Yv41WvoxYvoxYwIxWv45Zv4xZv45Yvo5YwI5Xv41Yvo9YwI1VvoxXvIxXvoxWvo1YvYxYv4xXvoxXwIxZvoxZwIxZwI5WvYtWv41XvoxXvo1ZvoxXv41WvYxWv4xYvYxYv4xWvY1Yvo1YwI5XvoxYvoxWv41Yv41Zv41XvoxYvo5YwI5XvY1Xvo1Xv41Xvo1Yvo1Wvo1Yvo1YwI1Xvo1Yvo1YwI5Xvo1Yvo1Yv41Xvo1Zvo1Yvo2junXyAAAAY3RSTlMADQ0ZGSUlJSYyMj8/P0tLS0tMTFNTVFRXWFhYW1xcY2NkZGRla2txcXFzc3N6ent9fX5+foKDg4qKioqKi4uSkpKTl5eXl5qamqKio6OjpKmpqqqvsLCxsbG5ubm8vLzBwckgUECPAAADb0lEQVR4AdXXBYLjOgwGYKfDDBpmpi7vMGPeMqeMuv8dlqG/67aOrUffAaLql+ykylLQOby9+zZV5K+KqTDcnuoJlJigf/stG7zdHW6TePzUHTcRTnkW6TkscivhsHI2csdWIscaAxEj4Ro9+PvFawRbHNtuW5wGMCD5NrbY0W5gl9AdO4tskmqL2EO5V7XSUWSzzF8Hyfl5+mpieePg8h03MOtUoHK5MUG6jcscm6zFL/BugxpYflYxl4hToHI8QU0sPDQ0MhpnyJcT1MLCMdfptS6Q3iALC89YU26wtIesOSZLDyuMokAZrDHKbZC1BX0aT00Z6QktUAyTL1ofi0grMEHxHOujaJHRMwIOJcLmGaXJwVXTlX2MQ54gF7i1Eb5ysMACOZnEjVpRNUKutUOOFiow7KBRC2fk7KBRE0eQEXl4D03gImFGMjn1GhfpGQGvUxEaj/MCeZmEJgKYM7Qg1MS0IaRlIsEmwvqQPpC3i7qYurnGQ/K2wTUG1VdTOGd/ef5jF4+bSEgYU6SPYY8EbGiDCAQ3ybBNvXgaKiTiPZ6IERyD9CC2lFrhPy5JxAP+4wRP9B6JSPIfb/D1do9ELMC6QoUN+QplqQqIayj1if+Y/59WeP03p/S3zGESJg1X630SsYTbKn/i4HK9/VtujX2oADffx7/l5uv+229v+TcQ6R+Wn/7utyis60fpMbyp+5oZl/+awVHznnBIw+qbomxMz7hG+/cKmyx5Nc0xnLfvelmyiVM9JIzJv4m5vBbSdyuCTZzqIX3XzmJNzDGEZP7Dnh+XWqSU+g5n7XmHP9RbwCb8c5qrmlowNFGZIydjeb0FbMJ/FC8ZWwDtRa6VHXdcVGwBrDB45l1gV2mCFPt1cc0g1a50XYzyc7GG/JyNGYEZvcSi622EGeE+oXOydFBllEooAKOIn9TcR9aU2pVZe4p1z1rWGDuvsq5XNdJVZPsa8Hwwo1SsEvxsgxpYv6xyvVWl4pbg/LOdMdKMrV8WmO0KYIkUm2WfHWwsztNX8/M7Dy4/VtlsSJnBuD2UelVr7SE7S7UrK6vs6FFCWepNOSU0o+wFmxzbDSYkPvBUr4ptJEaN0ipOwL+G1/NB72OL/HuVl/aR26aPd/35INH3+BUbRE9GEkpMondq+/A2Kn2PPXp1uD3Va/n0Lz+J4DdmmdHlAAAAAElFTkSuQmCC"),symbolSize:24,name:(0,s.t)("Alert Resolved"),coord:m}]:[]]})},g&&Z&&{seriesName:"Warning Alert",type:"line",markLine:(0,st.Z)({silent:!0,lineStyle:{color:E.ZP.yellow300},data:[{yAxis:Z}],precision:b,label:{show:!0,position:"insideEndTop",formatter:"WARNING",color:E.ZP.yellow300,fontSize:10}}),data:[]},v&&x&&{seriesName:"Critical Alert",type:"line",markLine:(0,st.Z)({silent:!0,lineStyle:{color:E.ZP.red200},data:[{yAxis:x}],precision:b,label:{show:!0,position:"insideEndTop",formatter:"CRITICAL",color:E.ZP.red300,fontSize:10}}),data:[]},v&&y&&{seriesName:"Critical Resolve",type:"line",markLine:(0,st.Z)({silent:!0,lineStyle:{color:E.ZP.gray200},data:[{yAxis:y}],precision:b,label:{show:!0,position:"insideEndBottom",formatter:"CRITICAL RESOLUTION",color:E.ZP.gray200,fontSize:10}}),data:[]}].filter(ct);return(0,K.tZ)(dt.Z,{isGroupedByDate:!0,showTimeInTooltip:!0,grid:{left:0,right:0,top:(0,N.Z)(2),bottom:0},series:w})};ut.displayName="Chart";const mt=ut;class ht extends a.Component{get metricPreset(){const{incident:t}=this.props;return t?(0,m.Un)(t):void 0}getThresholdText(t,e,i=!1){if(!(0,X.ri)(t))return"";const n=e===z.lT.ABOVE;return"".concat(n===i?">":"<"," ").concat(t)}renderRuleDetails(){var t,e,i,n,a,o,r,l,d,c;const{incident:p}=this.props;if(void 0===p)return(0,K.tZ)(A.Z,{height:"200px"});const u=null==p?void 0:p.alertRule.triggers.find((({label:t})=>"critical"===t)),h=null==p?void 0:p.alertRule.triggers.find((({label:t})=>"warning"===t));return(0,K.BX)(b.v,{children:[(0,K.tZ)(b.G,{keyName:(0,s.t)("Data Source"),value:m.CM[null===(t=p.alertRule)||void 0===t?void 0:t.dataset]}),(0,K.tZ)(b.G,{keyName:(0,s.t)("Metric"),value:null===(e=p.alertRule)||void 0===e?void 0:e.aggregate}),(0,K.tZ)(b.G,{keyName:(0,s.t)("Time Window"),value:p&&(0,K.tZ)(y.Z,{seconds:60*p.alertRule.timeWindow})}),(null===(i=p.alertRule)||void 0===i?void 0:i.query)&&(0,K.tZ)(b.G,{keyName:(0,s.t)("Filter"),value:(0,K.tZ)("span",{title:null===(n=p.alertRule)||void 0===n?void 0:n.query,children:null===(a=p.alertRule)||void 0===a?void 0:a.query})}),(0,K.tZ)(b.G,{keyName:(0,s.t)("Critical Trigger"),value:this.getThresholdText(null==u?void 0:u.alertThreshold,null===(o=p.alertRule)||void 0===o?void 0:o.thresholdType,!0)}),(0,X.ri)(h)&&(0,K.tZ)(b.G,{keyName:(0,s.t)("Warning Trigger"),value:this.getThresholdText(null==h?void 0:h.alertThreshold,null===(r=p.alertRule)||void 0===r?void 0:r.thresholdType,!0)}),(0,X.ri)(null===(l=p.alertRule)||void 0===l?void 0:l.resolveThreshold)&&(0,K.tZ)(b.G,{keyName:(0,s.t)("Resolution"),value:this.getThresholdText(null===(d=p.alertRule)||void 0===d?void 0:d.resolveThreshold,null===(c=p.alertRule)||void 0===c?void 0:c.thresholdType)})]})}renderChartHeader(){var t,e,i,n,a;const{incident:o}=this.props,r=null==o?void 0:o.alertRule;return(0,K.tZ)(St,{children:(0,K.BX)("div",{children:[null!==(t=null===(e=this.metricPreset)||void 0===e?void 0:e.name)&&void 0!==t?t:(0,s.t)("Custom metric"),(0,K.BX)(Tt,{children:[(0,s._N)("Metric: [metric] over [window]",{metric:(0,K.tZ)("code",{children:null!==(i=null==r?void 0:r.aggregate)&&void 0!==i?i:"…"}),window:(0,K.tZ)("code",{children:o?(0,K.tZ)(y.Z,{seconds:60*o.alertRule.timeWindow}):"…"})}),((null==r?void 0:r.query)||(null==o||null===(n=o.alertRule)||void 0===n?void 0:n.dataset))&&(0,s._N)("Filter: [datasetType] [filter]",{datasetType:(null==o||null===(a=o.alertRule)||void 0===a?void 0:a.dataset)&&(0,K.tZ)("code",{children:Y.hh[o.alertRule.dataset]}),filter:(null==r?void 0:r.query)&&(0,K.tZ)("code",{children:r.query})})]})]})})}renderChartActions(){const{incident:t,params:e,stats:i}=this.props;return(0,K.tZ)(g.Z,{features:["discover-basic"],children:(0,K.tZ)(At,{children:(0,K.tZ)(R.Z,{slugs:null==t?void 0:t.projects,orgId:e.orgId,children:({initiallyLoaded:n,fetching:a,projects:o})=>{const r=this.metricPreset,s={orgSlug:e.orgId,projects:n?o:[],incident:t,stats:i},{buttonText:l,...d}=r?r.makeCtaParams(s):(0,j.x)(s);return(0,K.tZ)(Z.ZP,{size:"small",priority:"primary",disabled:!t||a||!n,...d,children:l})}})})})}render(){var t,e;const{params:i,incident:n,organization:a,stats:o}=this.props,r=(null==n?void 0:n.alertRule)&&!(0,m.Gm)(null==n?void 0:n.alertRule)&&a.features.includes("alert-details-redesign"),l=r&&n?ae(a,n):"/organizations/".concat(i.orgId,"/alerts/metric-rules/").concat(null==n?void 0:n.projects[0],"/").concat(null==n||null===(t=n.alertRule)||void 0===t?void 0:t.id,"/");return(0,K.tZ)(wt,{children:(0,K.BX)(gt,{children:[n&&n.status===u.vt.CLOSED&&n.statusMethod===u.Xn.RULE_UPDATED&&(0,K.tZ)(Ct,{children:(0,K.tZ)(v.Z,{type:"warning",icon:(0,K.tZ)(C.FC,{size:"sm"}),children:(0,s.t)("This alert has been auto-resolved because the rule that triggered it has been modified or deleted")})}),(0,K.tZ)(I.JH,{children:(0,K.BX)(ft,{children:[(0,K.BX)(S.N,{withPadding:!0,children:[this.renderChartHeader(),n&&o?(0,K.tZ)(mt,{triggers:n.alertRule.triggers,resolveThreshold:n.alertRule.resolveThreshold,aggregate:n.alertRule.aggregate,data:o.eventStats.data,started:n.dateStarted,closed:n.dateClosed||void 0}):(0,K.tZ)(A.Z,{height:"200px"})]}),this.renderChartActions()]})}),(0,K.BX)(vt,{children:[(0,K.BX)(Zt,{children:[(0,K.BX)(It,{underlined:!0,children:[(0,K.tZ)("li",{className:"active",children:(0,K.tZ)(w.Z,{to:"",children:(0,s.t)("Activity")})}),(0,K.tZ)(Nt,{children:n&&(0,K.tZ)(Xt,{iconPosition:"right",seenBy:n.seenBy,iconTooltip:(0,s.t)("People who have viewed this alert")})})]}),(0,K.tZ)(ot,{incident:n,params:i,incidentStatus:n?n.status:null})]}),(0,K.BX)(xt,{children:[(0,K.BX)(yt,{children:[(0,K.tZ)("span",{children:(0,s.t)("Alert Rule")}),((null==n||null===(e=n.alertRule)||void 0===e?void 0:e.status)!==u.Gb.SNAPSHOT||r)&&(0,K.tZ)(bt,{disabled:!(null==n||!n.id),to:null!=n&&n.id?{pathname:l}:"",children:(0,s.t)("View Alert Rule")})]}),this.renderRuleDetails()]})]})]})})}}ht.displayName="DetailsBody";const gt=(0,h.Z)("div",{target:"e16qwadz14"})("background-color:",(t=>t.theme.background),";padding-top:",(0,N.Z)(3),";flex-grow:1;"),vt=(0,h.Z)("div",{target:"e16qwadz13"})("display:flex;flex:1;@media (max-width: ",(t=>t.theme.breakpoints[0]),"){flex-direction:column-reverse;}"),Zt=(0,h.Z)(I.JH,{target:"e16qwadz12"})("@media (max-width: ",E.ZP.breakpoints[0],"){width:100%;margin-bottom:0;}"),xt=(0,h.Z)(I.JH,{target:"e16qwadz11"})("width:400px;flex:none;padding-top:",(0,N.Z)(3),";@media (max-width: ",E.ZP.breakpoints[0],"){width:100%;padding-top:",(0,N.Z)(3),";margin-bottom:0;border-bottom:1px solid ",(t=>t.theme.border),";}"),yt=(0,h.Z)(x.OT,{target:"e16qwadz10"})({name:"1eoy87d",styles:"display:flex;justify-content:space-between"}),bt=(0,h.Z)(w.Z,{target:"e16qwadz9"})({name:"lugakg",styles:"font-weight:normal"}),wt=(0,h.Z)(I.JH,{target:"e16qwadz8"})({name:"1fg8e69",styles:"padding:0;flex-direction:column"}),ft=(0,h.Z)(S.s_,{target:"e16qwadz7"})(""),St=(0,h.Z)("header",{target:"e16qwadz6"})("margin-bottom:",(0,N.Z)(1),";"),At=(0,h.Z)(S.jH,{target:"e16qwadz5"})("display:flex;justify-content:flex-end;padding:",(0,N.Z)(2),";"),Tt=(0,h.Z)("div",{target:"e16qwadz4"})("color:",(t=>t.theme.subText),";font-size:",(t=>t.theme.fontSizeMedium),";display:grid;grid-auto-flow:column;grid-auto-columns:max-content;grid-gap:",(0,N.Z)(4),";align-items:center;overflow-x:auto;>*{position:relative;}>*:not(:last-of-type):after{content:'';display:block;height:70%;width:1px;background:",(t=>t.theme.gray200),";position:absolute;right:-",(0,N.Z)(2),";top:15%;}"),Ct=(0,h.Z)("div",{target:"e16qwadz3"})("padding:",(0,N.Z)(2)," ",(0,N.Z)(4)," 0;"),It=(0,h.Z)(f.Z,{target:"e16qwadz2"})({name:"zjik7",styles:"display:flex"}),Nt=(0,h.Z)("li",{target:"e16qwadz1"})("flex:1;margin-left:",(0,N.Z)(2),";margin-right:0;.nav-tabs>&{margin-right:0;}"),Xt=(0,h.Z)(T.Z,{target:"e16qwadz0"})({name:"1i9vogi",styles:"margin-top:0"});var Rt=i("../node_modules/@emotion/is-prop-valid/dist/is-prop-valid.browser.esm.js"),Et=i("./app/components/breadcrumbs.tsx"),Yt=i("./app/components/count.tsx"),jt=i("./app/components/dropdownControl.tsx"),zt=i("./app/components/idBadge/projectBadge.tsx"),Pt=i("./app/components/menuItem.tsx"),kt=i("./app/components/pageHeading.tsx");class Dt extends a.Component{render(){const{size:t,isSubscribed:e,onClick:i,disabled:n}=this.props,a=(0,K.tZ)(C.YK,{color:e?"blue300":void 0});return(0,K.tZ)(Z.ZP,{size:t,icon:a,onClick:i,disabled:n,children:e?(0,s.t)("Unsubscribe"):(0,s.t)("Subscribe")})}}Dt.displayName="SubscribeButton";var Bt=i("./app/utils/dates.tsx"),qt=i("./app/utils/getDynamicText.tsx");const Lt=({className:t,incident:e,disableIconColor:i})=>{const{status:n}=e,a=n===u.vt.CLOSED,o=n===u.vt.WARNING,r=a?(0,K.tZ)(C.DL,{color:i?void 0:"green300"}):o?(0,K.tZ)(C.FC,{color:i?void 0:"orange400"}):(0,K.tZ)(C.zC,{color:i?void 0:"red300"}),l=a?(0,s.t)("Resolved"):o?(0,s.t)("Warning"):(0,s.t)("Critical");return(0,K.BX)(Mt,{className:t,children:[(0,K.tZ)(Wt,{children:r}),l]})};Lt.displayName="Status";const Ut=Lt,Mt=(0,h.Z)("div",{target:"e10zt0uu1"})("display:grid;grid-auto-flow:column;align-items:center;grid-template-columns:auto 1fr;grid-gap:",(0,N.Z)(.75),";"),Wt=(0,h.Z)("span",{target:"e10zt0uu0"})({name:"1460tvi",styles:"margin-bottom:-3px"});class Ot extends a.Component{renderStatus(){const{incident:t,onStatusChange:e}=this.props,i=t&&(0,m.FJ)(t),n=t?(0,K.tZ)(ie,{incident:t}):null;return(0,K.BX)(jt.ZP,{"data-test-id":"status-dropdown",label:n,alignRight:!0,blendWithActor:!1,buttonProps:{size:"small",disabled:!t||!i,hideBottomBorder:!1},children:[(0,K.tZ)(ne,{isActive:!0,children:t&&(0,K.tZ)(Ut,{disableIconColor:!0,incident:t})}),(0,K.BX)(ne,{onSelect:e,children:[(0,K.tZ)(C.DL,{color:"green300"}),(0,s.t)("Resolved")]})]})}render(){var t,e,i;const{hasIncidentDetailsError:n,incident:a,params:o,stats:r,onSubscriptionChange:l}=this.props,d=!!a&&!n,c=(0,Bt.eX)()?"ddd, MMM D, YYYY HH:mm":"llll",p=a&&M()(new Date(a.dateStarted)).format(c),u=a&&M()(a.dateClosed?new Date(a.dateClosed):new Date).diff(M()(new Date(a.dateStarted)),"seconds"),m=(null==a||null===(t=a.alertRule)||void 0===t?void 0:t.dataset)===z.qz.ERRORS,h=null!==(e=null==a||null===(i=a.alertRule)||void 0===i?void 0:i.environment)&&void 0!==e?e:(0,s.t)("All Environments"),g=a&&a.projects&&a.projects[0];return(0,K.BX)(Ft,{children:[(0,K.BX)(Gt,{children:[(0,K.tZ)(Vt,{crumbs:[{label:(0,s.t)("Alerts"),to:"/organizations/".concat(o.orgId,"/alerts/")},{label:a&&"#".concat(a.id)}]}),(0,K.BX)(Ht,{children:[(0,K.tZ)(Dt,{disabled:!d,isSubscribed:null==a?void 0:a.isSubscribed,onClick:l,size:"small"}),this.renderStatus()]})]}),(0,K.BX)(Jt,{columns:m?5:3,children:[(0,K.BX)("div",{children:[(0,K.tZ)(te,{"data-test-id":"incident-title",loading:!d,children:a&&!n?a.title:"Loading"}),(0,K.BX)(ee,{loading:!d,children:[(0,s.t)("Triggered: "),p]})]}),n?(0,K.tZ)(Kt,{}):(0,K.BX)(Qt,{columns:m?5:3,children:[(0,K.tZ)(_t,{children:(0,s.t)("Environment")}),(0,K.tZ)(_t,{children:(0,s.t)("Project")}),m&&(0,K.tZ)(_t,{children:(0,s.t)("Users affected")}),m&&(0,K.tZ)(_t,{children:(0,s.t)("Total events")}),(0,K.tZ)(_t,{children:(0,s.t)("Active For")}),(0,K.tZ)($t,{children:h}),(0,K.tZ)($t,{children:g?(0,K.tZ)(R.Z,{slugs:[g],orgId:o.orgId,children:({projects:t})=>(null==t?void 0:t.length)&&(0,K.tZ)(zt.Z,{avatarSize:18,project:t[0]})}):(0,K.tZ)(A.Z,{height:"25px"})}),m&&(0,K.tZ)($t,{children:r?(0,K.tZ)(Yt.Z,{value:r.uniqueUsers}):(0,K.tZ)(A.Z,{height:"25px"})}),m&&(0,K.tZ)($t,{children:r?(0,K.tZ)(Yt.Z,{value:r.totalEvents}):(0,K.tZ)(A.Z,{height:"25px"})}),(0,K.tZ)($t,{children:a?(0,K.tZ)(y.Z,{seconds:(0,qt.Z)({value:u||0,fixed:1200})}):(0,K.tZ)(A.Z,{height:"25px"})})]})]})]})}}Ot.displayName="DetailsHeader";const Ft=(0,h.Z)("div",{target:"eo42ux812"})("background-color:",(t=>t.theme.backgroundSecondary),";border-bottom:1px solid ",(t=>t.theme.border),";"),Gt=(0,h.Z)("div",{target:"eo42ux811"})("display:flex;margin-bottom:0;padding:",(0,N.Z)(2)," ",(0,N.Z)(4)," ",(0,N.Z)(1),";"),Vt=(0,h.Z)(Et.Z,{target:"eo42ux810"})("flex-grow:1;font-size:",(t=>t.theme.fontSizeExtraLarge),";padding:0;"),Ht=(0,h.Z)("div",{target:"eo42ux89"})("display:grid;grid-auto-flow:column;grid-gap:",(0,N.Z)(1),";"),Jt=(0,h.Z)(I.mr,{shouldForwardProp:t=>"string"==typeof t&&(0,Rt.Z)(t)&&"columns"!==t,target:"eo42ux88"})("margin-bottom:0;padding:",(0,N.Z)(1.5)," ",(0,N.Z)(4)," ",(0,N.Z)(2),";grid-template-columns:max-content auto;display:grid;grid-gap:",(0,N.Z)(3),";grid-auto-flow:column;@media (max-width: ",(t=>t.theme.breakpoints[3===t.columns?1:2]),"){grid-template-columns:auto;grid-auto-flow:row;}"),Kt=(0,h.Z)(V.Z,{target:"eo42ux87"})({name:"16afy4q",styles:"flex:1;&.alert.alert-block{margin:0 20px;}"}),Qt=(0,h.Z)("div",{shouldForwardProp:t=>"string"==typeof t&&(0,Rt.Z)(t)&&"columns"!==t,target:"eo42ux86"})("display:grid;grid-template-columns:repeat(",(t=>t.columns),", max-content);grid-gap:",(0,N.Z)(1)," ",(0,N.Z)(4),";text-align:right;margin-top:",(0,N.Z)(1),";@media (max-width: ",(t=>t.theme.breakpoints[3===t.columns?1:2]),"){text-align:left;}"),_t=(0,h.Z)("h6",{target:"eo42ux85"})("font-size:",(t=>t.theme.fontSizeSmall),";margin-bottom:0;text-transform:uppercase;color:",(t=>t.theme.gray300),";letter-spacing:0.1px;"),$t=(0,h.Z)("div",{target:"eo42ux84"})("display:flex;justify-content:flex-end;align-items:center;font-size:",(t=>t.theme.fontSizeExtraLarge),";"),te=(0,h.Z)(kt.Z,{shouldForwardProp:t=>"string"==typeof t&&(0,Rt.Z)(t)&&"loading"!==t,target:"eo42ux83"})((t=>t.loading&&"opacity: 0"),";line-height:1.5;"),ee=(0,h.Z)("div",{shouldForwardProp:t=>"string"==typeof t&&(0,Rt.Z)(t)&&"loading"!==t,target:"eo42ux82"})((t=>t.loading&&"opacity: 0"),";font-size:",(t=>t.theme.fontSizeLarge),";color:",(t=>t.theme.gray300),";"),ie=(0,h.Z)(Ut,{target:"eo42ux81"})("margin-right:",(0,N.Z)(2),";"),ne=(0,h.Z)(Pt.Z,{target:"eo42ux80"})(">span{padding:",(0,N.Z)(1)," ",(0,N.Z)(1.5),";font-size:",(t=>t.theme.fontSizeSmall),";font-weight:600;line-height:1;text-align:left;display:grid;grid-template-columns:max-content 1fr;grid-gap:",(0,N.Z)(.75),";align-items:center;}"),ae=(t,e)=>"/organizations/".concat(t.slug,"/alerts/rules/details/").concat((null==e?void 0:e.alertRule.status)===u.Gb.SNAPSHOT&&null!=e&&e.alertRule.originalAlertRuleId?null==e?void 0:e.alertRule.originalAlertRuleId:null==e?void 0:e.alertRule.id,"/");class oe extends a.Component{constructor(...t){super(...t),(0,n.Z)(this,"state",{isLoading:!1,hasError:!1}),(0,n.Z)(this,"fetchData",(async()=>{this.setState({isLoading:!0,hasError:!1});const{api:t,location:e,organization:i,params:{orgId:n,alertId:a}}=this.props;try{const r=(0,m.yN)(t,n,a).then((a=>{const r=a.alertRule&&this.props.organization.features.includes("alert-details-redesign"),s=e&&e.query&&"false"===e.query.redirect;r&&!s&&o.browserHistory.replace({pathname:ae(i,a),query:{alert:a.identifier}}),this.setState({incident:a}),async function(t,e,i){if(i&&!i.hasSeen)try{await t.requestPromise("/organizations/".concat(e,"/incidents/").concat(i.identifier,"/seen/"),{method:"POST",data:{hasSeen:!0}})}catch(t){}}(t,n,a)})),s=(0,m.KL)(t,n,a).then((t=>this.setState({stats:t})));await Promise.all([r,s]),this.setState({isLoading:!1,hasError:!1})}catch(t){this.setState({isLoading:!1,hasError:!0})}})),(0,n.Z)(this,"handleSubscriptionChange",(async()=>{const{api:t,params:{orgId:e,alertId:i}}=this.props;if(!this.state.incident)return;const n=this.state.incident.isSubscribed,a=!n;this.setState((t=>({incident:{...t.incident,isSubscribed:a}})));try{(0,m.Mg)(t,e,i,a)}catch(t){this.setState((t=>({incident:{...t.incident,isSubscribed:n}}))),(0,r.Iw)((0,s.t)("An error occurred, your subscription status was not changed."))}})),(0,n.Z)(this,"handleStatusChange",(async()=>{const{api:t,params:{orgId:e,alertId:i}}=this.props;if(!this.state.incident)return;const{status:n}=this.state.incident,a=(0,m.FJ)(this.state.incident)?u.vt.CLOSED:n;this.setState((t=>({incident:{...t.incident,status:a}})));try{const n=await(0,m.Nf)(t,e,i,a);this.setState({incident:n})}catch(t){this.setState((t=>({incident:{...t.incident,status:n}}))),(0,r.Iw)((0,s.t)("An error occurred, your incident status was not changed."))}}))}componentDidMount(){const{api:t,organization:e,params:i}=this.props;(0,c.ec)({eventKey:"alert_details.viewed",eventName:"Alert Details: Viewed",organization_id:parseInt(e.id,10),alert_id:parseInt(i.alertId,10)}),(0,l.MA)(t,i.orgId),this.fetchData()}render(){var t;const{incident:e,stats:i,hasError:n}=this.state,{params:o,organization:r}=this.props,{alertId:l}=o,c=null==e||null===(t=e.projects)||void 0===t?void 0:t[0];return(0,K.BX)(a.Fragment,{children:[(0,K.tZ)(d.Z,{title:(0,s.t)("Alert %s",l),orgSlug:r.slug,projectSlug:c}),(0,K.tZ)(Ot,{hasIncidentDetailsError:n,params:o,incident:e,stats:i,onSubscriptionChange:this.handleSubscriptionChange,onStatusChange:this.handleStatusChange}),(0,K.tZ)(ht,{...this.props,incident:e,stats:i})]})}}oe.displayName="IncidentDetails";const re=(0,p.Z)(oe)}}]);
//# sourceMappingURL=../sourcemaps/app_views_alerts_details_index_tsx.48e27d79eb6ad95d169f83e3087cb92d.js.map