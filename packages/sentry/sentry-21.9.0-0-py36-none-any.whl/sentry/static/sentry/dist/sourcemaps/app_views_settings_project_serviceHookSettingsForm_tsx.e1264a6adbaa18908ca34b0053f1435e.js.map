{"version":3,"file":"chunks/app_views_settings_project_serviceHookSettingsForm_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/switchButton.tsx","webpack:///./app/views/settings/components/forms/apiForm.tsx","webpack:///./app/views/settings/components/forms/booleanField.tsx","webpack:///./app/views/settings/components/forms/controls/multipleCheckbox.tsx","webpack:///./app/views/settings/components/forms/textField.tsx","webpack:///./app/views/settings/project/serviceHookSettingsForm.tsx"],"sourcesContent":["import * as React from 'react';\nimport styled from '@emotion/styled';\n\ntype Props = {\n  forwardRef?: React.Ref<HTMLButtonElement>;\n  className?: string;\n  id?: string;\n  name?: string;\n  size?: 'sm' | 'lg';\n  isActive?: boolean;\n  /**\n   * Toggle color is always active.\n   */\n  forceActiveColor?: boolean;\n  isLoading?: boolean;\n  isDisabled?: boolean;\n  toggle: React.HTMLProps<HTMLButtonElement>['onClick'];\n};\n\nconst Switch = ({\n  forwardRef,\n  size = 'sm',\n  isActive,\n  forceActiveColor,\n  isLoading,\n  isDisabled,\n  toggle,\n  id,\n  name,\n  className,\n}: Props) => (\n  <SwitchButton\n    ref={forwardRef}\n    id={id}\n    name={name}\n    type=\"button\"\n    className={className}\n    onClick={isDisabled ? undefined : toggle}\n    role=\"checkbox\"\n    aria-checked={isActive}\n    isLoading={isLoading}\n    isDisabled={isDisabled}\n    isActive={isActive}\n    size={size}\n    data-test-id=\"switch\"\n  >\n    <Toggle\n      isDisabled={isDisabled}\n      isActive={isActive}\n      forceActiveColor={forceActiveColor}\n      size={size}\n    />\n  </SwitchButton>\n);\n\ntype StyleProps = Partial<Props>;\n\nconst getSize = (p: StyleProps) => (p.size === 'sm' ? 16 : 24);\nconst getToggleSize = (p: StyleProps) => getSize(p) - (p.size === 'sm' ? 6 : 10);\nconst getToggleTop = (p: StyleProps) => (p.size === 'sm' ? 2 : 4);\nconst getTranslateX = (p: StyleProps) =>\n  p.isActive ? getToggleTop(p) + getSize(p) : getToggleTop(p);\n\nconst SwitchButton = styled('button')<StyleProps>`\n  display: inline-block;\n  background: none;\n  padding: 0;\n  border: 1px solid ${p => p.theme.border};\n  position: relative;\n  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.04);\n  transition: 0.15s border ease;\n  cursor: ${p => (p.isLoading || p.isDisabled ? 'not-allowed' : 'pointer')};\n  pointer-events: ${p => (p.isLoading || p.isDisabled ? 'none' : null)};\n  height: ${getSize}px;\n  width: ${p => getSize(p) * 2}px;\n  border-radius: ${getSize}px;\n\n  &:hover,\n  &:focus {\n    outline: none;\n    border-color: ${p => p.theme.border};\n  }\n\n  &:focus,\n  &.focus-visible {\n    outline: none;\n    box-shadow: rgba(209, 202, 216, 0.5) 0 0 0 3px;\n  }\n`;\n\nconst Toggle = styled('span')<StyleProps>`\n  display: block;\n  position: absolute;\n  border-radius: 50%;\n  transition: 0.25s all ease;\n  top: ${getToggleTop}px;\n  transform: translateX(${getTranslateX}px);\n  width: ${getToggleSize}px;\n  height: ${getToggleSize}px;\n  background: ${p =>\n    p.isActive || p.forceActiveColor ? p.theme.active : p.theme.border};\n  opacity: ${p => (p.isDisabled ? 0.4 : null)};\n`;\n\nexport default React.forwardRef<HTMLButtonElement, Props>((props, ref) => (\n  <Switch {...props} forwardRef={ref} />\n));\n","import {Component} from 'react';\n\nimport {addLoadingMessage, clearIndicators} from 'app/actionCreators/indicator';\nimport {Client} from 'app/api';\nimport {t} from 'app/locale';\nimport Form from 'app/views/settings/components/forms/form';\n\ntype Props = Form['props'] & {\n  onSubmit?: (data: Record<string, any>) => void;\n  apiMethod: string;\n  apiEndpoint: string;\n};\n\nexport default class ApiForm extends Component<Props> {\n  componentWillUnmount() {\n    this.api.clear();\n  }\n\n  api: Client = new Client();\n\n  onSubmit = (\n    data: Record<string, any>,\n    onSuccess: (response: Record<string, any>) => void,\n    onError: (error: any) => void\n  ) => {\n    this.props.onSubmit && this.props.onSubmit(data);\n    addLoadingMessage(t('Saving changes\\u2026'));\n    this.api.request(this.props.apiEndpoint, {\n      method: this.props.apiMethod,\n      data,\n      success: response => {\n        clearIndicators();\n        onSuccess(response);\n      },\n      error: error => {\n        clearIndicators();\n        onError(error);\n      },\n    });\n  };\n\n  render() {\n    const {\n      onSubmit: _onSubmit,\n      apiMethod: _apiMethod,\n      apiEndpoint: _apiEndpoint,\n      ...otherProps\n    } = this.props;\n\n    return <Form onSubmit={this.onSubmit} {...otherProps} />;\n  }\n}\n","import * as React from 'react';\n\nimport Confirm from 'app/components/confirm';\nimport Switch from 'app/components/switchButton';\nimport InputField, {onEvent} from 'app/views/settings/components/forms/inputField';\n\ntype Props = {\n  confirm?: {\n    true?: React.ReactNode;\n    false?: React.ReactNode;\n  };\n} & InputField['props'];\n\nexport default class BooleanField extends React.Component<Props> {\n  coerceValue(value: any) {\n    return !!value;\n  }\n\n  handleChange = (\n    value: any,\n    onChange: onEvent,\n    onBlur: onEvent,\n    e: React.FormEvent<HTMLInputElement>\n  ) => {\n    // We need to toggle current value because Switch is not an input\n    const newValue = this.coerceValue(!value);\n    onChange(newValue, e);\n    onBlur(newValue, e);\n  };\n\n  render() {\n    const {confirm, ...fieldProps} = this.props;\n\n    return (\n      <InputField\n        {...fieldProps}\n        resetOnError\n        field={({\n          onChange,\n          onBlur,\n          value,\n          disabled,\n          ...props\n        }: {\n          onChange: onEvent;\n          onBlur: onEvent;\n          value: any;\n          disabled: boolean;\n        }) => {\n          // Create a function with required args bound\n          const handleChange = this.handleChange.bind(this, value, onChange, onBlur);\n\n          const switchProps = {\n            ...props,\n            size: 'lg' as React.ComponentProps<typeof Switch>['size'],\n            isActive: !!value,\n            isDisabled: disabled,\n            toggle: handleChange,\n          };\n\n          if (confirm) {\n            return (\n              <Confirm\n                renderMessage={() => confirm[(!value).toString()]}\n                onConfirm={() => handleChange({})}\n              >\n                {({open}) => (\n                  <Switch\n                    {...switchProps}\n                    toggle={(e: React.MouseEvent) => {\n                      // If we have a `confirm` prop and enabling switch\n                      // Then show confirm dialog, otherwise propagate change as normal\n                      if (confirm[(!value).toString()]) {\n                        // Open confirm modal\n                        open();\n                        return;\n                      }\n\n                      handleChange(e);\n                    }}\n                  />\n                )}\n              </Confirm>\n            );\n          }\n\n          return <Switch {...switchProps} />;\n        }}\n      />\n    );\n  }\n}\n","import * as React from 'react';\nimport styled from '@emotion/styled';\n\nimport {Choices} from 'app/types';\nimport {defined} from 'app/utils';\n\nconst MultipleCheckboxWrapper = styled('div')`\n  display: flex;\n  flex-wrap: wrap;\n`;\n\nconst Label = styled('label')`\n  font-weight: normal;\n  white-space: nowrap;\n  margin-right: 10px;\n  margin-bottom: 10px;\n  width: 20%;\n`;\n\nconst CheckboxLabel = styled('span')`\n  margin-left: 3px;\n`;\n\ntype SelectedValue = (string | number)[];\n\ntype Props = {\n  value: (string | number)[];\n  choices: Choices;\n  onChange?: (value: SelectedValue, event: React.ChangeEvent<HTMLInputElement>) => void;\n  disabled?: boolean;\n};\n\nclass MultipleCheckbox extends React.Component<Props> {\n  onChange = (selectedValue: string | number, e: React.ChangeEvent<HTMLInputElement>) => {\n    const {value, onChange} = this.props;\n    let newValue: SelectedValue = [];\n\n    if (typeof onChange !== 'function') {\n      return;\n    }\n\n    if (e.target.checked) {\n      newValue = value ? [...value, selectedValue] : [value];\n    } else {\n      newValue = value.filter(v => v !== selectedValue);\n    }\n\n    onChange(newValue, e);\n  };\n\n  render() {\n    const {disabled, choices, value} = this.props;\n\n    return (\n      <MultipleCheckboxWrapper>\n        {choices.map(([choiceValue, choiceLabel]) => (\n          <LabelContainer key={choiceValue}>\n            <Label>\n              <input\n                type=\"checkbox\"\n                value={choiceValue}\n                onChange={this.onChange.bind(this, choiceValue)}\n                disabled={disabled}\n                checked={defined(value) && value.indexOf(choiceValue) !== -1}\n              />\n              <CheckboxLabel>{choiceLabel}</CheckboxLabel>\n            </Label>\n          </LabelContainer>\n        ))}\n      </MultipleCheckboxWrapper>\n    );\n  }\n}\n\nexport default MultipleCheckbox;\n\nconst LabelContainer = styled('div')`\n  width: 100%;\n\n  @media (min-width: ${p => p.theme.breakpoints[0]}) {\n    width: 50%;\n  }\n  @media (min-width: ${p => p.theme.breakpoints[1]}) {\n    width: 33.333%;\n  }\n  @media (min-width: ${p => p.theme.breakpoints[2]}) {\n    width: 25%;\n  }\n`;\n","import InputField from 'app/views/settings/components/forms/inputField';\n\ntype Props = InputField['props'];\n\nexport default function TextField(props: Omit<Props, 'type'>) {\n  return <InputField {...props} type=\"text\" />;\n}\n","import {Component} from 'react';\nimport {browserHistory} from 'react-router';\n\nimport {Panel, PanelBody, PanelHeader} from 'app/components/panels';\nimport {t} from 'app/locale';\nimport {Choices, ServiceHook} from 'app/types';\nimport ApiForm from 'app/views/settings/components/forms/apiForm';\nimport BooleanField from 'app/views/settings/components/forms/booleanField';\nimport MultipleCheckbox from 'app/views/settings/components/forms/controls/multipleCheckbox';\nimport FormField from 'app/views/settings/components/forms/formField';\nimport TextField from 'app/views/settings/components/forms/textField';\n\nconst EVENT_CHOICES: Choices = ['event.alert', 'event.created'].map(e => [e, e]);\n\ntype Props = {\n  orgId: string;\n  projectId: string;\n  initialData: Partial<ServiceHook> & {isActive: boolean};\n  hookId?: string;\n};\n\nexport default class ServiceHookSettingsForm extends Component<Props> {\n  onSubmitSuccess = () => {\n    const {orgId, projectId} = this.props;\n    browserHistory.push(`/settings/${orgId}/projects/${projectId}/hooks/`);\n  };\n\n  render() {\n    const {initialData, orgId, projectId, hookId} = this.props;\n\n    const endpoint = hookId\n      ? `/projects/${orgId}/${projectId}/hooks/${hookId}/`\n      : `/projects/${orgId}/${projectId}/hooks/`;\n\n    return (\n      <Panel>\n        <ApiForm\n          apiMethod={hookId ? 'PUT' : 'POST'}\n          apiEndpoint={endpoint}\n          initialData={initialData}\n          onSubmitSuccess={this.onSubmitSuccess}\n          footerStyle={{\n            marginTop: 0,\n            paddingRight: 20,\n          }}\n          submitLabel={hookId ? t('Save Changes') : t('Create Hook')}\n        >\n          <PanelHeader>{t('Hook Configuration')}</PanelHeader>\n          <PanelBody>\n            <BooleanField name=\"isActive\" label={t('Active')} />\n            <TextField\n              name=\"url\"\n              label={t('URL')}\n              required\n              help={t('The URL which will receive events.')}\n            />\n            <FormField\n              name=\"events\"\n              label={t('Events')}\n              inline={false}\n              help={t('The event types you wish to subscribe to.')}\n            >\n              {({value, onChange}) => (\n                <MultipleCheckbox\n                  onChange={onChange}\n                  value={value}\n                  choices={EVENT_CHOICES}\n                />\n              )}\n            </FormField>\n          </PanelBody>\n        </ApiForm>\n      </Panel>\n    );\n  }\n}\n"],"names":["Switch","forwardRef","size","isActive","forceActiveColor","isLoading","isDisabled","toggle","id","name","className","SwitchButton","ref","type","onClick","undefined","role","Toggle","getSize","p","getToggleSize","getToggleTop","getTranslateX","theme","border","active","React","props","ApiForm","Component","Client","data","onSuccess","onError","this","onSubmit","addLoadingMessage","t","api","request","apiEndpoint","method","apiMethod","success","response","clearIndicators","error","componentWillUnmount","clear","render","_onSubmit","_apiMethod","_apiEndpoint","otherProps","BooleanField","value","onChange","onBlur","e","newValue","coerceValue","confirm","fieldProps","resetOnError","field","disabled","handleChange","bind","switchProps","renderMessage","toString","onConfirm","open","MultipleCheckboxWrapper","Label","CheckboxLabel","MultipleCheckbox","selectedValue","target","checked","filter","v","choices","map","choiceValue","choiceLabel","LabelContainer","defined","indexOf","breakpoints","TextField","EVENT_CHOICES","ServiceHookSettingsForm","orgId","projectId","browserHistory","initialData","hookId","endpoint","onSubmitSuccess","footerStyle","marginTop","paddingRight","submitLabel","label","required","help","inline"],"sourceRoot":""}