{"version":3,"file":"chunks/app_views_alerts_list_row_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/views/alerts/list/row.tsx","webpack:///./app/views/alerts/rules/details/constants.tsx"],"sourcesContent":["import {Component, Fragment} from 'react';\nimport styled from '@emotion/styled';\nimport memoize from 'lodash/memoize';\nimport moment from 'moment';\n\nimport ActorAvatar from 'app/components/avatar/actorAvatar';\nimport Duration from 'app/components/duration';\nimport ErrorBoundary from 'app/components/errorBoundary';\nimport IdBadge from 'app/components/idBadge';\nimport Link from 'app/components/links/link';\nimport Tag from 'app/components/tag';\nimport TimeSince from 'app/components/timeSince';\nimport {t} from 'app/locale';\nimport TeamStore from 'app/stores/teamStore';\nimport overflowEllipsis from 'app/styles/overflowEllipsis';\nimport space from 'app/styles/space';\nimport {Actor, Organization, Project} from 'app/types';\nimport {getUtcDateString} from 'app/utils/dates';\nimport getDynamicText from 'app/utils/getDynamicText';\nimport {alertDetailsLink} from 'app/views/alerts/details';\n\nimport {\n  API_INTERVAL_POINTS_LIMIT,\n  API_INTERVAL_POINTS_MIN,\n} from '../rules/details/constants';\nimport {Incident, IncidentStatus} from '../types';\nimport {getIncidentMetricPreset, isIssueAlert} from '../utils';\n\n/**\n * Retrieve the start/end for showing the graph of the metric\n * Will show at least 150 and no more than 10,000 data points\n */\nexport const makeRuleDetailsQuery = (\n  incident: Incident\n): {start: string; end: string} => {\n  const {timeWindow} = incident.alertRule;\n  const timeWindowMillis = timeWindow * 60 * 1000;\n  const minRange = timeWindowMillis * API_INTERVAL_POINTS_MIN;\n  const maxRange = timeWindowMillis * API_INTERVAL_POINTS_LIMIT;\n  const now = moment.utc();\n  const startDate = moment.utc(incident.dateStarted);\n  // make a copy of now since we will modify endDate and use now for comparing\n  const endDate = incident.dateClosed ? moment.utc(incident.dateClosed) : moment(now);\n  const incidentRange = Math.max(endDate.diff(startDate), 3 * timeWindowMillis);\n  const range = Math.min(maxRange, Math.max(minRange, incidentRange));\n  const halfRange = moment.duration(range / 2);\n\n  return {\n    start: getUtcDateString(startDate.subtract(halfRange)),\n    end: getUtcDateString(moment.min(endDate.add(halfRange), now)),\n  };\n};\n\ntype Props = {\n  incident: Incident;\n  projects: Project[];\n  projectsLoaded: boolean;\n  orgId: string;\n  organization: Organization;\n};\n\nclass AlertListRow extends Component<Props> {\n  get metricPreset() {\n    const {incident} = this.props;\n    return incident ? getIncidentMetricPreset(incident) : undefined;\n  }\n\n  /**\n   * Memoized function to find a project from a list of projects\n   */\n  getProject = memoize((slug: string, projects: Project[]) =>\n    projects.find(project => project.slug === slug)\n  );\n\n  render() {\n    const {incident, orgId, projectsLoaded, projects, organization} = this.props;\n    const slug = incident.projects[0];\n    const started = moment(incident.dateStarted);\n    const duration = moment\n      .duration(moment(incident.dateClosed || new Date()).diff(started))\n      .as('seconds');\n\n    const hasRedesign =\n      !isIssueAlert(incident.alertRule) &&\n      organization.features.includes('alert-details-redesign');\n\n    const alertLink = hasRedesign\n      ? {\n          pathname: alertDetailsLink(organization, incident),\n          query: {alert: incident.identifier},\n        }\n      : {\n          pathname: `/organizations/${orgId}/alerts/${incident.identifier}/`,\n        };\n    const ownerId = incident.alertRule.owner?.split(':')[1];\n    let teamName = '';\n    if (ownerId) {\n      teamName = TeamStore.getById(ownerId)?.name ?? '';\n    }\n    const teamActor = ownerId\n      ? {type: 'team' as Actor['type'], id: ownerId, name: teamName}\n      : null;\n\n    return (\n      <ErrorBoundary>\n        <Title>\n          <Link to={alertLink}>{incident.title}</Link>\n        </Title>\n\n        <NoWrap>\n          {getDynamicText({\n            value: <TimeSince date={incident.dateStarted} extraShort />,\n            fixed: '1w ago',\n          })}\n        </NoWrap>\n        <NoWrap>\n          {incident.status === IncidentStatus.CLOSED ? (\n            <Duration seconds={getDynamicText({value: duration, fixed: 1200})} />\n          ) : (\n            <Tag type=\"warning\">{t('Still Active')}</Tag>\n          )}\n        </NoWrap>\n\n        <ProjectBadge\n          avatarSize={18}\n          project={!projectsLoaded ? {slug} : this.getProject(slug, projects)}\n        />\n        <div>#{incident.id}</div>\n\n        <FlexCenter>\n          {teamActor ? (\n            <Fragment>\n              <StyledActorAvatar actor={teamActor} size={24} hasTooltip={false} />{' '}\n              <TeamWrapper>{teamActor.name}</TeamWrapper>\n            </Fragment>\n          ) : (\n            '-'\n          )}\n        </FlexCenter>\n      </ErrorBoundary>\n    );\n  }\n}\n\nconst Title = styled('div')`\n  ${overflowEllipsis}\n  min-width: 130px;\n`;\n\nconst NoWrap = styled('div')`\n  white-space: nowrap;\n`;\n\nconst ProjectBadge = styled(IdBadge)`\n  flex-shrink: 0;\n`;\n\nconst FlexCenter = styled('div')`\n  ${overflowEllipsis}\n  display: flex;\n  align-items: center;\n`;\n\nconst TeamWrapper = styled('span')`\n  ${overflowEllipsis}\n`;\n\nconst StyledActorAvatar = styled(ActorAvatar)`\n  margin-right: ${space(1)};\n`;\n\nexport default AlertListRow;\n","import * as React from 'react';\n\nimport {t} from 'app/locale';\nimport {SelectValue} from 'app/types';\nimport {TimePeriod, TimeWindow} from 'app/views/alerts/incidentRules/types';\n\nexport const TIME_OPTIONS: SelectValue<string>[] = [\n  {label: t('Last 6 hours'), value: TimePeriod.SIX_HOURS},\n  {label: t('Last 24 hours'), value: TimePeriod.ONE_DAY},\n  {label: t('Last 3 days'), value: TimePeriod.THREE_DAYS},\n  {label: t('Last 7 days'), value: TimePeriod.SEVEN_DAYS},\n];\n\nexport const TIME_WINDOWS = {\n  [TimePeriod.SIX_HOURS]: TimeWindow.ONE_HOUR * 6 * 60 * 1000,\n  [TimePeriod.ONE_DAY]: TimeWindow.ONE_DAY * 60 * 1000,\n  [TimePeriod.THREE_DAYS]: TimeWindow.ONE_DAY * 3 * 60 * 1000,\n  [TimePeriod.SEVEN_DAYS]: TimeWindow.ONE_DAY * 7 * 60 * 1000,\n};\n\nexport const API_INTERVAL_POINTS_LIMIT = 10000;\nexport const API_INTERVAL_POINTS_MIN = 150;\n\nexport type TimePeriodType = {\n  start: string;\n  end: string;\n  period: string;\n  label: string;\n  display: React.ReactNode;\n  custom?: boolean;\n};\n"],"names":["makeRuleDetailsQuery","incident","timeWindow","alertRule","timeWindowMillis","minRange","API_INTERVAL_POINTS_MIN","maxRange","API_INTERVAL_POINTS_LIMIT","now","moment","startDate","dateStarted","endDate","dateClosed","incidentRange","Math","max","diff","range","min","halfRange","start","getUtcDateString","subtract","end","add","AlertListRow","Component","memoize","slug","projects","find","project","this","props","getIncidentMetricPreset","undefined","render","orgId","projectsLoaded","organization","started","duration","Date","as","alertLink","isIssueAlert","features","includes","pathname","alertDetailsLink","query","alert","identifier","ownerId","owner","split","teamName","TeamStore","name","teamActor","type","id","Title","to","title","NoWrap","getDynamicText","value","date","extraShort","fixed","status","IncidentStatus","seconds","t","ProjectBadge","avatarSize","getProject","FlexCenter","Fragment","StyledActorAvatar","actor","size","hasTooltip","TeamWrapper","overflowEllipsis","IdBadge","ActorAvatar","space","TIME_OPTIONS","label","TimePeriod","TIME_WINDOWS","TimeWindow"],"sourceRoot":""}