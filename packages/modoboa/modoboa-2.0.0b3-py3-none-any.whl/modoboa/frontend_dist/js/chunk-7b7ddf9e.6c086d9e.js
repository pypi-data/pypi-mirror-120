(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b7ddf9e"],{"07d7":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e.dialogMode?a("translate",{staticClass:"headline"},[e._v("Administrators of "+e._s(e.domain.name))]):a("translate",{staticClass:"headline"},[e._v("Administrators")])],1)]),a("v-card-text",[a("v-data-table",{attrs:{headers:e.headers,items:e.administrators,"hide-default-footer":""},scopedSlots:e._u([{key:"item.username",fn:function(t){var i=t.item;return[i.id?a("span",[e._v(e._s(i.username))]):a("v-autocomplete",{attrs:{label:e._f("translate")("Select an account"),items:e.accounts,"item-text":"username","return-object":""},scopedSlots:e._u([{key:"append-outer",fn:function(){return[e.selectedAccount?a("v-btn",{attrs:{icon:"",color:"primary"},on:{click:e.addAdministrator}},[a("v-icon",[e._v("mdi-content-save")])],1):e._e()]},proxy:!0}],null,!0),model:{value:e.selectedAccount,callback:function(t){e.selectedAccount=t},expression:"selectedAccount"}})]}},{key:"item.name",fn:function(t){var a=t.item;return[e._v(" "+e._s(a.first_name)+" "+e._s(a.last_name)+" ")]}},{key:"item.actions",fn:function(t){var i=t.item;return[i.id?a("v-btn",{attrs:{icon:"",color:"red",title:e._f("translate")("Remove this administrator")},on:{click:function(t){return e.removeAdministrator(i)}}},[a("v-icon",[e._v("mdi-delete-outline")])],1):e._e()]}}])}),e.hideAddBtn?e._e():a("v-btn",{attrs:{small:"",color:"primary",outlined:""},on:{click:e.addRow}},[a("v-icon",{attrs:{small:""}},[e._v("mdi-plus")]),e._v(" "),a("translate",[e._v("Add administrator")])],1)],1),e.dialogMode?a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"grey darken-1",text:""},on:{click:e.close}},[a("translate",[e._v("Close")])],1)],1):e._e()],1)},n=[],s=(a("4de4"),a("7db0"),a("2801")),o=a("458e"),r=a("56d7"),l={props:{domain:Object,dialogMode:{type:Boolean,default:!1}},data:function(){return{accounts:[],administrators:[],headers:[{text:this.$gettext("Username"),value:"username"},{text:this.$gettext("Name"),value:"name"},{text:"",value:"actions",align:"right",sortable:!1}],hideAddBtn:!1,selectedAccount:null}},methods:{addRow:function(){this.administrators.push({}),this.hideAddBtn=!0},close:function(){this.$emit("close"),this.hideAddBtn=!1},fetchAdministrators:function(e){var t=this;o["a"].getDomainAdministrators(e.pk).then((function(e){t.administrators=e.data}))},fetchAccounts:function(){var e=this;s["a"].getAll({role:"DomainAdmins"}).then((function(t){e.accounts=t.data.filter((function(t){return void 0===e.administrators.find((function(e){return e.id===t.pk}))}))}))},addAdministrator:function(){var e=this;o["a"].addDomainAdministrator(this.domain.pk,this.selectedAccount.pk).then((function(t){e.fetchAdministrators(e.domain),e.accounts=e.accounts.filter((function(t){return t.pk!==e.selectedAccount.pk})),e.selectedAccount=null,e.hideAddBtn=!1,r["bus"].$emit("notification",{msg:e.$gettext("Administrator added")})}))},removeAdministrator:function(e){var t=this;o["a"].removeDomainAdministrator(this.domain.pk,e.id).then((function(e){t.fetchAdministrators(t.domain),t.fetchAccounts(),r["bus"].$emit("notification",{msg:t.$gettext("Administrator removed")})}))}},watch:{domain:{handler:function(e){this.fetchAdministrators(e),this.fetchAccounts()},immediate:!0}}},d=l,c=a("2877"),m=a("6544"),u=a.n(m),h=a("5530"),f=(a("d81d"),a("498a"),a("caad"),a("2532"),a("2bfd"),a("b974")),p=a("8654"),v=a("d9f7"),b=a("80d2"),_=Object(h["a"])(Object(h["a"])({},f["b"]),{},{offsetY:!0,offsetOverflow:!0,transition:!1}),x=f["a"].extend({name:"v-autocomplete",props:{allowOverflow:{type:Boolean,default:!0},autoSelectFirst:{type:Boolean,default:!1},filter:{type:Function,default:function(e,t,a){return a.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())>-1}},hideNoData:Boolean,menuProps:{type:f["a"].options.props.menuProps.type,default:function(){return _}},noFilter:Boolean,searchInput:{type:String}},data:function(){return{lazySearch:this.searchInput}},computed:{classes:function(){return Object(h["a"])(Object(h["a"])({},f["a"].options.computed.classes.call(this)),{},{"v-autocomplete":!0,"v-autocomplete--is-selecting-index":this.selectedIndex>-1})},computedItems:function(){return this.filteredItems},selectedValues:function(){var e=this;return this.selectedItems.map((function(t){return e.getValue(t)}))},hasDisplayedItems:function(){var e=this;return this.hideSelected?this.filteredItems.some((function(t){return!e.hasItem(t)})):this.filteredItems.length>0},currentRange:function(){return null==this.selectedItem?0:String(this.getText(this.selectedItem)).length},filteredItems:function(){var e=this;return!this.isSearching||this.noFilter||null==this.internalSearch?this.allItems:this.allItems.filter((function(t){var a=Object(b["r"])(t,e.itemText),i=null!=a?String(a):"";return e.filter(t,String(e.internalSearch),i)}))},internalSearch:{get:function(){return this.lazySearch},set:function(e){this.lazySearch!==e&&(this.lazySearch=e,this.$emit("update:search-input",e))}},isAnyValueAllowed:function(){return!1},isDirty:function(){return this.searchIsDirty||this.selectedItems.length>0},isSearching:function(){return this.multiple&&this.searchIsDirty||this.searchIsDirty&&this.internalSearch!==this.getText(this.selectedItem)},menuCanShow:function(){return!!this.isFocused&&(this.hasDisplayedItems||!this.hideNoData)},$_menuProps:function(){var e=f["a"].options.computed.$_menuProps.call(this);return e.contentClass="v-autocomplete__content ".concat(e.contentClass||"").trim(),Object(h["a"])(Object(h["a"])({},_),e)},searchIsDirty:function(){return null!=this.internalSearch&&""!==this.internalSearch},selectedItem:function(){var e=this;return this.multiple?null:this.selectedItems.find((function(t){return e.valueComparator(e.getValue(t),e.getValue(e.internalValue))}))},listData:function(){var e=f["a"].options.computed.listData.call(this);return e.props=Object(h["a"])(Object(h["a"])({},e.props),{},{items:this.virtualizedItems,noFilter:this.noFilter||!this.isSearching||!this.filteredItems.length,searchInput:this.internalSearch}),e}},watch:{filteredItems:"onFilteredItemsChanged",internalValue:"setSearch",isFocused:function(e){e?(document.addEventListener("copy",this.onCopy),this.$refs.input&&this.$refs.input.select()):(document.removeEventListener("copy",this.onCopy),this.$refs.input&&this.$refs.input.blur(),this.updateSelf())},isMenuActive:function(e){!e&&this.hasSlot&&(this.lazySearch=null)},items:function(e,t){t&&t.length||!this.hideNoData||!this.isFocused||this.isMenuActive||!e.length||this.activateMenu()},searchInput:function(e){this.lazySearch=e},internalSearch:"onInternalSearchChanged",itemText:"updateSelf"},created:function(){this.setSearch()},destroyed:function(){document.removeEventListener("copy",this.onCopy)},methods:{onFilteredItemsChanged:function(e,t){var a=this;e!==t&&(this.setMenuIndex(-1),this.$nextTick((function(){a.internalSearch&&(1===e.length||a.autoSelectFirst)&&(a.$refs.menu.getTiles(),a.setMenuIndex(0))})))},onInternalSearchChanged:function(){this.updateMenuDimensions()},updateMenuDimensions:function(){this.isMenuActive&&this.$refs.menu&&this.$refs.menu.updateDimensions()},changeSelectedIndex:function(e){this.searchIsDirty||(this.multiple&&e===b["x"].left?-1===this.selectedIndex?this.selectedIndex=this.selectedItems.length-1:this.selectedIndex--:this.multiple&&e===b["x"].right?this.selectedIndex>=this.selectedItems.length-1?this.selectedIndex=-1:this.selectedIndex++:e!==b["x"].backspace&&e!==b["x"].delete||this.deleteCurrentItem())},deleteCurrentItem:function(){var e=this.selectedIndex,t=this.selectedItems[e];if(this.isInteractive&&!this.getDisabled(t)){var a=this.selectedItems.length-1;if(-1!==this.selectedIndex||0===a){var i=this.selectedItems.length,n=e!==i-1?e:e-1,s=this.selectedItems[n];s?this.selectItem(t):this.setValue(this.multiple?[]:null),this.selectedIndex=n}else this.selectedIndex=a}},clearableCallback:function(){this.internalSearch=null,f["a"].options.methods.clearableCallback.call(this)},genInput:function(){var e=p["a"].options.methods.genInput.call(this);return e.data=Object(v["a"])(e.data,{attrs:{"aria-activedescendant":Object(b["p"])(this.$refs.menu,"activeTile.id"),autocomplete:Object(b["p"])(e.data,"attrs.autocomplete","off")},domProps:{value:this.internalSearch}}),e},genInputSlot:function(){var e=f["a"].options.methods.genInputSlot.call(this);return e.data.attrs.role="combobox",e},genSelections:function(){return this.hasSlot||this.multiple?f["a"].options.methods.genSelections.call(this):[]},onClick:function(e){this.isInteractive&&(this.selectedIndex>-1?this.selectedIndex=-1:this.onFocus(),this.isAppendInner(e.target)||this.activateMenu())},onInput:function(e){if(!(this.selectedIndex>-1)&&e.target){var t=e.target,a=t.value;t.value&&this.activateMenu(),this.internalSearch=a,this.badInput=t.validity&&t.validity.badInput}},onKeyDown:function(e){var t=e.keyCode;!e.ctrlKey&&[b["x"].home,b["x"].end].includes(t)||f["a"].options.methods.onKeyDown.call(this,e),this.changeSelectedIndex(t)},onSpaceDown:function(e){},onTabDown:function(e){f["a"].options.methods.onTabDown.call(this,e),this.updateSelf()},onUpDown:function(e){e.preventDefault(),this.activateMenu()},selectItem:function(e){f["a"].options.methods.selectItem.call(this,e),this.setSearch()},setSelectedItems:function(){f["a"].options.methods.setSelectedItems.call(this),this.isFocused||this.setSearch()},setSearch:function(){var e=this;this.$nextTick((function(){e.multiple&&e.internalSearch&&e.isMenuActive||(e.internalSearch=!e.selectedItems.length||e.multiple||e.hasSlot?null:e.getText(e.selectedItem))}))},updateSelf:function(){(this.searchIsDirty||this.internalValue)&&(this.valueComparator(this.internalSearch,this.getValue(this.internalValue))||this.setSearch())},hasItem:function(e){return this.selectedValues.indexOf(this.getValue(e))>-1},onCopy:function(e){var t,a;if(-1!==this.selectedIndex){var i=this.selectedItems[this.selectedIndex],n=this.getText(i);null==(t=e.clipboardData)||t.setData("text/plain",n),null==(a=e.clipboardData)||a.setData("text/vnd.vuetify.autocomplete.item+plain",n),e.preventDefault()}}}}),g=a("8336"),k=a("b0af"),y=a("99d9"),D=a("8fea"),w=a("132d"),A=a("2fa4"),$=Object(c["a"])(d,i,n,!1,null,null,null);t["a"]=$.exports;u()($,{VAutocomplete:x,VBtn:g["a"],VCard:k["a"],VCardActions:y["a"],VCardText:y["b"],VCardTitle:y["c"],VDataTable:D["a"],VIcon:w["a"],VSpacer:A["a"]})},"0816":function(e,t,a){},1594:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",[a("translate",[e._v("Domains")])],1),a("v-spacer"),a("v-btn",{staticClass:"mr-2"},[a("v-icon",[e._v("mdi-file-import-outline")])],1),a("v-btn",{staticClass:"mr-2"},[a("v-icon",[e._v("mdi-file-export-outline")])],1),a("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,n=t.attrs;return[a("v-btn",e._g(e._b({attrs:{color:"primary"}},"v-btn",n,!1),i),[a("v-icon",{attrs:{left:""}},[e._v("mdi-plus")]),a("translate",[e._v("New")])],1)]}}])},[a("v-list",{attrs:{dense:""}},[a("v-list-item",{on:{click:function(t){e.showDomainWizard=!0}}},[a("v-list-item-title",[a("translate",[e._v("Domain")])],1)],1),a("v-list-item",{on:{click:function(t){e.showAliasForm=!0}}},[a("v-list-item-title",[a("translate",[e._v("Alias")])],1)],1)],1)],1)],1),a("domain-list"),a("v-dialog",{attrs:{fullscreen:"",scrollable:"",transition:"dialog-bottom-transition"},model:{value:e.showDomainWizard,callback:function(t){e.showDomainWizard=t},expression:"showDomainWizard"}},[a("domain-creation-form",{on:{close:function(t){e.showDomainWizard=!1}}})],1),a("v-dialog",{attrs:{persistent:"","max-width":"800px"},model:{value:e.showAliasForm,callback:function(t){e.showAliasForm=t},expression:"showAliasForm"}},[a("domain-alias-form",{on:{close:function(t){e.showAliasForm=!1}}})],1)],1)},n=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v(e._s(e.title))])]),a("v-card-text",[a("validation-observer",{ref:"observer"},[a("validation-provider",{attrs:{name:"name",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[a("label",{staticClass:"m-label"},[e._v(e._s(e.$gettext("Name")))]),a("v-text-field",{attrs:{dense:"",outlined:"","error-messages":i},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})]}}])}),a("validation-provider",{attrs:{name:"target",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[a("label",{staticClass:"m-label"},[e._v(e._s(e.$gettext("Choose a domain")))]),a("v-select",{attrs:{items:e.domains,"item-text":"name","item-value":"pk","error-messages":i,"single-line":"",dense:"",outlined:""},model:{value:e.form.target,callback:function(t){e.$set(e.form,"target",t)},expression:"form.target"}})]}}])}),a("v-switch",{attrs:{label:"Enabled",color:"primary"},model:{value:e.form.enabled,callback:function(t){e.$set(e.form,"enabled",t)},expression:"form.enabled"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"grey darken-1",text:""},on:{click:e.close}},[a("translate",[e._v("Close")])],1),e.domainAlias&&e.domainAlias.pk?a("v-btn",{attrs:{color:"error",text:""},on:{click:e.deleteAlias}},[a("translate",[e._v("Delete")])],1):e._e(),a("v-btn",{attrs:{color:"primary darken-1",text:""},on:{click:e.submit}},[e._v(" "+e._s(e.submitLabel)+" ")])],1)],1)},o=[],r=a("1da1"),l=a("5530"),d=(a("96cf"),a("2f62")),c=a("56d7"),m=a("458e"),u={props:{domainAlias:{type:Object,default:function(){return null}}},computed:Object(l["a"])(Object(l["a"])({},Object(d["b"])({domains:"domains/domains"})),{},{submitLabel:function(){return this.domainAlias?this.$gettext("Update"):this.$gettext("Add")},title:function(){return this.domainAlias?this.$gettext("Edit domain alias"):this.$gettext("Add a new domain alias")}}),data:function(){return{form:{enabled:!0}}},methods:{close:function(){this.$emit("close"),this.form={enabled:!0}},deleteAlias:function(){var e=this;m["a"].deleteDomainAlias(this.domainAlias.pk).then((function(t){e.$emit("alias-deleted"),c["bus"].$emit("notification",{msg:e.$gettext("Domain alias deleted")})}))},submit:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.observer.validate();case 2:if(a=t.sent,a){t.next=5;break}return t.abrupt("return");case 5:if(t.prev=5,e.form.pk){t.next=11;break}return t.next=9,m["a"].createDomainAlias(e.form).then((function(t){c["bus"].$emit("notification",{msg:e.$gettext("Domain alias created")}),e.$emit("alias-created",t.data),e.close()}));case 9:t.next=15;break;case 11:return i=JSON.parse(JSON.stringify(e.form)),i.target=i.target.pk,t.next=15,m["a"].updateDomainAlias(e.form.pk,i).then((function(t){c["bus"].$emit("notification",{msg:e.$gettext("Domain alias updated")}),e.close()}));case 15:t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](5),e.$refs.observer.setErrors(t.t0.response.data);case 20:case"end":return t.stop()}}),t,null,[[5,17]])})))()}},mounted:function(){this.domainAlias&&(this.form=JSON.parse(JSON.stringify(this.domainAlias)))},watch:{domainAlias:function(e){e&&(this.form=JSON.parse(JSON.stringify(e)))}}},h=u,f=a("2877"),p=a("6544"),v=a.n(p),b=a("8336"),_=a("b0af"),x=a("99d9"),g=a("b974"),k=a("2fa4"),y=a("b73d"),D=a("8654"),w=Object(f["a"])(h,s,o,!1,null,null,null),A=w.exports;v()(w,{VBtn:b["a"],VCard:_["a"],VCardActions:x["a"],VCardText:x["b"],VCardTitle:x["c"],VSelect:g["a"],VSpacer:k["a"],VSwitch:y["a"],VTextField:D["a"]});var $=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("creation-form",{attrs:{title:e._f("translate")("New domain"),steps:e.steps,"form-observer-getter":e.getObserver,"validate-object":e.validateDomain,"summary-sections":e.summarySections},on:{close:e.close,create:e.submit},scopedSlots:e._u([{key:"form.general",fn:function(t){var i=t.step;return[a("domain-general-form",{ref:"form_"+i,attrs:{domain:e.domain}})]}},{key:"form.dns",fn:function(t){var i=t.step;return[a("domain-dns-form",{ref:"form_"+i,attrs:{domain:e.domain}})]}},{key:"form.limitations",fn:function(t){var i=t.step;return[a("domain-limitations-form",{ref:"form_"+i,attrs:{domain:e.domain}})]}},{key:"form.options",fn:function(t){var i=t.step;return[a("domain-options-form",{ref:"form_"+i,attrs:{domain:e.domain},on:{createAdmin:e.updateCreateAdmin}})]}},{key:"item.with_random_password",fn:function(t){var i=t.item;return[i.value?[a("v-col",{staticClass:"highligth white--text",attrs:{cols:"12"}},[a("v-row",[a("v-col",[a("span",[e._v(e._s(i.key))])]),a("v-col",{staticClass:"text-right"},[e._v(e._s(e._f("yesno")(i.value)))])],1),a("v-row",[a("v-col",{staticClass:"text-right py-1"},[e._v(" "+e._s(e.domain.domain_admin.password)+" "),a("v-btn",{attrs:{icon:"",color:"white",title:e._f("translate")("Copy to clipboard")},on:{click:e.copyPassword}},[a("v-icon",[e._v("mdi-clipboard-multiple-outline")])],1)],1)],1)],1)]:[a("v-col",[a("span",{staticClass:"grey--text"},[e._v(e._s(i.key))])]),a("v-col",{staticClass:"text-right"},[e._v(e._s(e._f("yesno")(i.value)))])]]}}])})},S=[],I=(a("b0c0"),a("415d")),C=a("ceb0"),V=a("2370"),F=a("c016"),O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("validation-observer",{ref:"observer"},[a("v-switch",{attrs:{label:e._f("translate")("Create a domain administrator")},on:{change:e.update},model:{value:e.createAdmin,callback:function(t){e.createAdmin=t},expression:"createAdmin"}}),a("validation-provider",{attrs:{rules:e.createAdmin?"required":""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[a("v-text-field",{attrs:{label:e._f("translate")("Name"),hint:e._f("translate")("Name of the administrator"),"persistent-hint":"","error-messages":i,outlined:"",disabled:!e.createAdmin,suffix:"@"+e.domain.name},model:{value:e.domain.domain_admin.username,callback:function(t){e.$set(e.domain.domain_admin,"username",t)},expression:"domain.domain_admin.username"}})]}}])}),a("v-switch",{attrs:{label:e._f("translate")("Random password"),disabled:!e.createAdmin,hint:e._f("translate")("Generate a random password for the administrator."),"persistent-hint":""},on:{change:e.updatePassword},model:{value:e.domain.domain_admin.with_random_password,callback:function(t){e.$set(e.domain.domain_admin,"with_random_password",t)},expression:"domain.domain_admin.with_random_password"}}),a("v-switch",{attrs:{label:e._f("translate")("With a mailbox"),disabled:!e.createAdmin,hint:e._f("translate")("Create a mailbox for the administrator."),"persistent-hint":""},model:{value:e.domain.domain_admin.with_mailbox,callback:function(t){e.$set(e.domain.domain_admin,"with_mailbox",t)},expression:"domain.domain_admin.with_mailbox"}}),a("v-switch",{attrs:{label:e._f("translate")("Create aliases"),disabled:!e.createAdmin,hint:e._f("translate")("Create standard aliases for the domain."),"persistent-hint":""},model:{value:e.domain.domain_admin.with_aliases,callback:function(t){e.$set(e.domain.domain_admin,"with_aliases",t)},expression:"domain.domain_admin.with_aliases"}})],1)},T=[],j=a("2801"),L={props:["domain"],data:function(){return{createAdmin:!1}},methods:{updatePassword:function(e){var t=this;e?j["a"].getRandomPassword().then((function(e){t.$set(t.domain.domain_admin,"password",e.data.password)})):delete this.domain.domain_admin.password},update:function(e){this.$emit("createAdmin",e)}}},M=L,q=Object(f["a"])(M,O,T,!1,null,null,null),N=q.exports;v()(q,{VSwitch:y["a"],VTextField:D["a"]});var E={props:["value"],components:{CreationForm:I["a"],"domain-dns-form":C["a"],DomainGeneralForm:V["a"],DomainLimitationsForm:F["a"],DomainOptionsForm:N},computed:{summarySections:function(){var e=[{title:this.$gettext("General"),items:[{key:this.$gettext("Name"),value:this.domain.name},{key:this.$gettext("Type"),value:this.domain.type},{key:this.$gettext("Enabled"),value:this.domain.enabled,type:"yesno"}]},{title:this.$gettext("DNS"),items:[{key:this.$gettext("Enable DNS checks"),value:this.domain.enable_dns_checks,type:"yesno"},{key:this.$gettext("Enable DKIM signing"),value:this.domain.enable_dkim,type:"yesno"}]},{title:this.$gettext("Limitations"),items:[{key:this.$gettext("Quota"),value:this.domain.quota},{key:this.$gettext("Default mailbox quota"),value:this.domain.default_mailbox_quota},{key:this.$gettext("Message sending limit"),value:this.domain.message_sending_limit}]},{title:this.$gettext("Options"),items:[{key:this.$gettext("Create a domain administrator"),value:this.createAdmin,type:"yesno"}]}];return this.domain.enable_dkim&&(e[1].items.push({key:this.$gettext("DKIM key selector"),value:this.domain.dkim_key_selector}),e[1].items.push({key:this.$gettext("DKIM key length"),value:this.domain.dkim_key_length})),this.createAdmin&&(e[3].items.push({key:this.$gettext("Administrator name"),value:this.domain.domain_admin.username}),e[3].items.push({name:"with_random_password",key:this.$gettext("Random password"),value:this.domain.domain_admin.with_random_password,type:"yesno"}),e[3].items.push({key:this.$gettext("With mailbox"),value:this.domain.domain_admin.with_mailbox,type:"yesno"}),e[3].items.push({key:this.$gettext("Create aliases"),value:this.domain.domain_admin.with_aliases,type:"yesno"})),e}},data:function(){return{createAdmin:!1,domain:{domain_admin:{}},formErrors:{},steps:[{name:"general",title:this.$gettext("General")},{name:"dns",title:this.$gettext("DNS")},{name:"limitations",title:this.$gettext("Limitations")},{name:"options",title:this.$gettext("Options")}]}},mounted:function(){this.initDomain()},methods:{copyPassword:function(){var e=this;navigator.clipboard.writeText(this.domain.domain_admin.password).then((function(){c["bus"].$emit("notification",{msg:e.$gettext("Password copied to clipboard")})}))},initDomain:function(){this.domain={name:"",type:"domain",enabled:!0,enable_dns_checks:!0,enable_dkim:!1,dkim_key_selector:"modoboa",quota:0,default_mailbox_quota:0,domain_admin:{username:"admin",with_random_password:!1,with_mailbox:!1,with_aliases:!1}}},close:function(){this.initDomain(),this.$emit("close")},getObserver:function(e){return this.$refs["form_".concat(e)].$refs.observer},validateDomain:function(){},updateCreateAdmin:function(e){this.createAdmin=e},submit:function(){var e=this,t=JSON.parse(JSON.stringify(this.domain));this.createAdmin||delete t.domain_admin,this.$store.dispatch("domains/createDomain",t).then((function(t){e.$router.push({name:"DomainDetail",params:{id:t.data.pk}}),c["bus"].$emit("notification",{msg:e.$gettext("Domain created")}),e.close()}))}}},B=E,z=(a("e299"),a("62ad")),K=a("132d"),P=a("0fd9"),R=Object(f["a"])(B,$,S,!1,null,null,null),J=R.exports;v()(R,{VBtn:b["a"],VCol:z["a"],VIcon:K["a"],VRow:P["a"]});var W=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"mt-6"},[a("v-toolbar",{attrs:{flat:""}},[a("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,n=t.attrs;return[a("v-btn",e._g(e._b({attrs:{small:""}},"v-btn",n,!1),i),[e._v(" Actions "),a("v-icon",{attrs:{right:""}},[e._v("mdi-chevron-down")])],1)]}}])},[a("v-list",{attrs:{dense:""}})],1),a("v-spacer"),a("v-text-field",{attrs:{"prepend-inner-icon":"mdi-magnify",placeholder:"Search",filled:"",outlined:"",dense:"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.domains,search:e.search,"item-key":"name","show-select":"","single-expand":"",expanded:e.expanded},on:{"update:expanded":function(t){e.expanded=t},"item-expanded":e.loadAliases,"click:row":e.showAliases},scopedSlots:e._u([{key:"item",fn:function(t){var i=t.item,n=t.isExpanded,s=t.expand;return[a("tr",[a("td",[a("v-checkbox")],1),a("td",[a("router-link",{attrs:{to:{name:"DomainDetail",params:{id:i.pk}}}},[e._v(" "+e._s(i.name)+" ")]),i.enabled?e._e():a("translate",{staticClass:"ml-2 grey--text"},[e._v("(disabled)")])],1),a("td",[e._v(" "+e._s(i.domainalias_count)+" aliases "),i.domainalias_count?a("v-btn",{attrs:{icon:""},on:{click:function(e){return s(!n)}}},[a("v-icon",n?[e._v("mdi-chevron-up")]:[e._v("mdi-chevron-down")])],1):e._e()],1),a("td",[a("dns-status-chip",{attrs:{status:i.dns_global_status}})],1),a("td",[a("v-progress-linear",{model:{value:i.allocated_quota_in_percent,callback:function(t){e.$set(i,"allocated_quota_in_percent",t)},expression:"item.allocated_quota_in_percent"}})],1),a("td",[a("v-progress-linear",{model:{value:i.allocated_quota_in_percent,callback:function(t){e.$set(i,"allocated_quota_in_percent",t)},expression:"item.allocated_quota_in_percent"}})],1),a("td",[a("div",{staticClass:"text-right"},[a("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,n=t.attrs;return[a("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",n,!1),i),[a("v-icon",[e._v("mdi-dots-horizontal")])],1)]}}],null,!0)},[a("menu-items",{attrs:{items:e.domainMenuItems,object:i}})],1)],1)])])]}},{key:"expanded-item",fn:function(t){var i=t.headers,n=t.item;return[a("tr",{staticClass:"grey lighten-4"},[a("td",{attrs:{colspan:i.length}},e._l(e.aliases[n.name],(function(t){return a("span",{key:t.name,staticClass:"mr-4"},[a("a",{staticClass:"mr-2",attrs:{href:"#"},on:{click:function(a){return e.editDomainAlias(n,t)}}},[e._v(e._s(t.name))]),a("v-chip",{attrs:{"x-small":"",color:"success"}},[e._v("DNS OK")])],1)})),0)])]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}}),a("confirm-dialog",{ref:"confirm"},[a("v-checkbox",{attrs:{label:e._f("translate")("Do not delete domain folder"),"hide-details":""},model:{value:e.keepDomainFolder,callback:function(t){e.keepDomainFolder=t},expression:"keepDomainFolder"}})],1),a("v-dialog",{attrs:{persistent:"","max-width":"800px"},model:{value:e.showAliasForm,callback:function(t){e.showAliasForm=t},expression:"showAliasForm"}},[a("domain-alias-form",{attrs:{"domain-alias":e.selectedDomainAlias},on:{close:e.closeDomainAliasForm,"alias-created":e.domainAliasCreated,"alias-deleted":e.domainAliasDeleted}})],1),a("v-dialog",{attrs:{persistent:"","max-width":"800px"},model:{value:e.showAdminList,callback:function(t){e.showAdminList=t},expression:"showAdminList"}},[a("administrator-list",{attrs:{domain:e.selectedDomain,"dialog-mode":""},on:{close:function(t){e.showAdminList=!1}}})],1)],1)},G=[],Q=(a("4de4"),a("07d7")),U=a("448e"),Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-chip",{attrs:{color:e.chipType,small:""}},[e._v(" "+e._s(e.label)+" ")])},H=[],X={props:["status"],computed:{label:function(){return"disabled"===this.status?this.$gettext("Disabled"):"pending"===this.status?this.$gettext("Pending"):"critical"===this.status?this.$gettext("Problem"):"ok"===this.status?this.$gettext("Valid"):this.$gettext("Unknown")},chipType:function(){return"disabled"===this.status?"":"pending"===this.status?"info":"critical"===this.status?"error":"ok"===this.status?"success":"warning"}}},Z=X,ee=a("cc20"),te=Object(f["a"])(Z,Y,H,!1,null,null,null),ae=te.exports;v()(te,{VChip:ee["a"]});var ie=a("bc77"),ne={components:{AdministratorList:Q["a"],ConfirmDialog:U["a"],"dns-status-chip":ae,DomainAliasForm:A,MenuItems:ie["a"]},computed:Object(d["b"])({domains:"domains/domains"}),data:function(){return{domainMenuItems:[{label:this.$gettext("Administrators"),icon:"mdi-account-supervisor",onClick:this.openAdminList},{label:this.$gettext("Edit"),icon:"mdi-circle-edit-outline",onClick:this.editDomain},{label:this.$gettext("Delete"),icon:"mdi-delete-outline",onClick:this.deleteDomain,color:"red"}],headers:[{text:this.$gettext("Name"),value:"name"},{text:this.$gettext("Aliases"),value:"domainalias_count"},{text:this.$gettext("DNS status"),value:"dns_global_status",sortable:!1,align:"center"},{text:this.$gettext("Sending limit"),value:"message_limit"},{text:this.$gettext("Quota"),value:"allocated_quota_in_percent"},{text:this.$gettext("Actions"),value:"actions",sortable:!1,align:"right"}],keepDomainFolder:!1,selectedDomain:null,selectedDomainAlias:null,showAdminList:!1,showConfirmDialog:!1,showAliasForm:!1,search:"",selected:[],expanded:[],aliases:{}}},created:function(){this.$store.dispatch("domains/getDomains")},methods:{closeDomainAliasForm:function(){this.showAliasForm=!1,this.selectedDomain=null,this.selectedDomainAlias=null},deleteDomain:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var i,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$refs.confirm.open(t.$gettext("Warning"),t.$gettextInterpolate("Do you really want to delete the domain %{ domain }?",{domain:e.name}),{color:"error",cancelLabel:t.$gettext("No"),agreeLabel:t.$gettext("Yes")});case 2:if(i=a.sent,i){a.next=5;break}return a.abrupt("return");case 5:n={keep_folder:t.keepDomainFolder},t.$store.dispatch("domains/deleteDomain",{id:e.pk,data:n}).then((function(e){c["bus"].$emit("notification",{msg:t.$gettext("Domain deleted")}),t.keepDomainFolder=!1}));case 7:case"end":return a.stop()}}),a)})))()},domainAliasCreated:function(e){this.$store.dispatch("domains/getDomains")},domainAliasDeleted:function(){var e=this,t=this.aliases[this.selectedDomain.name].filter((function(t){return t.pk!==e.selectedDomainAlias.pk}));this.$set(this.aliases,this.selectedDomain.name,t),t.length||(this.expanded=[]),this.$store.dispatch("domains/getDomains"),this.closeDomainAliasForm()},editDomain:function(e){this.$router.push({name:"DomainEdit",params:{id:e.pk}})},editDomainAlias:function(e,t){this.selectedDomain=e,this.selectedDomainAlias=t,this.showAliasForm=!0},loadAliases:function(e){var t=this,a=e.item,i=e.value;i&&m["a"].getDomainAliases(a.name).then((function(e){t.$set(t.aliases,a.name,e.data)}))},openAdminList:function(e){this.selectedDomain=e,this.showAdminList=!0},showAliases:function(e){this.expanded=[{item:e}]}}},se=ne,oe=(a("df0a"),a("ac7c")),re=a("8fea"),le=a("169a"),de=a("8860"),ce=a("e449"),me=a("8e36"),ue=a("71d9"),he=Object(f["a"])(se,W,G,!1,null,"be78c31e",null),fe=he.exports;v()(he,{VBtn:b["a"],VCard:_["a"],VCheckbox:oe["a"],VChip:ee["a"],VDataTable:re["a"],VDialog:le["a"],VIcon:K["a"],VList:de["a"],VMenu:ce["a"],VProgressLinear:me["a"],VSpacer:k["a"],VTextField:D["a"],VToolbar:ue["a"]});var pe={components:{DomainAliasForm:A,DomainCreationForm:J,DomainList:fe},data:function(){return{showAliasForm:!1,showDomainWizard:!1}},methods:{}},ve=pe,be=(a("913a"),a("da13")),_e=a("5d23"),xe=a("2a7f"),ge=Object(f["a"])(ve,i,n,!1,null,"3a747b4a",null);t["default"]=ge.exports;v()(ge,{VBtn:b["a"],VDialog:le["a"],VIcon:K["a"],VList:de["a"],VListItem:be["a"],VListItemTitle:_e["b"],VMenu:ce["a"],VSpacer:k["a"],VToolbar:ue["a"],VToolbarTitle:xe["a"]})},2370:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("validation-observer",{ref:"observer"},[a("validation-provider",{attrs:{rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[a("v-text-field",{attrs:{label:e._f("translate")("Domain name (ex: domain.tld)"),"error-messages":i,outlined:""},model:{value:e.domain.name,callback:function(t){e.$set(e.domain,"name",t)},expression:"domain.name"}})]}}])}),a("validation-provider",{attrs:{rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[a("choice-field",{attrs:{label:e._f("translate")("Type"),choices:e.domainTypes,"error-messages":i},model:{value:e.domain.type,callback:function(t){e.$set(e.domain,"type",t)},expression:"domain.type"}})]}}])}),a("v-switch",{attrs:{label:e._f("translate")("Enabled"),hint:e._f("translate")("Control if this domain will be allowed to send and receive messages"),"persistent-hint":""},model:{value:e.domain.enabled,callback:function(t){e.$set(e.domain,"enabled",t)},expression:"domain.enabled"}})],1)},n=[],s=a("7146"),o={components:{ChoiceField:s["a"]},props:["domain"],data:function(){return{domainTypes:[{label:"Domain",icon:"mdi-earth",value:"domain"},{label:"Relay domain",icon:"mdi-earth",value:"relaydomain"}]}}},r=o,l=a("2877"),d=a("6544"),c=a.n(d),m=a("b73d"),u=a("8654"),h=Object(l["a"])(r,i,n,!1,null,null,null);t["a"]=h.exports;c()(h,{VSwitch:m["a"],VTextField:u["a"]})},"2bfd":function(e,t,a){},3873:function(e,t,a){},"913a":function(e,t,a){"use strict";a("0816")},b1c0:function(e,t,a){},c016:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("validation-observer",{ref:"observer"},[a("validation-provider",{attrs:{rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[a("v-text-field",{staticClass:"mb-4",attrs:{label:e._f("translate")("Quota"),hint:e._f("translate")("Quota shared between mailboxes. Can be expressed in KB, MB (default) or GB. A value of 0 means no quota."),"persistent-hint":"","error-messages":i,outlined:""},model:{value:e.domain.quota,callback:function(t){e.$set(e.domain,"quota",t)},expression:"domain.quota"}})]}}])}),a("validation-provider",{attrs:{rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[a("v-text-field",{staticClass:"mb-4",attrs:{label:e._f("translate")("Default mailbox quota"),hint:e._f("translate")("Default quota applied to mailboxes. Can be expressed in KB, MB (default) or GB. A value of 0 means no quota."),"persistent-hint":"","error-messages":i,outlined:""},model:{value:e.domain.default_mailbox_quota,callback:function(t){e.$set(e.domain,"default_mailbox_quota",t)},expression:"domain.default_mailbox_quota"}})]}}])}),a("validation-provider",{attrs:{rules:"numeric"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[a("v-text-field",{attrs:{label:e._f("translate")("Message sending limit"),hint:e._f("translate")("Number of messages this domain can send per day. Leave empty for no limit."),"persistent-hint":"","error-messages":i,outlined:""},model:{value:e.domain.message_sending_limit,callback:function(t){e.$set(e.domain,"message_sending_limit",t)},expression:"domain.message_sending_limit"}})]}}])})],1)},n=[],s={props:["domain"]},o=s,r=a("2877"),l=a("6544"),d=a.n(l),c=a("8654"),m=Object(r["a"])(o,i,n,!1,null,null,null);t["a"]=m.exports;d()(m,{VTextField:c["a"]})},ceb0:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-switch",{attrs:{label:e._f("translate")("Enable DNS checks")},model:{value:e.domain.enable_dns_checks,callback:function(t){e.$set(e.domain,"enable_dns_checks",t)},expression:"domain.enable_dns_checks"}}),a("v-switch",{attrs:{label:e._f("translate")("Enable DKIM signing")},model:{value:e.domain.enable_dkim,callback:function(t){e.$set(e.domain,"enable_dkim",t)},expression:"domain.enable_dkim"}}),a("v-text-field",{attrs:{label:e._f("translate")("DKIM key selector"),disabled:!e.domain.enable_dkim,outlined:""},model:{value:e.domain.dkim_key_selector,callback:function(t){e.$set(e.domain,"dkim_key_selector",t)},expression:"domain.dkim_key_selector"}}),a("choice-field",{attrs:{label:e._f("translate")("DKIM key length"),choices:e.dkimKeyLengths,disabled:!e.domain.enable_dkim},model:{value:e.domain.dkim_key_length,callback:function(t){e.$set(e.domain,"dkim_key_length",t)},expression:"domain.dkim_key_length"}})],1)},n=[],s=a("7146"),o={components:{ChoiceField:s["a"]},props:["domain"],data:function(){return{dkimKeyLengths:[{label:"1024",value:1024},{label:"2048",value:2048},{label:"4096",value:4096}]}}},r=o,l=a("2877"),d=a("6544"),c=a.n(d),m=a("b73d"),u=a("8654"),h=Object(l["a"])(r,i,n,!1,null,null,null);t["a"]=h.exports;c()(h,{VSwitch:m["a"],VTextField:u["a"]})},df0a:function(e,t,a){"use strict";a("b1c0")},e299:function(e,t,a){"use strict";a("3873")}}]);
//# sourceMappingURL=chunk-7b7ddf9e.6c086d9e.js.map